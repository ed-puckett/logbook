{"version":3,"file":"main.js","mappings":"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","sources":["webpack://logbook/webpack/runtime/async module","webpack://logbook/./lib/ui/dialog/dialog.css","webpack://logbook/./lib/ui/menu/style.css","webpack://logbook/./src/editor-cell-element/style.css","webpack://logbook/./src/eval-cell-element/style.css","webpack://logbook/./src/settings-dialog/settings-dialog.css","webpack://logbook/./src/style-hacks.css","webpack://logbook/./src/style.css","webpack://logbook/./src/theme-settings/theme-colors.css","webpack://logbook/./src/toggle-switch-element/style.css","webpack://logbook/./src/tool-bar-element/style.css","webpack://logbook/./node_modules/css-loader/dist/runtime/api.js","webpack://logbook/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://logbook/./node_modules/sprintf-js/dist/sprintf.min.js","webpack://logbook/./lib/ui/menu/style.css?c741","webpack://logbook/./src/editor-cell-element/style.css?bb01","webpack://logbook/./src/eval-cell-element/style.css?d4c8","webpack://logbook/./src/settings-dialog/settings-dialog.css?7a2c","webpack://logbook/./src/style-hacks.css?ece3","webpack://logbook/./src/style.css?7163","webpack://logbook/./src/theme-settings/theme-colors.css?49be","webpack://logbook/./src/tool-bar-element/style.css?d8e5","webpack://logbook/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://logbook/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://logbook/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://logbook/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://logbook/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://logbook/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://logbook/./src/renderer/javascript-renderer/ lazy strict namespace object","webpack://logbook/./lib/sys/event-listener-manager.js","webpack://logbook/./lib/sys/fs-interface.js","webpack://logbook/./lib/sys/obj-path.js","webpack://logbook/./lib/sys/open-promise.js","webpack://logbook/./lib/sys/rxjs.js","webpack://logbook/./lib/sys/sprintf.js","webpack://logbook/./lib/sys/stoppable.js","webpack://logbook/./lib/sys/subscribable.js","webpack://logbook/./lib/sys/util.js","webpack://logbook/./node_modules/uuid/dist/esm-browser/native.js","webpack://logbook/./node_modules/uuid/dist/esm-browser/rng.js","webpack://logbook/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://logbook/./node_modules/uuid/dist/esm-browser/v4.js","webpack://logbook/./lib/sys/uuid.js","webpack://logbook/./lib/ui/beep.js","webpack://logbook/./lib/ui/change-manager.js","webpack://logbook/./lib/ui/dialog/dialog.css?c6d9","webpack://logbook/./lib/ui/dialog/_.js","webpack://logbook/./lib/ui/dom-util.js","webpack://logbook/./lib/ui/key/key-event-manager.js","webpack://logbook/./lib/ui/key/key-map.js","webpack://logbook/./lib/ui/key/key-spec.js","webpack://logbook/./lib/ui/menu/_.js","webpack://logbook/./src/assets-server-url.js","webpack://logbook/./src/editor-cell-element/_.js","webpack://logbook/./src/eval-cell-element/_.js","webpack://logbook/./src/evaluator/_.js","webpack://logbook/./src/evaluator/evaluator.js","webpack://logbook/./src/evaluator/javascript-evaluator.js","webpack://logbook/./src/evaluator/markdown-evaluator.js","webpack://logbook/./src/evaluator/tex-evaluator.js","webpack://logbook/./src/init.js","webpack://logbook/./src/logbook-manager.js","webpack://logbook/./src/output-context.js","webpack://logbook/./src/renderer/_.js","webpack://logbook/./src/renderer/chart-renderer.js","webpack://logbook/./src/renderer/chart.js","webpack://logbook/./src/renderer/d3.js","webpack://logbook/./src/renderer/error-renderer.js","webpack://logbook/./src/renderer/graphviz-renderer.js","webpack://logbook/./src/renderer/graphviz.js","webpack://logbook/./src/renderer/image-data-renderer.js","webpack://logbook/./src/renderer/javascript-renderer/_.js","webpack://logbook/./src/renderer/javascript-renderer/eval-worker/_.js","webpack://logbook/./src/renderer/markdown-renderer.js","webpack://logbook/./src/renderer/marked.js","webpack://logbook/./src/renderer/plotly-renderer.js","webpack://logbook/./src/renderer/plotly.js","webpack://logbook/./src/renderer/renderer.js","webpack://logbook/./src/renderer/tex-renderer.js","webpack://logbook/./src/renderer/text-renderer.js","webpack://logbook/./src/renderer/texzilla.js","webpack://logbook/./src/settings-dialog/_.js","webpack://logbook/./src/settings.js","webpack://logbook/./src/storage.js","webpack://logbook/./lib/sys/idb.js","webpack://logbook/./src/theme-settings/_.js","webpack://logbook/./src/toggle-switch-element/style.css?59e0","webpack://logbook/./src/toggle-switch-element/_.js","webpack://logbook/./src/tool-bar-element/_.js","webpack://logbook/webpack/bootstrap","webpack://logbook/webpack/runtime/compat get default export","webpack://logbook/webpack/runtime/define property getters","webpack://logbook/webpack/runtime/hasOwnProperty shorthand","webpack://logbook/webpack/runtime/nonce","webpack://logbook/webpack/startup"],"sourcesContent":["var webpackQueues = typeof Symbol === \"function\" ? Symbol(\"webpack queues\") : \"__webpack_queues__\";\nvar webpackExports = typeof Symbol === \"function\" ? Symbol(\"webpack exports\") : \"__webpack_exports__\";\nvar webpackError = typeof Symbol === \"function\" ? Symbol(\"webpack error\") : \"__webpack_error__\";\nvar resolveQueue = (queue) => {\n\tif(queue && queue.d < 1) {\n\t\tqueue.d = 1;\n\t\tqueue.forEach((fn) => (fn.r--));\n\t\tqueue.forEach((fn) => (fn.r-- ? fn.r++ : fn()));\n\t}\n}\nvar wrapDeps = (deps) => (deps.map((dep) => {\n\tif(dep !== null && typeof dep === \"object\") {\n\t\tif(dep[webpackQueues]) return dep;\n\t\tif(dep.then) {\n\t\t\tvar queue = [];\n\t\t\tqueue.d = 0;\n\t\t\tdep.then((r) => {\n\t\t\t\tobj[webpackExports] = r;\n\t\t\t\tresolveQueue(queue);\n\t\t\t}, (e) => {\n\t\t\t\tobj[webpackError] = e;\n\t\t\t\tresolveQueue(queue);\n\t\t\t});\n\t\t\tvar obj = {};\n\t\t\tobj[webpackQueues] = (fn) => (fn(queue));\n\t\t\treturn obj;\n\t\t}\n\t}\n\tvar ret = {};\n\tret[webpackQueues] = x => {};\n\tret[webpackExports] = dep;\n\treturn ret;\n}));\n__webpack_require__.a = (module, body, hasAwait) => {\n\tvar queue;\n\thasAwait && ((queue = []).d = -1);\n\tvar depQueues = new Set();\n\tvar exports = module.exports;\n\tvar currentDeps;\n\tvar outerResolve;\n\tvar reject;\n\tvar promise = new Promise((resolve, rej) => {\n\t\treject = rej;\n\t\touterResolve = resolve;\n\t});\n\tpromise[webpackExports] = exports;\n\tpromise[webpackQueues] = (fn) => (queue && fn(queue), depQueues.forEach(fn), promise[\"catch\"](x => {}));\n\tmodule.exports = promise;\n\tbody((deps) => {\n\t\tcurrentDeps = wrapDeps(deps);\n\t\tvar fn;\n\t\tvar getResult = () => (currentDeps.map((d) => {\n\t\t\tif(d[webpackError]) throw d[webpackError];\n\t\t\treturn d[webpackExports];\n\t\t}))\n\t\tvar promise = new Promise((resolve) => {\n\t\t\tfn = () => (resolve(getResult));\n\t\t\tfn.r = 0;\n\t\t\tvar fnQueue = (q) => (q !== queue && !depQueues.has(q) && (depQueues.add(q), q && !q.d && (fn.r++, q.push(fn))));\n\t\t\tcurrentDeps.map((dep) => (dep[webpackQueues](fnQueue)));\n\t\t});\n\t\treturn fn.r ? promise : getResult();\n\t}, (err) => ((err ? reject(promise[webpackError] = err) : outerResolve(exports)), resolveQueue(queue)));\n\tqueue && queue.d < 0 && (queue.d = 0);\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `dialog {\n    border-radius: 0.5rem;\n    box-shadow: 3px 3px 16px grey;\n}\n\ndialog .dialog_text {\n    margin: 0.5rem 0.5rem 0.5rem 0;\n}\n\ndialog button,\ndialog input[type=\"button\"] {\n    margin: 0.5rem 0.5rem 0.5rem 0;\n}\n\ndialog .dialog_decline {\n    display: inline;\n}\n\ndialog .dialog_accept {\n    display: inline;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./lib/ui/dialog/dialog.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,qBAAqB;IACrB,6BAA6B;AACjC;;AAEA;IACI,8BAA8B;AAClC;;AAEA;;IAEI,8BAA8B;AAClC;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,eAAe;AACnB\",\"sourcesContent\":[\"dialog {\\n    border-radius: 0.5rem;\\n    box-shadow: 3px 3px 16px grey;\\n}\\n\\ndialog .dialog_text {\\n    margin: 0.5rem 0.5rem 0.5rem 0;\\n}\\n\\ndialog button,\\ndialog input[type=\\\"button\\\"] {\\n    margin: 0.5rem 0.5rem 0.5rem 0;\\n}\\n\\ndialog .dialog_decline {\\n    display: inline;\\n}\\n\\ndialog .dialog_accept {\\n    display: inline;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.menu:not(.active) {\n    display: none;\n}\n\n.menubar:focus {\n    outline: none;  /* no need for outline, we provide other visual feedback */\n}\n\n.menubar {\n    margin: 0;\n    padding: 0.1rem 0 0.1rem 0;\n}\n\n.menubar>li {\n    display: inline;  /* horizontal orientation for top-level items of menubar */\n    padding: 0 0.5rem 0 0.5rem;\n}\n\n.menubar .menuitem {\n    list-style-type: none;\n    min-width: max-content;\n}\n\n.menuitem * {\n    user-select: none;\n}\n\n.menuitem .menuitem-label {\n    font-family: sans-serif;\n    font-size: 90%;\n}\n\n.menubar .menuitem.checked::before {\n    content: \"\\\\2713\";  /* unicode check mark */\n    position: absolute;\n    left: 0.5em;\n}\n\n.menubar div {\n    display: inline;\n}\n\n.menu {\n    position: absolute;\n    z-index: 999;\n    background-color: #f0f0f0;\n    padding: 0.25rem 0 0.25rem 0;  /* override standard ul/li padding */\n    border-radius: 0.25rem;\n    border: 1px solid grey;\n    box-shadow: 3px 3px 16px lightgrey;\n\n    /* eliminate default styling for menu elements */\n    margin-block-start:   0;\n    margin-block-end:     0;\n    margin-inline-start:  0;\n    margin-inline-end:    0;\n    padding-inline-start: 0;\n}\n\n.menuitem.disabled {\n    color: #bbb;\n}\n\n.menuitem.selected {\n    background-color: #0004;\n}\n\n.menu .menuitem:not(.menuitem-separator) {\n    padding: 0 0.5rem 0 1.5rem;\n}\n\n.menu .menuitem.menuitem-separator {\n    margin: 0.2rem 0 0.2rem 0;\n    height: 0px;\n    color: transparent;\n    border-bottom: 1px solid #3334;\n}\n\n.menu .menuitem .menuitem-annotation {\n    margin-left: 2rem;\n    float: right;\n}\n\n.menu .menuitem kbd {\n    margin: 0 0 0 0.5rem;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./lib/ui/menu/style.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,aAAa;AACjB;;AAEA;IACI,aAAa,GAAG,0DAA0D;AAC9E;;AAEA;IACI,SAAS;IACT,0BAA0B;AAC9B;;AAEA;IACI,eAAe,GAAG,0DAA0D;IAC5E,0BAA0B;AAC9B;;AAEA;IACI,qBAAqB;IACrB,sBAAsB;AAC1B;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,uBAAuB;IACvB,cAAc;AAClB;;AAEA;IACI,gBAAgB,GAAG,uBAAuB;IAC1C,kBAAkB;IAClB,WAAW;AACf;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,kBAAkB;IAClB,YAAY;IACZ,yBAAyB;IACzB,4BAA4B,GAAG,oCAAoC;IACnE,sBAAsB;IACtB,sBAAsB;IACtB,kCAAkC;;IAElC,gDAAgD;IAChD,uBAAuB;IACvB,uBAAuB;IACvB,uBAAuB;IACvB,uBAAuB;IACvB,uBAAuB;AAC3B;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,uBAAuB;AAC3B;;AAEA;IACI,0BAA0B;AAC9B;;AAEA;IACI,yBAAyB;IACzB,WAAW;IACX,kBAAkB;IAClB,8BAA8B;AAClC;;AAEA;IACI,iBAAiB;IACjB,YAAY;AAChB;;AAEA;IACI,oBAAoB;AACxB\",\"sourcesContent\":[\".menu:not(.active) {\\n    display: none;\\n}\\n\\n.menubar:focus {\\n    outline: none;  /* no need for outline, we provide other visual feedback */\\n}\\n\\n.menubar {\\n    margin: 0;\\n    padding: 0.1rem 0 0.1rem 0;\\n}\\n\\n.menubar>li {\\n    display: inline;  /* horizontal orientation for top-level items of menubar */\\n    padding: 0 0.5rem 0 0.5rem;\\n}\\n\\n.menubar .menuitem {\\n    list-style-type: none;\\n    min-width: max-content;\\n}\\n\\n.menuitem * {\\n    user-select: none;\\n}\\n\\n.menuitem .menuitem-label {\\n    font-family: sans-serif;\\n    font-size: 90%;\\n}\\n\\n.menubar .menuitem.checked::before {\\n    content: \\\"\\\\2713\\\";  /* unicode check mark */\\n    position: absolute;\\n    left: 0.5em;\\n}\\n\\n.menubar div {\\n    display: inline;\\n}\\n\\n.menu {\\n    position: absolute;\\n    z-index: 999;\\n    background-color: #f0f0f0;\\n    padding: 0.25rem 0 0.25rem 0;  /* override standard ul/li padding */\\n    border-radius: 0.25rem;\\n    border: 1px solid grey;\\n    box-shadow: 3px 3px 16px lightgrey;\\n\\n    /* eliminate default styling for menu elements */\\n    margin-block-start:   0;\\n    margin-block-end:     0;\\n    margin-inline-start:  0;\\n    margin-inline-end:    0;\\n    padding-inline-start: 0;\\n}\\n\\n.menuitem.disabled {\\n    color: #bbb;\\n}\\n\\n.menuitem.selected {\\n    background-color: #0004;\\n}\\n\\n.menu .menuitem:not(.menuitem-separator) {\\n    padding: 0 0.5rem 0 1.5rem;\\n}\\n\\n.menu .menuitem.menuitem-separator {\\n    margin: 0.2rem 0 0.2rem 0;\\n    height: 0px;\\n    color: transparent;\\n    border-bottom: 1px solid #3334;\\n}\\n\\n.menu .menuitem .menuitem-annotation {\\n    margin-left: 2rem;\\n    float: right;\\n}\\n\\n.menu .menuitem kbd {\\n    margin: 0 0 0 0.5rem;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `editor-cell {\n    outline: 0px solid transparent;  /* disable default outline */\n\n    white-space: pre-wrap;  /* properly display white-space */\n    font-family: monospace;\n    line-height: 120%;\n\n    display: block;\n    margin: 0;\n    padding: 0.3em 0.5em;\n\n    border: 1px solid #ccc;\n    border-radius: 0.125em;\n    background-color: #eee;\n}\neditor-cell[data-active] {\n    border: 1px solid black;\n}\n\n\n/* assumes tool bar on top of editor-cell */\ntool-bar + editor-cell {\n    margin-top: 0;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/editor-cell-element/style.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,8BAA8B,GAAG,4BAA4B;;IAE7D,qBAAqB,GAAG,iCAAiC;IACzD,sBAAsB;IACtB,iBAAiB;;IAEjB,cAAc;IACd,SAAS;IACT,oBAAoB;;IAEpB,sBAAsB;IACtB,sBAAsB;IACtB,sBAAsB;AAC1B;AACA;IACI,uBAAuB;AAC3B;;;AAGA,2CAA2C;AAC3C;IACI,aAAa;AACjB\",\"sourcesContent\":[\"editor-cell {\\n    outline: 0px solid transparent;  /* disable default outline */\\n\\n    white-space: pre-wrap;  /* properly display white-space */\\n    font-family: monospace;\\n    line-height: 120%;\\n\\n    display: block;\\n    margin: 0;\\n    padding: 0.3em 0.5em;\\n\\n    border: 1px solid #ccc;\\n    border-radius: 0.125em;\\n    background-color: #eee;\\n}\\neditor-cell[data-active] {\\n    border: 1px solid black;\\n}\\n\\n\\n/* assumes tool bar on top of editor-cell */\\ntool-bar + editor-cell {\\n    margin-top: 0;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `:root {\n    /* color */\n\n    --bgcolor-tool:          hsl(  0deg   0%  98% / 100%);\n    --bgcolor-cell:          hsl(  0deg   0%  99% / 100%);\n\n    --color-type-markdown:   hsl(205deg 100%  94% / 100%);\n    --color-type-tex:        hsl( 45deg  81%  87% / 100%);\n    --color-type-javascript: hsl( 85deg 100%  85% / 100%);\n\n\n    /* border */\n\n    --border-radius-cell:      0.125em;\n    --border-width-cell:       1px;\n    --border-style-cell:       solid;\n    --border-width-tool:       1px;\n    --border-style-tool:       solid;\n    --border-color-tool:       #ccc;\n    --border-color-cell:       #ccc;\n    --border-color-tool-focus: black;\n    --border-color-cell-focus: black;\n\n\n    /* focus transition */\n\n    --focus-x1-delay:    0s;\n    --focus-x1-duration: 0.2s;\n    --focus-x1-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\n\n    --focus-x2-delay:    calc(var(--focus-x1-duration) / 4);\n    --focus-x2-duration: 0.1s;\n    --focus-x2-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\n}\n\n\ntool-bar {\n    background-color: var(--bgcolor-tool);\n\n    padding: 0.3em 0.5em;\n}\n\neval-cell {\n    background-color: var(--bgcolor-cell);\n\n    outline: 0px solid transparent;  /* disable default outline */\n\n    white-space: pre-wrap;  /* properly display white-space */\n    font-family: monospace;\n    line-height: 140%;\n\n    display: block;\n    margin:  0;\n    padding: 0.3em 0.5em;\n}\n\n.eval-cell-output {\n    display: block;\n    padding: 0.5em;\n\n    white-space: pre-wrap;  /* properly display white-space */\n    line-height: 140%;\n\n    background-color: white;\n}\n.eval-cell-output:has(+ tool-bar),\n.eval-cell-output:has(+ eval-cell) {\n    padding-bottom: 1em;\n}\n\n\n/* border / animated attributes */\n\ntool-bar {\n    overflow: hidden;\n\n    max-height:   0;\n    border-width: 0;\n    padding:      0 0.5em;\n\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n\n    border-radius: var(--border-radius-cell) var(--border-radius-cell) 0 0;\n    border-style:  var(--border-style-tool);\n    border-color:  var(--border-color-tool);\n}\neval-cell {\n    overflow: hidden;\n\n    max-height:   0;\n    border-width: 0;\n    padding:      0 0.5em;\n\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n\n    border-radius: 0 0 var(--border-radius-cell) var(--border-radius-cell);\n    border-style:  var(--border-style-cell);\n    border-color:  transparent var(--border-color-cell) var(--border-color-cell) var(--border-color-cell);\n}\n\n#controls > tool-bar {\n    max-height:   100vh;\n    border-width: var(--border-width-tool);\n    padding:      0 0.5em;\n}\n\ntool-bar:has(+ eval-cell[data-visible]),\ntool-bar:has(+ eval-cell[contenteditable]) {\n    border-top-color:   var(--border-color-tool-focus);\n    border-left-color:  var(--border-color-tool-focus);\n    border-right-color: var(--border-color-tool-focus);\n}\neval-cell[data-visible],\neval-cell[contenteditable] {\n    border-color: transparent var(--border-color-cell-focus) var(--border-color-cell-focus) var(--border-color-cell-focus);\n}\n\ntool-bar:has(+ eval-cell[data-visible]),\ntool-bar:has(+ eval-cell[contenteditable]) {\n    max-height:   100vh;\n    border-width: var(--border-width-tool);\n    padding:      0 0.5em;\n}\neval-cell[data-visible],\neval-cell[contenteditable] {\n    max-height:   100vh;\n    border-width: var(--border-width-cell);\n    padding:      0.3em 0.5em;\n}\n\n\n/* color selected by eval-cell input-type */\n\n\ntool-bar option,\ntool-bar select {\n    background-color: var(--color-type-markdown);\n}\n\ntool-bar option[value=\"javascript\"],\ntool-bar > select:has(> option[value=\"javascript\"]:checked) {\n    background-color: var(--color-type-javascript);\n}\n\ntool-bar option[value=\"tex\"],\ntool-bar > select:has(> option[value=\"tex\"]:checked) {\n    background-color: var(--color-type-tex);\n}\n\n\ntool-bar {\n    border-bottom-color: var(--color-type-markdown);\n}\n\ntool-bar:has(option[value=\"javascript\"]:checked) {\n    border-bottom-color: var(--color-type-javascript);\n}\n\ntool-bar:has(option[value=\"tex\"]:checked) {\n    border-bottom-color: var(--color-type-tex);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/eval-cell-element/style.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,UAAU;;IAEV,qDAAqD;IACrD,qDAAqD;;IAErD,qDAAqD;IACrD,qDAAqD;IACrD,qDAAqD;;;IAGrD,WAAW;;IAEX,kCAAkC;IAClC,8BAA8B;IAC9B,gCAAgC;IAChC,8BAA8B;IAC9B,gCAAgC;IAChC,+BAA+B;IAC/B,+BAA+B;IAC/B,gCAAgC;IAChC,gCAAgC;;;IAGhC,qBAAqB;;IAErB,uBAAuB;IACvB,yBAAyB;IACzB,sDAAsD;;IAEtD,uDAAuD;IACvD,yBAAyB;IACzB,sDAAsD;AAC1D;;;AAGA;IACI,qCAAqC;;IAErC,oBAAoB;AACxB;;AAEA;IACI,qCAAqC;;IAErC,8BAA8B,GAAG,4BAA4B;;IAE7D,qBAAqB,GAAG,iCAAiC;IACzD,sBAAsB;IACtB,iBAAiB;;IAEjB,cAAc;IACd,UAAU;IACV,oBAAoB;AACxB;;AAEA;IACI,cAAc;IACd,cAAc;;IAEd,qBAAqB,GAAG,iCAAiC;IACzD,iBAAiB;;IAEjB,uBAAuB;AAC3B;AACA;;IAEI,mBAAmB;AACvB;;;AAGA,iCAAiC;;AAEjC;IACI,gBAAgB;;IAEhB,eAAe;IACf,eAAe;IACf,qBAAqB;;IAErB,8FAA8F;IAC9F,8FAA8F;IAC9F,8FAA8F;;IAE9F,sEAAsE;IACtE,uCAAuC;IACvC,uCAAuC;AAC3C;AACA;IACI,gBAAgB;;IAEhB,eAAe;IACf,eAAe;IACf,qBAAqB;;IAErB,8FAA8F;IAC9F,8FAA8F;IAC9F,8FAA8F;;IAE9F,sEAAsE;IACtE,uCAAuC;IACvC,qGAAqG;AACzG;;AAEA;IACI,mBAAmB;IACnB,sCAAsC;IACtC,qBAAqB;AACzB;;AAEA;;IAEI,kDAAkD;IAClD,kDAAkD;IAClD,kDAAkD;AACtD;AACA;;IAEI,sHAAsH;AAC1H;;AAEA;;IAEI,mBAAmB;IACnB,sCAAsC;IACtC,qBAAqB;AACzB;AACA;;IAEI,mBAAmB;IACnB,sCAAsC;IACtC,yBAAyB;AAC7B;;;AAGA,2CAA2C;;;AAG3C;;IAEI,4CAA4C;AAChD;;AAEA;;IAEI,8CAA8C;AAClD;;AAEA;;IAEI,uCAAuC;AAC3C;;;AAGA;IACI,+CAA+C;AACnD;;AAEA;IACI,iDAAiD;AACrD;;AAEA;IACI,0CAA0C;AAC9C\",\"sourcesContent\":[\":root {\\n    /* color */\\n\\n    --bgcolor-tool:          hsl(  0deg   0%  98% / 100%);\\n    --bgcolor-cell:          hsl(  0deg   0%  99% / 100%);\\n\\n    --color-type-markdown:   hsl(205deg 100%  94% / 100%);\\n    --color-type-tex:        hsl( 45deg  81%  87% / 100%);\\n    --color-type-javascript: hsl( 85deg 100%  85% / 100%);\\n\\n\\n    /* border */\\n\\n    --border-radius-cell:      0.125em;\\n    --border-width-cell:       1px;\\n    --border-style-cell:       solid;\\n    --border-width-tool:       1px;\\n    --border-style-tool:       solid;\\n    --border-color-tool:       #ccc;\\n    --border-color-cell:       #ccc;\\n    --border-color-tool-focus: black;\\n    --border-color-cell-focus: black;\\n\\n\\n    /* focus transition */\\n\\n    --focus-x1-delay:    0s;\\n    --focus-x1-duration: 0.2s;\\n    --focus-x1-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\\n\\n    --focus-x2-delay:    calc(var(--focus-x1-duration) / 4);\\n    --focus-x2-duration: 0.1s;\\n    --focus-x2-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\\n}\\n\\n\\ntool-bar {\\n    background-color: var(--bgcolor-tool);\\n\\n    padding: 0.3em 0.5em;\\n}\\n\\neval-cell {\\n    background-color: var(--bgcolor-cell);\\n\\n    outline: 0px solid transparent;  /* disable default outline */\\n\\n    white-space: pre-wrap;  /* properly display white-space */\\n    font-family: monospace;\\n    line-height: 140%;\\n\\n    display: block;\\n    margin:  0;\\n    padding: 0.3em 0.5em;\\n}\\n\\n.eval-cell-output {\\n    display: block;\\n    padding: 0.5em;\\n\\n    white-space: pre-wrap;  /* properly display white-space */\\n    line-height: 140%;\\n\\n    background-color: white;\\n}\\n.eval-cell-output:has(+ tool-bar),\\n.eval-cell-output:has(+ eval-cell) {\\n    padding-bottom: 1em;\\n}\\n\\n\\n/* border / animated attributes */\\n\\ntool-bar {\\n    overflow: hidden;\\n\\n    max-height:   0;\\n    border-width: 0;\\n    padding:      0 0.5em;\\n\\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n\\n    border-radius: var(--border-radius-cell) var(--border-radius-cell) 0 0;\\n    border-style:  var(--border-style-tool);\\n    border-color:  var(--border-color-tool);\\n}\\neval-cell {\\n    overflow: hidden;\\n\\n    max-height:   0;\\n    border-width: 0;\\n    padding:      0 0.5em;\\n\\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n\\n    border-radius: 0 0 var(--border-radius-cell) var(--border-radius-cell);\\n    border-style:  var(--border-style-cell);\\n    border-color:  transparent var(--border-color-cell) var(--border-color-cell) var(--border-color-cell);\\n}\\n\\n#controls > tool-bar {\\n    max-height:   100vh;\\n    border-width: var(--border-width-tool);\\n    padding:      0 0.5em;\\n}\\n\\ntool-bar:has(+ eval-cell[data-visible]),\\ntool-bar:has(+ eval-cell[contenteditable]) {\\n    border-top-color:   var(--border-color-tool-focus);\\n    border-left-color:  var(--border-color-tool-focus);\\n    border-right-color: var(--border-color-tool-focus);\\n}\\neval-cell[data-visible],\\neval-cell[contenteditable] {\\n    border-color: transparent var(--border-color-cell-focus) var(--border-color-cell-focus) var(--border-color-cell-focus);\\n}\\n\\ntool-bar:has(+ eval-cell[data-visible]),\\ntool-bar:has(+ eval-cell[contenteditable]) {\\n    max-height:   100vh;\\n    border-width: var(--border-width-tool);\\n    padding:      0 0.5em;\\n}\\neval-cell[data-visible],\\neval-cell[contenteditable] {\\n    max-height:   100vh;\\n    border-width: var(--border-width-cell);\\n    padding:      0.3em 0.5em;\\n}\\n\\n\\n/* color selected by eval-cell input-type */\\n\\n\\ntool-bar option,\\ntool-bar select {\\n    background-color: var(--color-type-markdown);\\n}\\n\\ntool-bar option[value=\\\"javascript\\\"],\\ntool-bar > select:has(> option[value=\\\"javascript\\\"]:checked) {\\n    background-color: var(--color-type-javascript);\\n}\\n\\ntool-bar option[value=\\\"tex\\\"],\\ntool-bar > select:has(> option[value=\\\"tex\\\"]:checked) {\\n    background-color: var(--color-type-tex);\\n}\\n\\n\\ntool-bar {\\n    border-bottom-color: var(--color-type-markdown);\\n}\\n\\ntool-bar:has(option[value=\\\"javascript\\\"]:checked) {\\n    border-bottom-color: var(--color-type-javascript);\\n}\\n\\ntool-bar:has(option[value=\\\"tex\\\"]:checked) {\\n    border-bottom-color: var(--color-type-tex);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* See theme-colors.css for the general colors that are set according\n * to the prefers-color-scheme media query.\n */\n\nbody {\n    --color-bg-settings-dialog-section: var(--color-bg-page-minor);\n    --color-fg-settings-dialog-section: var(--color-c0-page-minor);\n\n    --color-bg-settings-dialog-control: var(--color-bg-tool-active1-awake0);\n    --color-fg-settings-dialog-control: var(--color-c0-tool-active1-awake0);\n\n    --color-bg-settings-dialog-error:   var(--color-bg-page-alert2);\n    --color-fg-settings-dialog-error:   var(--color-c1-page-alert2);\n}\n\n.settings-dialog .dialog_text {\n    font-size: x-large;\n    font-style: italic;\n}\n\n.settings-dialog .section {\n    display: flex;\n}\n\n.settings-dialog [data-section] {\n    position: relative;\n    min-width: max-content;\n    margin: 2rem 0 0 1rem;\n    padding: 1rem;\n    height: max-content;\n    border: 1px solid black;\n    border-radius: 8px;\n    color: var(--color-fg-settings-dialog-section);\n    background: var(--color-bg-settings-dialog-section);\n}\n\n.settings-dialog [data-section]::before {\n    position: absolute;\n    content: attr(data-section);\n    left: 0.8rem;\n    top: -0.7rem;\n    padding: 0 1rem;\n    border: 1px solid #aaa;\n    border-radius: 4px;\n    color: var(--color-fg-settings-dialog-section);\n    background: var(--color-bg-settings-dialog-section);\n    font-style: italic;\n}\n\n.settings-dialog [data-section] [data-setting] label {\n    display: inline-block;\n    width: 9rem;\n    text-align: right;\n    font-family: sans-serif;\n    font-size: small;\n    user-select: none;\n}\n\n.settings-dialog [data-section] [data-setting] input,\n.settings-dialog [data-section] [data-setting] select {\n    color: var(--color-fg-settings-dialog-control);\n    background: var(--color-bg-settings-dialog-control);\n    margin: 0.25rem;\n}\n\n.settings-dialog [data-section] [data-setting] input[type=\"text\"] {\n    width: 5rem;\n}\n\n.settings-dialog .warning {\n    display: none;\n    width: 18rem;\n    margin: 2rem 0 0 1rem;\n    padding: 1rem;\n    height: max-content;\n    border: 1px solid black;\n    border-radius: 8px;\n    color: var(--color-fg-settings-dialog-warning);\n    background: var(--color-bg-settings-dialog-warning);\n}\n.settings-dialog .warning p:first-child {\n    margin-block-start: 0;\n}\n.settings-dialog .warning p:last-child {\n    margin-block-end: 0;\n}\n.settings-dialog .show-emacs-warning .emacs-warning {\n    display: block;\n}\n\n.settings-dialog input[type=\"submit\"] {\n    margin-top: 1rem;\n}\n\n.settings-dialog .error-message {\n    display: none;\n    margin: 2rem 0 0 1rem;\n    max-width: 25vx;\n    padding: 0.5rem;\n    border-radius: 5pt;\n    background-color: var(--color-bg-settings-dialog-error);\n    color: var(--color-fg-settings-dialog-error);\n    height: fit-content;\n}\n.settings-dialog .error-message.active {\n    display: block;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/settings-dialog/settings-dialog.css\"],\"names\":[],\"mappings\":\"AAAA;;EAEE;;AAEF;IACI,8DAA8D;IAC9D,8DAA8D;;IAE9D,uEAAuE;IACvE,uEAAuE;;IAEvE,+DAA+D;IAC/D,+DAA+D;AACnE;;AAEA;IACI,kBAAkB;IAClB,kBAAkB;AACtB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,kBAAkB;IAClB,sBAAsB;IACtB,qBAAqB;IACrB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,kBAAkB;IAClB,8CAA8C;IAC9C,mDAAmD;AACvD;;AAEA;IACI,kBAAkB;IAClB,2BAA2B;IAC3B,YAAY;IACZ,YAAY;IACZ,eAAe;IACf,sBAAsB;IACtB,kBAAkB;IAClB,8CAA8C;IAC9C,mDAAmD;IACnD,kBAAkB;AACtB;;AAEA;IACI,qBAAqB;IACrB,WAAW;IACX,iBAAiB;IACjB,uBAAuB;IACvB,gBAAgB;IAChB,iBAAiB;AACrB;;AAEA;;IAEI,8CAA8C;IAC9C,mDAAmD;IACnD,eAAe;AACnB;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,aAAa;IACb,YAAY;IACZ,qBAAqB;IACrB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,kBAAkB;IAClB,8CAA8C;IAC9C,mDAAmD;AACvD;AACA;IACI,qBAAqB;AACzB;AACA;IACI,mBAAmB;AACvB;AACA;IACI,cAAc;AAClB;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,qBAAqB;IACrB,eAAe;IACf,eAAe;IACf,kBAAkB;IAClB,uDAAuD;IACvD,4CAA4C;IAC5C,mBAAmB;AACvB;AACA;IACI,cAAc;AAClB\",\"sourcesContent\":[\"/* See theme-colors.css for the general colors that are set according\\n * to the prefers-color-scheme media query.\\n */\\n\\nbody {\\n    --color-bg-settings-dialog-section: var(--color-bg-page-minor);\\n    --color-fg-settings-dialog-section: var(--color-c0-page-minor);\\n\\n    --color-bg-settings-dialog-control: var(--color-bg-tool-active1-awake0);\\n    --color-fg-settings-dialog-control: var(--color-c0-tool-active1-awake0);\\n\\n    --color-bg-settings-dialog-error:   var(--color-bg-page-alert2);\\n    --color-fg-settings-dialog-error:   var(--color-c1-page-alert2);\\n}\\n\\n.settings-dialog .dialog_text {\\n    font-size: x-large;\\n    font-style: italic;\\n}\\n\\n.settings-dialog .section {\\n    display: flex;\\n}\\n\\n.settings-dialog [data-section] {\\n    position: relative;\\n    min-width: max-content;\\n    margin: 2rem 0 0 1rem;\\n    padding: 1rem;\\n    height: max-content;\\n    border: 1px solid black;\\n    border-radius: 8px;\\n    color: var(--color-fg-settings-dialog-section);\\n    background: var(--color-bg-settings-dialog-section);\\n}\\n\\n.settings-dialog [data-section]::before {\\n    position: absolute;\\n    content: attr(data-section);\\n    left: 0.8rem;\\n    top: -0.7rem;\\n    padding: 0 1rem;\\n    border: 1px solid #aaa;\\n    border-radius: 4px;\\n    color: var(--color-fg-settings-dialog-section);\\n    background: var(--color-bg-settings-dialog-section);\\n    font-style: italic;\\n}\\n\\n.settings-dialog [data-section] [data-setting] label {\\n    display: inline-block;\\n    width: 9rem;\\n    text-align: right;\\n    font-family: sans-serif;\\n    font-size: small;\\n    user-select: none;\\n}\\n\\n.settings-dialog [data-section] [data-setting] input,\\n.settings-dialog [data-section] [data-setting] select {\\n    color: var(--color-fg-settings-dialog-control);\\n    background: var(--color-bg-settings-dialog-control);\\n    margin: 0.25rem;\\n}\\n\\n.settings-dialog [data-section] [data-setting] input[type=\\\"text\\\"] {\\n    width: 5rem;\\n}\\n\\n.settings-dialog .warning {\\n    display: none;\\n    width: 18rem;\\n    margin: 2rem 0 0 1rem;\\n    padding: 1rem;\\n    height: max-content;\\n    border: 1px solid black;\\n    border-radius: 8px;\\n    color: var(--color-fg-settings-dialog-warning);\\n    background: var(--color-bg-settings-dialog-warning);\\n}\\n.settings-dialog .warning p:first-child {\\n    margin-block-start: 0;\\n}\\n.settings-dialog .warning p:last-child {\\n    margin-block-end: 0;\\n}\\n.settings-dialog .show-emacs-warning .emacs-warning {\\n    display: block;\\n}\\n\\n.settings-dialog input[type=\\\"submit\\\"] {\\n    margin-top: 1rem;\\n}\\n\\n.settings-dialog .error-message {\\n    display: none;\\n    margin: 2rem 0 0 1rem;\\n    max-width: 25vx;\\n    padding: 0.5rem;\\n    border-radius: 5pt;\\n    background-color: var(--color-bg-settings-dialog-error);\\n    color: var(--color-fg-settings-dialog-error);\\n    height: fit-content;\\n}\\n.settings-dialog .error-message.active {\\n    display: block;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* fix display of errors from TeXZilla */\n/* !!! review this later !!! */\nmerror>mtext {\n    display: block;  /* was \"block math\", but this prevents display beyond line 1 of the error message */\n}\n\np,\nh1, h2, h3, h4, h5, h6, h7, h8, h9 {\n    margin-block-start: 0.1em;\n    margin-block-end:   0.1em;\n}\n\n/* expand the margin on error messages from texzilla */\nmerror > mtext {\n    margin: 0.25em;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/style-hacks.css\"],\"names\":[],\"mappings\":\"AAAA,wCAAwC;AACxC,8BAA8B;AAC9B;IACI,cAAc,GAAG,mFAAmF;AACxG;;AAEA;;IAEI,yBAAyB;IACzB,yBAAyB;AAC7B;;AAEA,sDAAsD;AACtD;IACI,cAAc;AAClB\",\"sourcesContent\":[\"/* fix display of errors from TeXZilla */\\n/* !!! review this later !!! */\\nmerror>mtext {\\n    display: block;  /* was \\\"block math\\\", but this prevents display beyond line 1 of the error message */\\n}\\n\\np,\\nh1, h2, h3, h4, h5, h6, h7, h8, h9 {\\n    margin-block-start: 0.1em;\\n    margin-block-end:   0.1em;\\n}\\n\\n/* expand the margin on error messages from texzilla */\\nmerror > mtext {\\n    margin: 0.25em;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `:root {\n    --controls-height: 1.5rem;\n}\n\n:root {\n    /* color */\n\n    --bgcolor-tool:          hsl(0deg 0% 98% / 100%);\n    --bgcolor-cell:          hsl(0deg 0% 99% / 100%);\n\n    --color-type-markdown:   hsl(205deg 100%  94% / 100%);\n    --color-type-tex:        hsl( 45deg  81%  87% / 100%);\n    --color-type-javascript: hsl( 85deg 100%  85% / 100%);\n\n\n    /* border */\n\n    --border-radius-cell:      0.125em;\n    --border-width-cell:       1px;\n    --border-style-cell:       solid;\n    --border-width-tool:       1px;\n    --border-style-tool:       solid;\n    --border-color-tool:       #ccc;\n    --border-color-cell:       #ccc;\n    --border-color-tool-focus: black;\n    --border-color-cell-focus: black;\n\n\n    /* focus transition */\n\n    --focus-x1-delay:    0s;\n    --focus-x1-duration: 0.2s;\n    --focus-x1-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\n\n    --focus-x2-delay:    calc(var(--focus-x1-duration) / 4);\n    --focus-x2-duration: 0.1s;\n    --focus-x2-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\n}\n\n\nbody {\n    margin: 0;\n    background-color: #eee;\n}\n\n#controls {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-start;\n\n    height: var(--controls-height);\n    background-color: #f8f8f8;\n    border-bottom: 1px solid black;\n}\n\n#controls > tool-bar {  /* next to menu */\n    border: 0;\n    align-self: center;\n    margin-left: auto;  /* push to far right */\n    background-color: transparent;\n}\n\ntool-bar {\n    background-color: var(--bgcolor-tool);\n\n    padding: 0.3em 0.5em;\n}\n\neval-cell {\n    background-color: var(--bgcolor-cell);\n\n    outline: 0px solid transparent;  /* disable default outline */\n\n    white-space: pre-wrap;  /* properly display white-space */\n    font-family: monospace;\n    line-height: 140%;\n\n    display: block;\n    margin:  0;\n    padding: 0.3em 0.5em;\n}\n\n.eval-cell-output {\n    display: block;\n    padding: 0.5em;\n\n    white-space: pre-wrap;  /* properly display white-space */\n    line-height: 140%;\n\n    background-color: white;\n}\n.eval-cell-output:has(+ tool-bar),\n.eval-cell-output:has(+ eval-cell) {\n    padding-bottom: 1em;\n}\n\n\n/* border / animated attributes */\n\ntool-bar {\n    overflow: hidden;\n\n    max-height:   0;\n    border-width: 0;\n    padding:      0 0.5em;\n\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n\n    border-radius: var(--border-radius-cell) var(--border-radius-cell) 0 0;\n    border-style:  var(--border-style-tool);\n    border-color:  var(--border-color-tool);\n}\neval-cell {\n    overflow: hidden;\n\n    max-height:   0;\n    border-width: 0;\n    padding:      0 0.5em;\n\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\n\n    border-radius: 0 0 var(--border-radius-cell) var(--border-radius-cell);\n    border-style:  var(--border-style-cell);\n    border-color:  transparent var(--border-color-cell) var(--border-color-cell) var(--border-color-cell);\n}\n\n#controls > tool-bar {\n    max-height:   100vh;\n    border-width: var(--border-width-tool);\n    padding:      0 0.5em;\n}\n\ntool-bar:has(+ eval-cell[data-visible]),\ntool-bar:has(+ eval-cell[contenteditable]) {\n    border-top-color:   var(--border-color-tool-focus);\n    border-left-color:  var(--border-color-tool-focus);\n    border-right-color: var(--border-color-tool-focus);\n}\neval-cell[data-visible],\neval-cell[contenteditable] {\n    border-color: transparent var(--border-color-cell-focus) var(--border-color-cell-focus) var(--border-color-cell-focus);\n}\n\ntool-bar:has(+ eval-cell[data-visible]),\ntool-bar:has(+ eval-cell[contenteditable]) {\n    max-height:   100vh;\n    border-width: var(--border-width-tool);\n    padding:      0 0.5em;\n}\neval-cell[data-visible],\neval-cell[contenteditable] {\n    max-height:   100vh;\n    border-width: var(--border-width-cell);\n    padding:      0.3em 0.5em;\n}\n\n\n/* color selected by eval-cell input-type */\n\n\ntool-bar option,\ntool-bar select {\n    background-color: var(--color-type-markdown);\n}\n\ntool-bar option[value=\"javascript\"],\ntool-bar > select:has(> option[value=\"javascript\"]:checked) {\n    background-color: var(--color-type-javascript);\n}\n\ntool-bar option[value=\"tex\"],\ntool-bar > select:has(> option[value=\"tex\"]:checked) {\n    background-color: var(--color-type-tex);\n}\n\n\ntool-bar {\n    border-bottom-color: var(--color-type-markdown);\n}\n\ntool-bar:has(option[value=\"javascript\"]:checked) {\n    border-bottom-color: var(--color-type-javascript);\n}\n\ntool-bar:has(option[value=\"tex\"]:checked) {\n    border-bottom-color: var(--color-type-tex);\n}\n\n/* === */\n\ntool-bar {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    gap: 0.5em;\n    padding: 0 0.5em;\n}\n\ntool-bar > * {\n    margin: 0;  /* pack controls within tool-bar; let flex gap handle spacing */\n    background-color: hsl(0deg 0% 98% / 100%);\n}\n\n.tool-bar-indicator {\n    display: block;\n    width:  0.5em;\n    height: 0.5em;\n    margin: 0;\n    padding: 0;\n    border-radius: 50%;\n    border: 1px solid hsl(0deg 9% 82% / 100%);\n    background-color: hsl(0deg 0% 97% / 100%);\n}\n\n.tool-bar-indicator.running[data-indicator-value=\"on\"] {\n    border: 1px solid black;\n    background-color: hsl(120deg 94% 40% / 100%);\n}\n.tool-bar-indicator.modified[data-indicator-value=\"on\"] {\n    border: 1px solid black;\n    background-color: hsl(0deg 60% 85% / 100%);\n}\n\ntool-bar > select > option {\n    background-color: hsl(0deg 0% 97% / 100%);\n}\n\n/* === */\n\ntoggle-switch {\n    appearance: none;\n    border: 0;\n    width:  1.5rem;\n    height: 1.5rem;\n}\n\ntoggle-switch svg {\n    width:  auto;\n    height: 100%;\n}\n\ntoggle-switch.tool-bar-toggle-editable                      svg .accent-fill   { fill:   hsl(0deg 9% 82% / 100%); }\ntoggle-switch.tool-bar-toggle-editable                      svg .accent-stroke { stroke: transparent; }\ntoggle-switch.tool-bar-toggle-editable[aria-checked=\"true\"] svg .accent-fill   { fill:   hsl(0deg 60% 70% / 100%); }\ntoggle-switch.tool-bar-toggle-editable[aria-checked=\"true\"] svg .accent-stroke { stroke: transparent; }\n\ntoggle-switch.tool-bar-toggle-visible                       svg .accent-fill   { fill:   transparent; }\ntoggle-switch.tool-bar-toggle-visible                       svg .accent-stroke { stroke: hsl(0deg 9% 82% / 100%); }\ntoggle-switch.tool-bar-toggle-visible[aria-checked=\"true\"]  svg .accent-fill   { fill:   chartreuse; }\ntoggle-switch.tool-bar-toggle-visible[aria-checked=\"true\"]  svg .accent-stroke { stroke: hsl(0deg 100% 45% / 100%); }\n\ntoggle-switch.tool-bar-toggle-autoeval                      svg .accent-fill   { fill:   transparent; }\ntoggle-switch.tool-bar-toggle-autoeval                      svg .accent-stroke { stroke: hsl(0deg 9% 82% / 100%); }\ntoggle-switch.tool-bar-toggle-autoeval[aria-checked=\"true\"] svg .accent-fill   { fill:   transparent; }\ntoggle-switch.tool-bar-toggle-autoeval[aria-checked=\"true\"] svg .accent-stroke { stroke: hsl(0deg 60% 70% / 100%); }\n\n\n/* === print media queries === */\n\n@media not print {\n    /* these overflow styles cause only a single page to be \"printed\" (output) */\n\n    body {\n        overflow: hidden;\n    }\n\n    #content {\n        overflow: auto;\n        max-height: calc(100vh - var(--controls-height));\n    }\n}\n\n@media print {\n\n    #controls {\n        display: none;\n    }\n\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/style.css\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\":root {\\n    --controls-height: 1.5rem;\\n}\\n\\n:root {\\n    /* color */\\n\\n    --bgcolor-tool:          hsl(0deg 0% 98% / 100%);\\n    --bgcolor-cell:          hsl(0deg 0% 99% / 100%);\\n\\n    --color-type-markdown:   hsl(205deg 100%  94% / 100%);\\n    --color-type-tex:        hsl( 45deg  81%  87% / 100%);\\n    --color-type-javascript: hsl( 85deg 100%  85% / 100%);\\n\\n\\n    /* border */\\n\\n    --border-radius-cell:      0.125em;\\n    --border-width-cell:       1px;\\n    --border-style-cell:       solid;\\n    --border-width-tool:       1px;\\n    --border-style-tool:       solid;\\n    --border-color-tool:       #ccc;\\n    --border-color-cell:       #ccc;\\n    --border-color-tool-focus: black;\\n    --border-color-cell-focus: black;\\n\\n\\n    /* focus transition */\\n\\n    --focus-x1-delay:    0s;\\n    --focus-x1-duration: 0.2s;\\n    --focus-x1-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\\n\\n    --focus-x2-delay:    calc(var(--focus-x1-duration) / 4);\\n    --focus-x2-duration: 0.1s;\\n    --focus-x2-easing:   cubic-bezier(0.42, 0.0, 0.0, 1.0);\\n}\\n\\n\\nbody {\\n    margin: 0;\\n    background-color: #eee;\\n}\\n\\n#controls {\\n    display: flex;\\n    align-items: flex-end;\\n    justify-content: flex-start;\\n\\n    height: var(--controls-height);\\n    background-color: #f8f8f8;\\n    border-bottom: 1px solid black;\\n}\\n\\n#controls > tool-bar {  /* next to menu */\\n    border: 0;\\n    align-self: center;\\n    margin-left: auto;  /* push to far right */\\n    background-color: transparent;\\n}\\n\\ntool-bar {\\n    background-color: var(--bgcolor-tool);\\n\\n    padding: 0.3em 0.5em;\\n}\\n\\neval-cell {\\n    background-color: var(--bgcolor-cell);\\n\\n    outline: 0px solid transparent;  /* disable default outline */\\n\\n    white-space: pre-wrap;  /* properly display white-space */\\n    font-family: monospace;\\n    line-height: 140%;\\n\\n    display: block;\\n    margin:  0;\\n    padding: 0.3em 0.5em;\\n}\\n\\n.eval-cell-output {\\n    display: block;\\n    padding: 0.5em;\\n\\n    white-space: pre-wrap;  /* properly display white-space */\\n    line-height: 140%;\\n\\n    background-color: white;\\n}\\n.eval-cell-output:has(+ tool-bar),\\n.eval-cell-output:has(+ eval-cell) {\\n    padding-bottom: 1em;\\n}\\n\\n\\n/* border / animated attributes */\\n\\ntool-bar {\\n    overflow: hidden;\\n\\n    max-height:   0;\\n    border-width: 0;\\n    padding:      0 0.5em;\\n\\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n\\n    border-radius: var(--border-radius-cell) var(--border-radius-cell) 0 0;\\n    border-style:  var(--border-style-tool);\\n    border-color:  var(--border-color-tool);\\n}\\neval-cell {\\n    overflow: hidden;\\n\\n    max-height:   0;\\n    border-width: 0;\\n    padding:      0 0.5em;\\n\\n    transition: max-height   var(--focus-x1-duration) var(--focus-x1-easing) var(--focus-x1-delay);\\n    transition: border-width var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n    transition: padding      var(--focus-x2-duration) var(--focus-x2-easing) var(--focus-x2-delay);\\n\\n    border-radius: 0 0 var(--border-radius-cell) var(--border-radius-cell);\\n    border-style:  var(--border-style-cell);\\n    border-color:  transparent var(--border-color-cell) var(--border-color-cell) var(--border-color-cell);\\n}\\n\\n#controls > tool-bar {\\n    max-height:   100vh;\\n    border-width: var(--border-width-tool);\\n    padding:      0 0.5em;\\n}\\n\\ntool-bar:has(+ eval-cell[data-visible]),\\ntool-bar:has(+ eval-cell[contenteditable]) {\\n    border-top-color:   var(--border-color-tool-focus);\\n    border-left-color:  var(--border-color-tool-focus);\\n    border-right-color: var(--border-color-tool-focus);\\n}\\neval-cell[data-visible],\\neval-cell[contenteditable] {\\n    border-color: transparent var(--border-color-cell-focus) var(--border-color-cell-focus) var(--border-color-cell-focus);\\n}\\n\\ntool-bar:has(+ eval-cell[data-visible]),\\ntool-bar:has(+ eval-cell[contenteditable]) {\\n    max-height:   100vh;\\n    border-width: var(--border-width-tool);\\n    padding:      0 0.5em;\\n}\\neval-cell[data-visible],\\neval-cell[contenteditable] {\\n    max-height:   100vh;\\n    border-width: var(--border-width-cell);\\n    padding:      0.3em 0.5em;\\n}\\n\\n\\n/* color selected by eval-cell input-type */\\n\\n\\ntool-bar option,\\ntool-bar select {\\n    background-color: var(--color-type-markdown);\\n}\\n\\ntool-bar option[value=\\\"javascript\\\"],\\ntool-bar > select:has(> option[value=\\\"javascript\\\"]:checked) {\\n    background-color: var(--color-type-javascript);\\n}\\n\\ntool-bar option[value=\\\"tex\\\"],\\ntool-bar > select:has(> option[value=\\\"tex\\\"]:checked) {\\n    background-color: var(--color-type-tex);\\n}\\n\\n\\ntool-bar {\\n    border-bottom-color: var(--color-type-markdown);\\n}\\n\\ntool-bar:has(option[value=\\\"javascript\\\"]:checked) {\\n    border-bottom-color: var(--color-type-javascript);\\n}\\n\\ntool-bar:has(option[value=\\\"tex\\\"]:checked) {\\n    border-bottom-color: var(--color-type-tex);\\n}\\n\\n/* === */\\n\\ntool-bar {\\n    display: flex;\\n    align-items: center;\\n    justify-content: flex-end;\\n    gap: 0.5em;\\n    padding: 0 0.5em;\\n}\\n\\ntool-bar > * {\\n    margin: 0;  /* pack controls within tool-bar; let flex gap handle spacing */\\n    background-color: hsl(0deg 0% 98% / 100%);\\n}\\n\\n.tool-bar-indicator {\\n    display: block;\\n    width:  0.5em;\\n    height: 0.5em;\\n    margin: 0;\\n    padding: 0;\\n    border-radius: 50%;\\n    border: 1px solid hsl(0deg 9% 82% / 100%);\\n    background-color: hsl(0deg 0% 97% / 100%);\\n}\\n\\n.tool-bar-indicator.running[data-indicator-value=\\\"on\\\"] {\\n    border: 1px solid black;\\n    background-color: hsl(120deg 94% 40% / 100%);\\n}\\n.tool-bar-indicator.modified[data-indicator-value=\\\"on\\\"] {\\n    border: 1px solid black;\\n    background-color: hsl(0deg 60% 85% / 100%);\\n}\\n\\ntool-bar > select > option {\\n    background-color: hsl(0deg 0% 97% / 100%);\\n}\\n\\n/* === */\\n\\ntoggle-switch {\\n    appearance: none;\\n    border: 0;\\n    width:  1.5rem;\\n    height: 1.5rem;\\n}\\n\\ntoggle-switch svg {\\n    width:  auto;\\n    height: 100%;\\n}\\n\\ntoggle-switch.tool-bar-toggle-editable                      svg .accent-fill   { fill:   hsl(0deg 9% 82% / 100%); }\\ntoggle-switch.tool-bar-toggle-editable                      svg .accent-stroke { stroke: transparent; }\\ntoggle-switch.tool-bar-toggle-editable[aria-checked=\\\"true\\\"] svg .accent-fill   { fill:   hsl(0deg 60% 70% / 100%); }\\ntoggle-switch.tool-bar-toggle-editable[aria-checked=\\\"true\\\"] svg .accent-stroke { stroke: transparent; }\\n\\ntoggle-switch.tool-bar-toggle-visible                       svg .accent-fill   { fill:   transparent; }\\ntoggle-switch.tool-bar-toggle-visible                       svg .accent-stroke { stroke: hsl(0deg 9% 82% / 100%); }\\ntoggle-switch.tool-bar-toggle-visible[aria-checked=\\\"true\\\"]  svg .accent-fill   { fill:   chartreuse; }\\ntoggle-switch.tool-bar-toggle-visible[aria-checked=\\\"true\\\"]  svg .accent-stroke { stroke: hsl(0deg 100% 45% / 100%); }\\n\\ntoggle-switch.tool-bar-toggle-autoeval                      svg .accent-fill   { fill:   transparent; }\\ntoggle-switch.tool-bar-toggle-autoeval                      svg .accent-stroke { stroke: hsl(0deg 9% 82% / 100%); }\\ntoggle-switch.tool-bar-toggle-autoeval[aria-checked=\\\"true\\\"] svg .accent-fill   { fill:   transparent; }\\ntoggle-switch.tool-bar-toggle-autoeval[aria-checked=\\\"true\\\"] svg .accent-stroke { stroke: hsl(0deg 60% 70% / 100%); }\\n\\n\\n/* === print media queries === */\\n\\n@media not print {\\n    /* these overflow styles cause only a single page to be \\\"printed\\\" (output) */\\n\\n    body {\\n        overflow: hidden;\\n    }\\n\\n    #content {\\n        overflow: auto;\\n        max-height: calc(100vh - var(--controls-height));\\n    }\\n}\\n\\n@media print {\\n\\n    #controls {\\n        display: none;\\n    }\\n\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* === NAMING LEGEND ===\n *\n * bg: background\n * c0: foreground level 0 (normal)\n * c1: foreground level 1 (highlight)\n *\n * page: page region\n * major: major page region\n * minor: minor page region\n * alert1: alert/warning\n * alert2: error/important\n *\n * tool: toolbar/tab region\n * active0: inactive\n * active1: active\n * awake0: sleeping/unfocused\n * awake1: focused\n */\n\nhtml {\n    --color-bg-page-major:          hsl(  0deg,   0%, 100%);\n    --color-c0-page-major:          hsl(  0deg,   0%,   0%);\n    --color-c1-page-major:          hsl(240deg,  60%,  50%);\n\n    --color-bg-page-minor:          hsl(  0deg,   0%,  95%);\n    --color-c0-page-minor:          hsl(  0deg,   0%,   0%);\n    --color-c1-page-minor:          hsl(240deg,  60%,  50%);\n\n    --color-bg-page-alert1:         hsl( 60deg,  80%,  50%);\n    --color-c0-page-alert1:         hsl(  0deg,   0%,   0%);\n    --color-c1-page-alert1:         hsl(240deg,  60%,  50%);\n\n    --color-bg-page-alert2:         hsl(  0deg,  60%,  50%);\n    --color-c0-page-alert2:         hsl(  0deg,   0%,   0%);\n    --color-c1-page-alert2:         hsl(  0deg,   0%, 100%);\n\n    --color-bg-tool-active0-awake0: hsl(  0deg,   0%,  20%);\n    --color-c0-tool-active0-awake0: hsl(  0deg,   0%, 100%);\n    --color-c1-tool-active0-awake0: hsl(240deg, 100%,  90%);\n\n    --color-bg-tool-active0-awake1: hsl(  0deg,   0%,  35%);\n    --color-c0-tool-active0-awake1: hsl(  0deg,   0%, 100%);\n    --color-c1-tool-active0-awake1: hsl(240deg, 100%,  90%);\n\n    --color-bg-tool-active1-awake0: hsl(  0deg,   0%,  96%);\n    --color-c0-tool-active1-awake0: hsl(  0deg,   0%,   0%);\n    --color-c1-tool-active1-awake0: hsl(  0deg,   0%,  30%);\n\n    --color-bg-tool-active1-awake1: hsl(  0deg,   0%, 100%);\n    --color-c0-tool-active1-awake1: hsl(  0deg,   0%,   0%);\n    --color-c1-tool-active1-awake1: hsl(  0deg,   0%,  30%);\n}\n\nhtml.dark {\n    --color-bg-page-major:          hsl(  0deg,   0%,  25%);\n    --color-c0-page-major:          hsl(  0deg,   0%, 100%);\n    --color-c1-page-major:          hsl(180deg, 100%,  90%);\n\n    --color-bg-page-minor:          hsl(  0deg,   0%,  15%);\n    --color-c0-page-minor:          hsl(  0deg,   0%, 100%);\n    --color-c1-page-minor:          hsl(180deg, 100%,  90%);\n\n    --color-bg-page-alert1:         hsl( 60deg,  80%,  20%);\n    --color-c0-page-alert1:         hsl(  0deg,   0%, 100%);\n    --color-c1-page-alert1:         hsl(180deg, 100%,  90%);\n\n    --color-bg-page-alert2:         hsl(  0deg,  60%,  30%);\n    --color-c0-page-alert2:         hsl(  0deg,   0%, 100%);\n    --color-c1-page-alert2:         hsl(180deg, 100%,  90%);\n\n    --color-bg-tool-active0-awake0: hsl(  0deg,   0%,  20%);\n    --color-c0-tool-active0-awake0: hsl(  0deg,   0%, 100%);\n    --color-c1-tool-active0-awake0: hsl(180deg, 100%,  90%);\n\n    --color-bg-tool-active0-awake1: hsl(  0deg,   0%,  30%);\n    --color-c0-tool-active0-awake1: hsl(  0deg,   0%, 100%);\n    --color-c1-tool-active0-awake1: hsl(180deg, 100%,  90%);\n\n    --color-bg-tool-active1-awake0: hsl(  0deg,   0%,  60%);\n    --color-c0-tool-active1-awake0: hsl(  0deg,   0%,   0%);\n    --color-c1-tool-active1-awake0: hsl(240deg, 100%,  30%);\n\n    --color-bg-tool-active1-awake1: hsl(  0deg,   0%,  70%);\n    --color-c0-tool-active1-awake1: hsl(  0deg,   0%,   0%);\n    --color-c1-tool-active1-awake1: hsl(240deg, 100%,  30%);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/theme-settings/theme-colors.css\"],\"names\":[],\"mappings\":\"AAAA;;;;;;;;;;;;;;;;;EAiBE;;AAEF;IACI,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;AAC3D;;AAEA;IACI,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;;IAEvD,uDAAuD;IACvD,uDAAuD;IACvD,uDAAuD;AAC3D\",\"sourcesContent\":[\"/* === NAMING LEGEND ===\\n *\\n * bg: background\\n * c0: foreground level 0 (normal)\\n * c1: foreground level 1 (highlight)\\n *\\n * page: page region\\n * major: major page region\\n * minor: minor page region\\n * alert1: alert/warning\\n * alert2: error/important\\n *\\n * tool: toolbar/tab region\\n * active0: inactive\\n * active1: active\\n * awake0: sleeping/unfocused\\n * awake1: focused\\n */\\n\\nhtml {\\n    --color-bg-page-major:          hsl(  0deg,   0%, 100%);\\n    --color-c0-page-major:          hsl(  0deg,   0%,   0%);\\n    --color-c1-page-major:          hsl(240deg,  60%,  50%);\\n\\n    --color-bg-page-minor:          hsl(  0deg,   0%,  95%);\\n    --color-c0-page-minor:          hsl(  0deg,   0%,   0%);\\n    --color-c1-page-minor:          hsl(240deg,  60%,  50%);\\n\\n    --color-bg-page-alert1:         hsl( 60deg,  80%,  50%);\\n    --color-c0-page-alert1:         hsl(  0deg,   0%,   0%);\\n    --color-c1-page-alert1:         hsl(240deg,  60%,  50%);\\n\\n    --color-bg-page-alert2:         hsl(  0deg,  60%,  50%);\\n    --color-c0-page-alert2:         hsl(  0deg,   0%,   0%);\\n    --color-c1-page-alert2:         hsl(  0deg,   0%, 100%);\\n\\n    --color-bg-tool-active0-awake0: hsl(  0deg,   0%,  20%);\\n    --color-c0-tool-active0-awake0: hsl(  0deg,   0%, 100%);\\n    --color-c1-tool-active0-awake0: hsl(240deg, 100%,  90%);\\n\\n    --color-bg-tool-active0-awake1: hsl(  0deg,   0%,  35%);\\n    --color-c0-tool-active0-awake1: hsl(  0deg,   0%, 100%);\\n    --color-c1-tool-active0-awake1: hsl(240deg, 100%,  90%);\\n\\n    --color-bg-tool-active1-awake0: hsl(  0deg,   0%,  96%);\\n    --color-c0-tool-active1-awake0: hsl(  0deg,   0%,   0%);\\n    --color-c1-tool-active1-awake0: hsl(  0deg,   0%,  30%);\\n\\n    --color-bg-tool-active1-awake1: hsl(  0deg,   0%, 100%);\\n    --color-c0-tool-active1-awake1: hsl(  0deg,   0%,   0%);\\n    --color-c1-tool-active1-awake1: hsl(  0deg,   0%,  30%);\\n}\\n\\nhtml.dark {\\n    --color-bg-page-major:          hsl(  0deg,   0%,  25%);\\n    --color-c0-page-major:          hsl(  0deg,   0%, 100%);\\n    --color-c1-page-major:          hsl(180deg, 100%,  90%);\\n\\n    --color-bg-page-minor:          hsl(  0deg,   0%,  15%);\\n    --color-c0-page-minor:          hsl(  0deg,   0%, 100%);\\n    --color-c1-page-minor:          hsl(180deg, 100%,  90%);\\n\\n    --color-bg-page-alert1:         hsl( 60deg,  80%,  20%);\\n    --color-c0-page-alert1:         hsl(  0deg,   0%, 100%);\\n    --color-c1-page-alert1:         hsl(180deg, 100%,  90%);\\n\\n    --color-bg-page-alert2:         hsl(  0deg,  60%,  30%);\\n    --color-c0-page-alert2:         hsl(  0deg,   0%, 100%);\\n    --color-c1-page-alert2:         hsl(180deg, 100%,  90%);\\n\\n    --color-bg-tool-active0-awake0: hsl(  0deg,   0%,  20%);\\n    --color-c0-tool-active0-awake0: hsl(  0deg,   0%, 100%);\\n    --color-c1-tool-active0-awake0: hsl(180deg, 100%,  90%);\\n\\n    --color-bg-tool-active0-awake1: hsl(  0deg,   0%,  30%);\\n    --color-c0-tool-active0-awake1: hsl(  0deg,   0%, 100%);\\n    --color-c1-tool-active0-awake1: hsl(180deg, 100%,  90%);\\n\\n    --color-bg-tool-active1-awake0: hsl(  0deg,   0%,  60%);\\n    --color-c0-tool-active1-awake0: hsl(  0deg,   0%,   0%);\\n    --color-c1-tool-active1-awake0: hsl(240deg, 100%,  30%);\\n\\n    --color-bg-tool-active1-awake1: hsl(  0deg,   0%,  70%);\\n    --color-c0-tool-active1-awake1: hsl(  0deg,   0%,   0%);\\n    --color-c1-tool-active1-awake1: hsl(240deg, 100%,  30%);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `toggle-switch {\n    appearance: none;\n    border: 0;\n    width:  1.5rem;\n    height: 1.5rem;\n}\n\ntoggle-switch svg {\n    width:  auto;\n    height: 100%;\n}\n\ntoggle-switch                      svg .accent-fill   { fill:   transparent; }\ntoggle-switch                      svg .accent-stroke { stroke: hsl(0deg 9% 82% / 100%); }\ntoggle-switch[aria-checked=\"true\"] svg .accent-fill   { fill:   transparent; }\ntoggle-switch[aria-checked=\"true\"] svg .accent-stroke { stroke: hsl(0deg 60% 70% / 100%); }\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/toggle-switch-element/style.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,gBAAgB;IAChB,SAAS;IACT,cAAc;IACd,cAAc;AAClB;;AAEA;IACI,YAAY;IACZ,YAAY;AAChB;;AAEA,wDAAwD,mBAAmB,EAAE;AAC7E,wDAAwD,+BAA+B,EAAE;AACzF,wDAAwD,mBAAmB,EAAE;AAC7E,wDAAwD,gCAAgC,EAAE\",\"sourcesContent\":[\"toggle-switch {\\n    appearance: none;\\n    border: 0;\\n    width:  1.5rem;\\n    height: 1.5rem;\\n}\\n\\ntoggle-switch svg {\\n    width:  auto;\\n    height: 100%;\\n}\\n\\ntoggle-switch                      svg .accent-fill   { fill:   transparent; }\\ntoggle-switch                      svg .accent-stroke { stroke: hsl(0deg 9% 82% / 100%); }\\ntoggle-switch[aria-checked=\\\"true\\\"] svg .accent-fill   { fill:   transparent; }\\ntoggle-switch[aria-checked=\\\"true\\\"] svg .accent-stroke { stroke: hsl(0deg 60% 70% / 100%); }\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `tool-bar {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    gap: 0.5em;\n    padding: 0 0.5em;\n}\n\ntool-bar > * {\n    margin: 0;  /* pack controls within tool-bar; let flex gap handle spacing */\n    background-color: hsl(0deg 0% 98% / 100%);\n}\n\n.tool-bar-indicator {\n    display: block;\n    width:  0.5em;\n    height: 0.5em;\n    margin: 0;\n    padding: 0;\n    border-radius: 50%;\n    border: 1px solid hsl(0deg 9% 82% / 100%);\n    background-color: hsl(0deg 0% 97% / 100%);\n}\n\n.tool-bar-indicator.running[data-indicator-value=\"on\"] {\n    border: 1px solid black;\n    background-color: hsl(120deg 94% 40% / 100%);\n}\n.tool-bar-indicator.modified[data-indicator-value=\"on\"] {\n    border: 1px solid black;\n    background-color: hsl(0deg 60% 85% / 100%);\n}\n\ntool-bar > select > option {\n    background-color: hsl(0deg 0% 97% / 100%);\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/tool-bar-element/style.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,aAAa;IACb,mBAAmB;IACnB,yBAAyB;IACzB,UAAU;IACV,gBAAgB;AACpB;;AAEA;IACI,SAAS,GAAG,+DAA+D;IAC3E,yCAAyC;AAC7C;;AAEA;IACI,cAAc;IACd,aAAa;IACb,aAAa;IACb,SAAS;IACT,UAAU;IACV,kBAAkB;IAClB,yCAAyC;IACzC,yCAAyC;AAC7C;;AAEA;IACI,uBAAuB;IACvB,4CAA4C;AAChD;AACA;IACI,uBAAuB;IACvB,0CAA0C;AAC9C;;AAEA;IACI,yCAAyC;AAC7C\",\"sourcesContent\":[\"tool-bar {\\n    display: flex;\\n    align-items: center;\\n    justify-content: flex-end;\\n    gap: 0.5em;\\n    padding: 0 0.5em;\\n}\\n\\ntool-bar > * {\\n    margin: 0;  /* pack controls within tool-bar; let flex gap handle spacing */\\n    background-color: hsl(0deg 0% 98% / 100%);\\n}\\n\\n.tool-bar-indicator {\\n    display: block;\\n    width:  0.5em;\\n    height: 0.5em;\\n    margin: 0;\\n    padding: 0;\\n    border-radius: 50%;\\n    border: 1px solid hsl(0deg 9% 82% / 100%);\\n    background-color: hsl(0deg 0% 97% / 100%);\\n}\\n\\n.tool-bar-indicator.running[data-indicator-value=\\\"on\\\"] {\\n    border: 1px solid black;\\n    background-color: hsl(120deg 94% 40% / 100%);\\n}\\n.tool-bar-indicator.modified[data-indicator-value=\\\"on\\\"] {\\n    border: 1px solid black;\\n    background-color: hsl(0deg 60% 85% / 100%);\\n}\\n\\ntool-bar > select > option {\\n    background-color: hsl(0deg 0% 97% / 100%);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","/*! sprintf-js v1.1.2 | Copyright (c) 2007-present, Alexandru Mrteanu <hello@alexei.ro> | BSD-3-Clause */\n!function(){\"use strict\";var g={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\\x25]+/,modulo:/^\\x25{2}/,placeholder:/^\\x25(?:([1-9]\\d*)\\$|\\(([^)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\\d]*)/i,key_access:/^\\.([a-z_][a-z_\\d]*)/i,index_access:/^\\[(\\d+)\\]/,sign:/^[+-]/};function y(e){return function(e,t){var r,n,i,s,a,o,p,c,l,u=1,f=e.length,d=\"\";for(n=0;n<f;n++)if(\"string\"==typeof e[n])d+=e[n];else if(\"object\"==typeof e[n]){if((s=e[n]).keys)for(r=t[u],i=0;i<s.keys.length;i++){if(null==r)throw new Error(y('[sprintf] Cannot access property \"%s\" of undefined value \"%s\"',s.keys[i],s.keys[i-1]));r=r[s.keys[i]]}else r=s.param_no?t[s.param_no]:t[u++];if(g.not_type.test(s.type)&&g.not_primitive.test(s.type)&&r instanceof Function&&(r=r()),g.numeric_arg.test(s.type)&&\"number\"!=typeof r&&isNaN(r))throw new TypeError(y(\"[sprintf] expecting number but found %T\",r));switch(g.number.test(s.type)&&(c=0<=r),s.type){case\"b\":r=parseInt(r,10).toString(2);break;case\"c\":r=String.fromCharCode(parseInt(r,10));break;case\"d\":case\"i\":r=parseInt(r,10);break;case\"j\":r=JSON.stringify(r,null,s.width?parseInt(s.width):0);break;case\"e\":r=s.precision?parseFloat(r).toExponential(s.precision):parseFloat(r).toExponential();break;case\"f\":r=s.precision?parseFloat(r).toFixed(s.precision):parseFloat(r);break;case\"g\":r=s.precision?String(Number(r.toPrecision(s.precision))):parseFloat(r);break;case\"o\":r=(parseInt(r,10)>>>0).toString(8);break;case\"s\":r=String(r),r=s.precision?r.substring(0,s.precision):r;break;case\"t\":r=String(!!r),r=s.precision?r.substring(0,s.precision):r;break;case\"T\":r=Object.prototype.toString.call(r).slice(8,-1).toLowerCase(),r=s.precision?r.substring(0,s.precision):r;break;case\"u\":r=parseInt(r,10)>>>0;break;case\"v\":r=r.valueOf(),r=s.precision?r.substring(0,s.precision):r;break;case\"x\":r=(parseInt(r,10)>>>0).toString(16);break;case\"X\":r=(parseInt(r,10)>>>0).toString(16).toUpperCase()}g.json.test(s.type)?d+=r:(!g.number.test(s.type)||c&&!s.sign?l=\"\":(l=c?\"+\":\"-\",r=r.toString().replace(g.sign,\"\")),o=s.pad_char?\"0\"===s.pad_char?\"0\":s.pad_char.charAt(1):\" \",p=s.width-(l+r).length,a=s.width&&0<p?o.repeat(p):\"\",d+=s.align?l+r+a:\"0\"===o?l+a+r:a+l+r)}return d}(function(e){if(p[e])return p[e];var t,r=e,n=[],i=0;for(;r;){if(null!==(t=g.text.exec(r)))n.push(t[0]);else if(null!==(t=g.modulo.exec(r)))n.push(\"%\");else{if(null===(t=g.placeholder.exec(r)))throw new SyntaxError(\"[sprintf] unexpected placeholder\");if(t[2]){i|=1;var s=[],a=t[2],o=[];if(null===(o=g.key.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");for(s.push(o[1]);\"\"!==(a=a.substring(o[0].length));)if(null!==(o=g.key_access.exec(a)))s.push(o[1]);else{if(null===(o=g.index_access.exec(a)))throw new SyntaxError(\"[sprintf] failed to parse named argument key\");s.push(o[1])}t[2]=s}else i|=2;if(3===i)throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\");n.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}r=r.substring(t[0].length)}return p[e]=n}(e),arguments)}function e(e,t){return y.apply(null,[e].concat(t||[]))}var p=Object.create(null);\"undefined\"!=typeof exports&&(exports.sprintf=y,exports.vsprintf=e),\"undefined\"!=typeof window&&(window.sprintf=y,window.vsprintf=e,\"function\"==typeof define&&define.amd&&define(function(){return{sprintf:y,vsprintf:e}}))}();\n//# sourceMappingURL=sprintf.min.js.map\n","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./settings-dialog.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./settings-dialog.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/css-loader/dist/cjs.js!./style-hacks.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/css-loader/dist/cjs.js!./style-hacks.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/css-loader/dist/cjs.js!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/css-loader/dist/cjs.js!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./theme-colors.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./theme-colors.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\"use strict\";\n\nvar stylesInDOM = [];\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n}\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n    identifiers.push(identifier);\n  }\n  return identifiers;\n}\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n  return updater;\n}\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n    var newLastIdentifiers = modulesToDom(newList, options);\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n      var _index = getIndexByIdentifier(_identifier);\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n\n/* istanbul ignore next  */\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target);\n\n    // Special case to return head of iframe instead of iframe itself\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n    memo[target] = styleTarget;\n  }\n  return memo[target];\n}\n\n/* istanbul ignore next  */\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n  target.appendChild(style);\n}\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n  var needLayer = typeof obj.layer !== \"undefined\";\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n  css += obj.css;\n  if (needLayer) {\n    css += \"}\";\n  }\n  if (obj.media) {\n    css += \"}\";\n  }\n  if (obj.supports) {\n    css += \"}\";\n  }\n  var sourceMap = obj.sourceMap;\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  }\n\n  // For old IE\n  /* istanbul ignore if  */\n  options.styleTagTransform(css, styleElement, options.options);\n}\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n  styleElement.parentNode.removeChild(styleElement);\n}\n\n/* istanbul ignore next  */\nfunction domAPI(options) {\n  if (typeof document === \"undefined\") {\n    return {\n      update: function update() {},\n      remove: function remove() {}\n    };\n  }\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\nmodule.exports = styleTagTransform;","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(() => {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = () => ([]);\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 5979;\nmodule.exports = webpackEmptyAsyncContext;","export class EventListenerManager {\n    constructor() {\n        this.#specs = [];\n    }\n    #specs;  // array of { element, type, listener, options }\n\n    empty (){ return this.#specs.length <= 0; }\n\n    add(target, type, listener, options) {\n        //!!! options is not copied, and yet is used later\n        //!!! could use structuredClone(), but would that prevent remove() from finding?\n        const spec = { target, type, listener, options };\n        this.constructor.#validate_spec(spec);\n        if (this.#first_spec_index_of(spec) !== -1) {\n            throw new Error('equivalent event handler already added');\n        }\n        target.addEventListener(type, listener, options);\n        this.#specs.push(spec);\n    }\n\n    remove(target, type, listener, options) {\n        const spec = { target, type, listener, options };\n        this.constructor.#validate_spec(spec);\n        const index = this.#first_spec_index_of(spec);\n        if (index === -1) {\n            throw new Error('specified event handler not found');\n        }\n        this.#specs.splice(index, 1);\n        target.removeEventListener(target, type, options);\n    }\n\n    remove_all() {\n        for (const spec of this.#specs) {\n            const { target, type, listener, options } = spec;\n            target.removeEventListener(type, listener, options);\n        }\n        this.#specs.splice(0);  // remove all entries\n    }\n\n    reattach() {\n        for (const spec of this.#specs) {\n            const { target, type, listener, options } = spec;\n            target.removeEventListener(type, listener, options);\n            target.addEventListener(type, listener, options);\n        }\n    }\n\n\n    // === INTERNAL ===\n\n    // returns -1 if not found, otherwise a positive integer\n    #first_spec_index_of(search_spec) {\n        for (let i = 0; i < this.#specs.length; i++) {\n            if (this.constructor.#same_specs(search_spec, this.#specs[i])) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    // returns true iff spec is for a listener that uses \"capture\"\n    static #validate_spec(spec) {\n        if (typeof spec !== 'object') {\n            throw new Error('spec must be an object');\n        }\n        let uses_capture = false;\n        const { target, type, listener, options } = spec;\n        if (!(target instanceof EventTarget)) {\n            throw new Error('target must be an instance of EventTarget');\n        }\n        if (typeof type !== 'string') {\n            throw new Error('type in spec must be a string');\n        }\n        if (typeof listener !== 'function') {\n            throw new Error('listener in spec must be a function');\n        }\n        // removeEventListener() only pays attention to the \"capture\" effect\n        // of a handler when determining which handler to remove.\n        if (typeof options === 'boolean') {\n            uses_capture = options;\n        } else if (typeof options === 'object') {\n            uses_capture = !!options.capture;\n        } else if (typeof options !== 'undefined') {\n            throw new Error('options in spec must be a undefined, boolean, or an object');\n        }\n        return uses_capture;\n    }\n\n    // return truthy iff spec1 and spec2 are the same for the purposes of removal\n    static #same_specs(spec1, spec2) {\n        const uses_capture1 = this.#validate_spec(spec1);\n        const uses_capture2 = this.#validate_spec(spec2);\n        if (uses_capture1 !== uses_capture2) {\n            return false;\n        } else {\n            return (spec1.target === spec2.target && spec1.type === spec2.type && spec1.listener === spec2.listener);\n        }\n        //!!! should other members of options be checked (e.g., \"once\")?\n    }\n}\n","import {\n    OpenPromise,\n} from './open-promise.js';\n\nimport {\n    generate_object_id,\n} from './uuid.js';\n\n\nclass FsInterface {\n    // Determine if the File System Access API is available\n    static fsaapi_available = ( globalThis.FileSystemHandle &&\n                                globalThis.FileSystemFileHandle &&\n                                globalThis.FileSystemDirectoryHandle &&\n                                typeof globalThis.showOpenFilePicker  === 'function' &&\n                                typeof globalThis.showSaveFilePicker  === 'function' &&\n                                typeof globalThis.showDirectoryPicker === 'function'    );\n\n    static ensure_fsaapi_available() {\n        if (!this.fsaapi_available) {\n            throw new Error('unexpected: File System API is not available');\n        }\n    }\n\n    get fsaapi_available (){ return this.constructor.fsaapi_available; }\n\n    /** Verify permission to access the given FileSystemHandle, prompting the user if necessary\n     *  @param {FileSystemHandle} file_handle\n     *  @param {boolean} for_writing\n     *  @return {Promise} resolves if permission granted, rejects if permission not granted\n     */\n    async verify_permission(file_handle, for_writing=false) {\n        this.constructor.ensure_fsaapi_available();\n        const options = {};\n        if (for_writing) {\n            options.writable = true;  // File System API legacy\n            options.mode = 'readwrite';\n        }\n        return ( await file_handle.queryPermission(options)   === 'granted' ||\n                 await file_handle.requestPermission(options) === 'granted'    );\n    }\n\n    /** Save text to the file associated with a FileSystemFileHandle,\n     *  with the FileSystemFileHandle possibly gotten from prompting user.\n     *  @param {function} get_text nullary function to obtain text to be saved\n     *  @param {Object} options: {\n     *             file_handle?:    FileSystemFileHandle,  // if given, then open from file_handle without dialog\n     *             prompt_options?: Object,                // if given, then options for showSaveFilePicker() dialog\n     *         }\n     *  @return {Promise} resolves to { canceled: true }|{ file_handle: FileSystemFileHandle, stats: Object }\n     *          where stats is as returned by get_fs_stats_for_file()\n     */\n    async save(get_text, options) {\n        if (!this.fsaapi_available) {\n            return this.legacy_save(get_text, options);\n        }\n\n        options = options ?? {};\n\n        let file_handle = options.file_handle;\n        if (!file_handle) {\n            const prompt_result = await this.prompt_for_save(options.prompt_options);\n            if (prompt_result.canceled) {\n                return { canceled: true };\n            }\n            file_handle = prompt_result.file_handle;\n        }\n\n        await this.verify_permission(file_handle, true);\n        const text = get_text();\n        const writable = await file_handle.createWritable();\n        await writable.write(text);\n        await writable.close();\n        const stats = await this.get_fs_stats_for_file_handle(file_handle);\n\n        return { file_handle, stats };\n    }\n\n    /** Load text from the file associated with a FileSystemFileHandle,\n     *  with the FileSystemFileHandle possibly gotten from prompting user.\n     *  @param {Object} options {\n     *             file_handle?:    FileSystemFileHandle,  // if given, then open from file_handle without dialog\n     *             prompt_options?: Object,                // if given, then options for showOpenFilePicker() dialog\n     *         }\n     *  @return {Promise} resolves to { canceled: true }|{ file_handle: FileSystemFileHandle, text: string, stats: Object }\n     *          where stats is as returned by get_fs_stats_for_file()\n     */\n    async open(options) {\n        if (!this.fsaapi_available) {\n            return this.legacy_open(options);\n        }\n\n        options = options ?? {};\n\n        let file_handle = options.file_handle;\n        if (!file_handle) {\n            const prompt_result = await this.prompt_for_open(options.prompt_options);\n            if (prompt_result.canceled) {\n                return { canceled: true };\n            }\n            file_handle = prompt_result.file_handle;\n        }\n\n        await this.verify_permission(file_handle, false);\n        const file = await file_handle.getFile();\n        const text = await file.text();\n        const stats = this.get_fs_stats_for_file(file);\n\n        return { file_handle, text, stats };\n    }\n\n    /** Return stats for the file associated with a FileSystemFileHandle\n     *  @param {FileSystemFileHandle} file_handle\n     *  @return {Promise} resolves to stats as returned by get_fs_stats_for_file()\n     */\n    async get_fs_stats_for_file_handle(file_handle) {\n        this.constructor.ensure_fsaapi_available();\n        await this.verify_permission(file_handle);\n        const file = await file_handle.getFile();\n        return this.get_fs_stats_for_file(file);\n    }\n\n    /** Return stats for the file\n     *  @param {File} file\n     *  @return {object} stats: {\n     *              lastModified:  number,  // the \"last modified\" time of the file in milliseconds since the UNIX epoch (January 1, 1970 at Midnight UTC)\n     *              last_modified: number,  // synonym for lastModified\n     *              name:          string,  // name of file\n     *              size:          number,  // size of file in bytes\n     *              type:          string,  // MIME type of file contents\n     *          }\n     */\n    get_fs_stats_for_file(file) {\n        const {\n            lastModified,\n            lastModified: last_modified,\n            name,\n            size,\n            type,\n        } = file;\n\n        return {\n            lastModified,\n            last_modified,\n            name,\n            size,\n            type,\n        };\n    }\n\n    /** Show a file picker for the user to select a file for saving\n     *  @param {object|undefined} options for showSaveFilePicker()\n     *  @return {Promise} resolves to { canceled: true }|{ file_handle: FileSystemFileHandle }\n     */\n    async prompt_for_save(options=undefined) {\n        this.constructor.ensure_fsaapi_available();\n        const result = await this._prompt(globalThis.showSaveFilePicker, options);\n        return result\n            ? { file_handle: result }\n            : { canceled: true };\n    }\n\n    /** Show a file picker for the user to select a file for loading\n     *  @param {object|undefined} options for showOpenFilePicker()\n     *  @return {Promise} resolves to { canceled: true }|{ file_handle: FileSystemFileHandle }\n     */\n    async prompt_for_open(options=undefined) {\n        this.constructor.ensure_fsaapi_available();\n        options = options ?? {};\n        const result = await this._prompt(globalThis.showOpenFilePicker, { ...options, multiple: false });\n        return result\n            ? { file_handle: result[0] }\n            : { canceled: true };\n    }\n\n    async _prompt(picker, options) {\n        options = options ?? {};\n        let result;\n        try {\n            return await picker(options);\n        } catch (err) {\n            // Chromium no longer throws AbortError, instead it throws\n            // a DOMException, so just count any exception as \"canceled\"\n            return undefined;  // indicate: canceled\n        }\n    }\n\n    // === LEGACY ===\n\n    /** Save text to a file chosen by the user with the legacy File API.\n     *  @param {function} get_text nullary function to obtain text to be saved\n     *  @param {Object} options {\n     *             prompt_options?: Object,  // if given, then options for showSaveFilePicker() dialog (will be converted)\n     *         }\n     *  @return {Promise} resolves to { canceled: true }|{ stats: Object }\n     *          where stats is as returned by get_fs_stats_for_file()\n     */\n    async legacy_save(get_text, options) {\n        return new Promise((resolve, reject) => {\n            const text = get_text();\n            const a_el = document.createElement('a');\n            a_el.download = options?.name ?? 'Untitled.logbook';\n            a_el.href = URL.createObjectURL(new Blob([text], { type: 'text/plain'}));\n            // document.body.addEventListener('focus', ...) does not get activated, even if capture is set\n            document.body.onfocus = (event) => {\n                document.body.onfocus = null;\n                URL.revokeObjectURL(a_el.href);\n                a_el.href = null;\n                resolve({});//!!! no stats\n            };\n            a_el.click();\n        });\n    }\n\n    /** Load text from the file associated with a FileSystemFileHandle,\n     *  with the FileSystemFileHandle possibly gotten from prompting user.\n     *  @param {Object} options {\n     *             prompt_options?: Object,  // if given, then options for showOpenFilePicker() dialog (will be converted)\n     *         }\n     *  @return {Promise} resolves to { canceled: true }|{ text: string, stats: Object }\n     *          where stats is as returned by get_fs_stats_for_file()\n     */\n    async legacy_open(options) {\n        const accept = this._convert_options_for_legacy(options);\n\n        // For browsers that do not support the File System Access API (e.g., Firefox)\n        // opening files is implemented by a file-type input element.  There is a\n        // problem with that, though: if the user activates the file open panel and\n        // then cancels, no event is emitted that we can use to subsequently remove\n        // the input element.\n        // Another issue is that the input element will not activate in Firefox (at\n        // the time of writing) unless the input element is part of the DOM.\n        // Fortunately, the input element need not be displayed in order for it to\n        // work.\n        // Therefore, once we create the input element, we just leave it in the DOM,\n        // hidden, and reuse it whenever necessary.\n\n        let i_el = document.getElementById(this.constructor.legacy_file_input_element_id);\n        if (!i_el) {\n            i_el = document.createElement('input');\n            i_el.id = this.constructor.legacy_file_input_element_id;\n            i_el.classList.add('hidden-fs-interface-element');  // css class definition in notebook/notebook.css\n            i_el.type = 'file';\n            if (accept) {\n                i_el.accept = accept;\n            }\n            document.body.insertBefore(i_el, document.body.firstChild);  // put at beginning of document body\n        }\n\n        const op = new OpenPromise();\n\n        i_el.onchange = async (event) => {\n            if (i_el.files.length <= 0) {\n                op.resolve({ canceled: true });\n            } else {\n                const file = i_el.files[0];\n                const text  = await file.text();\n                const stats = this.get_fs_stats_for_file(file);\n                op.resolve({\n                    text,\n                    stats,\n                });\n            }\n        }\n\n        // activate the file open panel\n        i_el.click();\n\n        return op.promise;\n    }\n\n    static legacy_file_input_element_id = 'legacy_file_input_element_id';\n\n    _convert_options_for_legacy(options) {\n        options = options ?? {};\n        const options_accept = options?.prompt_options?.types?.[0]?.accept;\n        const accept = !options_accept ? undefined : Object.keys(options_accept);\n        return accept;\n    }\n}\n\nexport const fs_interface = new FsInterface();\n","export function get_obj_path(obj, path) {\n    for (const segment of path) {\n        obj = (obj ?? {})[segment];\n    }\n    return obj;\n}\n\nexport function set_obj_path(obj, path, value) {\n    if (path.length < 1) {\n        throw new Error('path must contain at least one segment');\n    }\n    for (const segment of path.slice(0, -1)) {\n        if (typeof obj[segment] === 'undefined') {\n            obj[segment] = {};\n        }\n        obj = obj[segment];\n    }\n    obj[path.slice(-1)[0]] = value;\n}\n","/** a Promise-like object with its resolve and reject methods exposed externally\n */\nexport class OpenPromise {\n    constructor() {\n        let resolve, reject;\n        const promise = new Promise((o, x) => { resolve = o; reject = x; });\n        Object.defineProperties(this, {\n            promise: {\n                value: promise,\n            },\n            resolve: {\n                value: resolve,\n            },\n            reject: {\n                value: reject,\n            },\n            then: {\n                value: promise.then.bind(promise),\n            },\n            catch: {\n                value: promise.catch.bind(promise),\n            },\n            finally: {\n                value: promise.finally.bind(promise),\n            },\n        });\n    }\n\n    async await() { return await this.promise; }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    load_script,\n} from '../ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../../src/assets-server-url.js';\n\n\n// The \"esm\" distribution of rxjs is suitable for nodejs but not for\n// within browsers (at least currently) because it internally imports\n// files without specifying their \".js\" extensions assuming that the\n// extension will be implicitly added.  Imports in browsers require\n// an explicit full path.\n// Therefore, load the bundle version (which stores the result in\n// globalThis.rxjs) and deal with it that way\n// DOES NOT WORK: import * as rxjs from '../../node_modules/rxjs/dist/esm/index.js';\n\nconst rxjs_url = new URL('../../node_modules/rxjs/dist/bundles/rxjs.umd.min.js', assets_server_url(current_script_url));\nawait load_script(document.head, rxjs_url);\n\nexport default { ...globalThis.rxjs };\nglobalThis.rxjs = undefined;  // remove from global environment\n","// const current_script_url = import.meta.url;  // save for later\n// import {\n//     load_script,\n// } from '../ui/dom-util.js';\n// import {\n//     assets_server_url,\n// } from '../../src/assets-server-url.js';\n// // await load_script(document.head, new URL('../../node_modules/sprintf-js/dist/sprintf.min.js', assets_server_url(current_script_url)));\n\nimport '../../node_modules/sprintf-js/dist/sprintf.min.js';  // webkit implementaion\n\nexport const sprintf = globalThis.sprintf;\n","export class Stoppable {\n    /** create a new Stoppable object\n     *  @param {Object} target object that may be stopped\n     *  @param {Function} stopper function that takes target and stops it; default: (target) => target.stop()\n     *  @param {Boolean} multiple_stops whether or not target's stop method may be called multiple times\n     */\n    constructor(target, stopper=null, multiple_stops=false) {\n        if (target === null || typeof target === 'undefined') {\n            throw new Error('target must not be null or undefined');\n        }\n        stopper ??= (target) => target.stop();  // default\n        if (typeof stopper !== 'function') {\n            throw new Error('stopper must be a function taking target as a parameter');\n        }\n        Object.defineProperties(this, {\n            target: {\n                value: target,\n                enumerable: true,\n            },\n            stopper: {\n                value: stopper,\n                enumerable: true,\n            },\n            multiple_stops: {\n                value: multiple_stops,\n                enumerable: true,\n            },\n        });\n        this.#stop_count = 0;\n    }\n    #stop_count;\n\n    get stop_count (){ return this.#stop_count; }\n\n    get stopped (){ return this.#stop_count > 0; }\n\n    /** @return {Boolean} true iff stopper called on target,\n     */\n    stop() {\n        if (!this.multiple_stops && this.stopped) {\n            return false;  // indicate: stop not called\n        } else {\n            this.stopper(this.target);\n            this.#stop_count++;\n            return true;  // indicate: stop called\n        }\n    }\n}\n\nexport class StoppableObjectsManager {\n    constructor() {\n        this.#stoppable_objects = [];\n        this.#stopped = false;\n    }\n    #stoppable_objects;  // array of Stoppable objects\n    #stopped;  // true iff this.stop() has been called, false otherwise\n\n    get stopped (){ return this.#stopped; }\n\n    /** add a Stoppable to this.#stoppable_objects\n     *  @param {Stoppable} stoppable\n     */\n    add_stoppable(stoppable) {\n        if (!(stoppable instanceof Stoppable)) {\n            throw new Error('stoppable must be an instance of Stoppable');\n        }\n        this.#stoppable_objects.push(stoppable);\n    }\n\n    /** remove a Stoppable object from this.#stoppable_objects\n     *  @param {Stoppable} stoppable\n     *  @return {Boolean} found and removed?\n     */\n    remove_stoppable(stoppable) {\n        const index = this.#stoppable_objects.indexOf(stoppable);\n    }\n\n    /** stop and remove all stoppables from this.#stoppable_objects\n     */\n    stop() {\n        this.#stopped = true;\n        while (this.#stoppable_objects.length > 0) {\n            const stoppable = this.#stoppable_objects.pop();\n            stoppable.stop();\n        }\n    }\n}\n","import rxjs from '../../lib/sys/rxjs.js';\n\n\nexport class Subscribable extends rxjs.Subject {\n    dispatch(event_data) {\n        this.next(event_data);\n    }\n}\n","export function deep_freeze(object) {\n    for (const [ key, value ] of Object.entries(object)) {\n        if (typeof value === 'object' || Array.isArray(value)) {\n            deep_freeze(object[key]);\n        }\n    }\n    return Object.freeze(object);\n}\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import v4 from '../../node_modules/uuid/dist/esm-browser/v4.js';\n\nexport const uuidv4 = v4;\n\nexport function generate_object_id() {\n    // html element ids cannot start with a number\n    // (if it does, document.querySelector throws error: '... is not a valid selector')\n    return `id-${uuidv4()}`;\n}\n\nexport function generate_uuid() {\n    return uuidv4();\n}\n","// from https://stackoverflow.com/questions/879152/how-do-i-make-javascript-beep\n\nexport const beep_data_uri = 'data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=';\n\nexport async function beep() {\n    const snd = new Audio(beep_data_uri);\n    return snd.play();\n}\n","import {\n    safe_setAttributeNS,\n    set_selection_focus,\n} from './dom-util.js';\n\nimport {\n    Subscribable,\n} from '../sys/subscribable.js';\n\n\nexport class ChangeManager {\n    /** @param {Node} target,\n     *  @param {Object|null|undefined} options: {\n     *      neutral_changes_observer?: Function,\n     *  }\n     */\n    constructor(target, options=null) {\n        if (!(target instanceof Node)) {\n            throw new Error('target must be an instance of Node');\n        }\n        options ??= {};\n        if (typeof options !== 'object') {\n            throw new Error('options must be null, undefined, or an object');\n        }\n\n        const {\n            neutral_changes_observer,\n        } = options;\n        if (typeof neutral_changes_observer !== 'function') {\n            throw new Error('neutral_changes_observer must be a function');\n        }\n\n        this.#target  = target;\n        this.#stack   = [];\n        this.#current = -1;\n        this.#neutral = undefined;\n        this.#inhibit = false;\n        this.#mutation_observer = new MutationObserver(this.#mutation_handler.bind(this));\n\n        Object.defineProperties(this, {\n            neutral_changes: {  // fires when neutral status changes; emits { is_neutral, change_manager }\n                value: new Subscribable(),\n                enumerable: true,\n            },\n        });\n\n        if (neutral_changes_observer) {\n            this.#neutral_changes_subscription = this.neutral_changes.subscribe(neutral_changes_observer);  //!!! never unsubscribed....\n        }\n\n        this.#mutation_observer.observe(this.#target, {\n            childList:             true,\n            subtree:               true,\n            attributeFilter:       undefined,  // undefined: track all attributes\n            attributeOldValue:     true,       // implies attributes: true\n            characterDataOldValue: true,       // implies characterData: true\n        });\n    }\n\n    get is_connected (){ !!this.#mutation_observer; }\n\n    disconnect() {\n        if (this.#mutation_observer) {\n            this.#mutation_observer.disconnect();\n            this.#mutation_observer = undefined;\n            this.#inhibit = false;\n            this.#neutral = undefined;\n            this.#current = -1;\n            this.#stack   = [];\n        }\n    }\n\n    get is_neutral (){ return (this.#neutral === this.#current); }\n\n    set_neutral() {\n        this.#neutral = this.#current;\n        this.#dispatch_neutral_change_if_needed();\n    }\n\n    reset_neutral() {\n        this.#neutral = undefined;\n        this.#dispatch_neutral_change_if_needed();\n    }\n\n    reset(set_neutral_too=false) {\n        this.#stack.splice(0);  // clear stack\n        this.#current = -1;\n        this.#neutral = undefined;\n        this.#inhibit = false;\n\n        if (set_neutral_too) {\n            this.set_neutral();  // will call this.#dispatch_neutral_change_if_needed();\n        } else {\n            this.#dispatch_neutral_change_if_needed();\n        }\n    }\n\n    get can_perform_undo (){ return (this.#current >= 0); }\n\n    perform_undo() {\n//console.log('UNDO', this);//!!!\n        if (!this.can_perform_undo) {\n            return false;\n        } else {\n            try {\n                this.#inhibit = true;  // inhibit adding the following changes to the stack\n                const change = this.#stack[this.#current--];\n                set_selection_focus(change.focus_node, change.focus_offset);\n                for (let i = change.mutations.length; --i >= 0; ) {\n                    this.#perform_mutation_reverse(change.mutations[i]);\n                }\n                this.#dispatch_neutral_change_if_needed();\n                return true;  // indicate: success\n            } finally {\n                // reset on next tick\n                queueMicrotask(() => { this.#inhibit = false });\n            }\n        }\n    }\n\n    get can_perform_redo (){ return (this.#current < this.#stack.length-1); }\n\n    perform_redo() {\n//console.log('REDO', this);//!!!\n        if (!this.can_perform_redo) {\n            return false;\n        } else {\n            try {\n                this.#inhibit = true;  // inhibit adding the following changes to the stack\n                const change = this.#stack[++this.#current];\n                for (let i = 0; i < change.mutations.length; i++) {\n                    this.#perform_mutation_forward(change.mutations[i]);\n                }\n                this.#dispatch_neutral_change_if_needed();\n                return true;  // indicate: success\n            } finally {\n                // reset on next tick\n                queueMicrotask(() => { this.#inhibit = false; });\n            }\n        }\n    }\n\n\n    // === INTERNAL ===\n\n    static MutationData = class MutationData {\n        constructor(mutation, extra_props=null) {\n            if (extra_props) {\n                Object.assign(this, extra_props);\n            }\n            Object.defineProperties(this, {\n                mutation: {\n                    value:      mutation,\n                    enumerable: true,\n                },\n            });\n        }\n    }\n\n    #target;   // the specified target\n    #stack;    // array of { timestamp: Number, mutations: Array<MutationData> }\n    #current;  // current position in stack (-1 if no entries)\n    #neutral;  // numeric stack index of \"neutral\" position, undefined if none\n    #inhibit;  // inhibit mutation collection (while performing undo/redo)\n    #mutation_observer;\n    #neutral_changes_subscription;\n\n    #perform_mutation_reverse(mutation_data) {\n        if (!(mutation_data instanceof this.constructor.MutationData)) {\n            throw new Error('mutation_data must be an instance of ChangeManager.MutationData');\n        }\n\n        const { mutation } = mutation_data;\n        switch (mutation.type) {\n        default: {\n            throw new Error(`unknown MutationRecord type: ${mutation.type}`);\n        }\n\n        case 'attributes': {\n            if ('attributeNamespace' in mutation) {\n                safe_setAttributeNS(mutation.target, mutation.attributeNamespace, mutation.attributeName, mutation.oldValue);\n            } else{\n                mutation.target.setAttribute(mutation.attributeName, mutation.oldValue);\n            }\n            break;\n        }\n\n        case 'characterData': {\n            mutation.target.data = mutation.oldValue;\n            break;\n        }\n\n        case 'childList': {\n            for (let i = mutation.addedNodes.length; --i >= 0; ) {\n                mutation.target.removeChild(mutation.addedNodes[i]);\n            }\n            for (let i = mutation.removedNodes.length; --i >= 0; ) {\n                mutation.target.insertBefore(mutation.removedNodes[i], mutation.nextSibling);\n            }\n            break;\n        }\n        }\n    }\n\n    #perform_mutation_forward(mutation_data) {\n        if (!(mutation_data instanceof this.constructor.MutationData)) {\n            throw new Error('mutation_data must be an instance of ChangeManager.MutationData');\n        }\n\n        const { mutation } = mutation_data;\n        switch (mutation.type) {\n        default: {\n            throw new Error(`unknown MutationRecord type: ${mutation.type}`);\n        }\n\n        case 'attributes': {\n            // note that mutation_data.newValue is set by us in #mutation_handler()\n            if ('attributeNamespace' in mutation) {\n                safe_setAttributeNS(mutation.target, mutation.attributeNamespace, mutation.attributeName, mutation_data.newValue);\n            } else{\n                mutation.target.setAttribute(mutation.attributeName, mutation_data.newValue);\n            }\n            break;\n        }\n\n        case 'characterData': {\n            // note that mutation_data.newValue is set by us in #mutation_handler()\n            mutation.target.data = mutation_data.newValue;\n            break;\n        }\n\n        case 'childList': {\n            for (let i = 0; i < mutation.removedNodes.length; i++) {\n                mutation.target.removeChild(mutation.removedNodes[i]);\n            }\n            for (let i = 0; i < mutation.addedNodes.length; i++) {\n                mutation.target.insertBefore(mutation.addedNodes[i], mutation.nextSibling);\n            }\n            break;\n        }\n        }\n    }\n\n    #mutation_handler(mutation_list, observer) {\n//console.log('mutation_handler', mutation_list);//!!!\n        if (!this.#inhibit) {\n            // map mutation_list to form an array of MutationData objects\n            // \"attributes\" and \"characterData\" records store newValue in the MutationData\n            const mutations = mutation_list.map(mutation => {\n                const extra_props = {\n                    newValue: undefined,  // set for 'attributes' and 'characterData' mutations\n                };\n                switch (mutation.type) {\n                case 'attributes': {\n                    // Add a newValue field to extra_props.\n                    // This is for when we want to \"redo\" this mutation.\n                    const newValue = ('attributeNamespace' in mutation)\n                          ? mutation.target.getAttributeNS(mutation.attributeNamespace, mutation.attributeName)\n                          : mutation.target.getAttribute(mutation.attributeName);\n                    extra_props.newValue = newValue;\n                    break;\n                }\n                case 'characterData': {\n                    // Add a newValue field to extra_props.\n                    // This is for when we want to \"redo\" this mutation.\n                    const newValue = mutation.target.data;\n                    extra_props.newValue = newValue;\n                    break;\n                }\n                }\n                return new this.constructor.MutationData(mutation, extra_props);\n            });\n            const selection = window.getSelection();\n            const new_change = {\n                timestamp:    Date.now(),\n                focus_node:   selection.focusNode,\n                focus_offset: selection.focusOffset,\n                mutations,\n            };\n            // remove everything from stack after current\n            this.#stack.splice(this.#current+1, this.#stack.length-(this.#current+1));\n            this.#current = this.#stack.length-1;  // last change on stack\n            if (typeof this.#neutral === 'number' && this.#neutral > this.#current) {\n                // neutral position was within the removed range\n                this.#neutral = undefined;  // no neutral position\n            }\n\n            // add the new change:\n            // add new change to stack (will be at position current+1)\n            this.#stack.push(new_change);\n            // update current\n            this.#current = this.#stack.length-1;  // last change on stack\n        }\n        this.#dispatch_neutral_change_if_needed();\n    }\n\n    #dispatch_neutral_change() {\n        this.neutral_changes.dispatch({\n            is_neutral: this.is_neutral,\n            change_manager: this,\n        })\n    }\n    #last_is_neutral;\n    #dispatch_neutral_change_if_needed() {\n        const is_neutral = this.is_neutral;\n        if (typeof this.#last_is_neutral === undefined || this.#last_is_neutral !== is_neutral) {\n            this.#dispatch_neutral_change();\n        }\n        this.#last_is_neutral = is_neutral;\n    }\n}\n","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!./dialog.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!./dialog.css\";\n       export default content && content.locals ? content.locals : undefined;\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    create_element,\n} from '../dom-util.js';\n\nimport {\n    uuidv4,\n} from '../../sys/uuid.js';\n\nimport {\n    OpenPromise,\n} from '../../sys/open-promise.js';\n\nimport {\n    assets_server_url,\n} from '../../../src/assets-server-url.js';\n\n// import {\n//     create_stylesheet_link,\n// } from '../dom-util.js';\n// create_stylesheet_link(document.head, new URL('./dialog.css', assets_server_url(current_script_url)));\nimport './dialog.css';  // webpack implementation\n\n\n// === DIALOG BASE CLASS ===\n\nconst _dialog_element_to_instance_map = new WeakMap();\n\nexport class Dialog {\n    /** run a new instance of this dialog class\n     *  @param {string} message to be passed to instance run() method\n     *  @param {Object|undefined|null} options to be passed to instance run() method\n     *  @return {Promise}\n     */\n    static run(message, options) { return new this().run(message, options); }\n\n    static is_modal_active() {\n        return [ ...document.querySelectorAll(`dialog.${this._modal_dialog_css_class}`) ].some(d => d.open);\n    }\n\n    /** Return the dialog instance associated with an element, if any.\n     *  @param {Element} element an HTML element in the DOM\n     *  @return {Element|null} null if element is not a dialog or a child\n     *          of a dialog, otherwise the associated Dialog instance.\n     */\n    static instance_from_element(element) {\n        return _dialog_element_to_instance_map.get(element.closest('dialog'));\n    }\n\n    static _modal_dialog_css_class = 'modal_dialog';\n\n    constructor() {\n        this._completed = false;\n        this._promise = new OpenPromise();\n        this._promise.promise.finally(() => {\n            try {\n                this._destroy_dialog_element();\n            } catch (error) {\n                console.warn('ignoring error when finalizing dialog promise', error);\n            }\n        });\n        try {\n            this._dialog_element_id = `dialog-${uuidv4()}`;\n            this._create_dialog_element();\n            _dialog_element_to_instance_map.set(this._dialog_element, this);\n        } catch (error) {\n            this._cancel(error);\n        }\n    }\n\n    get promise (){ return this._promise.promise; }\n\n    run(...args) {\n        this._populate_dialog_element(...args);\n        this._dialog_element.showModal();\n        return this.promise;\n    }\n\n\n    // === INTERNAL METHODS ===\n\n    // To be overridden to provide the content of the dialog.\n    // this.dialog_element will have already been set and will be part of the DOM.\n    _populate_dialog_element(...args) {\n        throw new Error('unimplemented');\n    }\n\n    // to be called when dialog is complete\n    _complete(result) {\n        this._completed = true;\n        this._promise.resolve(result);\n    }\n\n    // to be called when dialog is canceled\n    _cancel(error) {\n        this._promise.reject(error ?? new Error('canceled'));\n    }\n\n    // expects this._dialog_element_id is already set, sets this._dialog_element\n    _create_dialog_element() {\n        if (typeof this._dialog_element_id !== 'string') {\n            throw new Error('this._dialog_element_id must already be set to a string before calling this method');\n        }\n        if (typeof this._dialog_element !== 'undefined') {\n            throw new Error('this._dialog_element must be undefined when calling this method');\n        }\n        const content_element = document.getElementById('content') ??\n              create_element({ parent: document.body, attrs: { id: 'content' } });\n        if (content_element.tagName !== 'DIV' || content_element.parentElement !== document.body) {\n            throw new Error('pre-existing #content element is not a <div> that is a direct child of document.body');\n        }\n        const ui_element = document.getElementById('ui') ??\n              create_element({\n                  before: content_element.firstChild,  // prepend\n                  attrs:  { id: 'ui' },\n              });\n        if (ui_element.tagName !== 'DIV' || ui_element.parentElement !== content_element) {\n            throw new Error('pre-existing #ui element is not a <div> that is a direct child of the #content element');\n        }\n        if (document.getElementById(this._dialog_element_id)) {\n            throw new Error(`unexpected: dialog with id ${this._dialog_element_id} already exists`);\n        }\n        const dialog_element = create_element({\n            parent: ui_element,\n            tag:    'dialog',\n            attrs: {\n                id: this._dialog_element_id,\n                class: this.constructor._modal_dialog_css_class,\n            },\n        });\n        this._dialog_text_container = create_element({\n            parent: dialog_element,\n            attrs: {\n                class: 'dialog_text',\n            },\n        });\n        this._dialog_form = create_element({\n            parent: dialog_element,\n            tag:    'form',\n            attrs: {\n                method: 'dialog',\n            },\n        });\n        this._dialog_element = dialog_element;\n    }\n\n    _destroy_dialog_element() {\n        if (this._dialog_element) {\n            _dialog_element_to_instance_map.delete(this._dialog_element);\n            this._dialog_element.remove();\n        }\n        this._dialog_element.oncancel = null;\n        this._dialog_element.onclose = null;\n        this._dialog_element = undefined;\n    }\n}\n\nexport class AlertDialog extends Dialog {\n    _populate_dialog_element(message, options) {\n        const {\n            accept_button_label = 'Ok',\n        } = (options ?? {});\n        this._dialog_text_container.innerText = message;\n        const accept_button = create_element({\n            parent: this._dialog_form,\n            tag:    'input',\n            attrs: {\n                type: 'submit',\n                value: accept_button_label,\n            },\n        });\n        this._dialog_element.onclose = (event) => this._complete();\n    }\n}\n\nexport class ConfirmDialog extends Dialog {\n    _populate_dialog_element(message, options) {\n        const {\n            decline_button_label = 'No',\n            accept_button_label  = 'Yes',\n        } = (options ?? {});\n        this._dialog_text_container.innerText = message;\n        const decline_button = create_element({\n            parent: this._dialog_form,\n            tag:    'input',\n            attrs: {\n                type: 'button',\n                value: decline_button_label,\n            },\n        });\n        decline_button.innerText = decline_button_label;\n        decline_button.onclick = (event) => this._complete(false);\n        const accept_button = create_element({\n            parent: this._dialog_form,\n            tag:    'input',\n            attrs: {\n                type: 'submit',\n                value: accept_button_label,\n            },\n        });\n        this._dialog_element.oncancel = (event) => this._complete(false);\n        this._dialog_element.onclose = (event) => this._complete(this._dialog_element.returnValue === accept_button_label);\n    }\n}\n\n\n// === UTILITY FUNCTIONS ===\n\n/** create a new HTML control as a child of the given parent with an optional label element\n *  @param {HTMLElement} parent\n *  @param {string} id for control element\n *  @param {Object|undefined|null} options: {\n *             tag?:         string,   // tag name for element; default: 'input'\n *             type?:        string,   // type name for element; default: 'text' (only used if tag === 'input')\n *             label?:       string,   // if !!label, then create a label element\n *             label_after?: boolean,  // if !!label_after, the add label after element, otherwise before\n *             attrs?:       object,   // attributes to set on the new control element\n *         }\n *  @return {Element} the new control element\n */\nexport function create_control_element(parent, id, options) {\n    if (typeof id !== 'string' || id === '') {\n        throw new Error('id must be a non-empty string');\n    }\n    const {\n        tag  = 'input',\n        type = 'text',\n        label,\n        label_after,\n        attrs = {},\n    } = (options ?? {});\n\n    if ('id' in attrs || 'type' in attrs) {\n        throw new Error('attrs must not contain \"id\" or \"type\"');\n    }\n    const control_opts = {\n        id,\n        ...attrs,\n    };\n    if (tag === 'input') {\n        control_opts.type = type;\n    }\n    const control = create_element({\n        tag,\n        attrs: control_opts,\n    });\n    let control_label;\n    if (label) {\n        control_label = create_element({\n            tag: 'label',\n            attrs: {\n                for: id,\n            },\n        });\n        control_label.innerText = label;\n    }\n\n    if (label_after) {\n        parent.appendChild(control);\n        parent.appendChild(control_label);\n    } else {\n        parent.appendChild(control_label);\n        parent.appendChild(control);\n    }\n\n    return control;\n}\n\n/** create a new HTML <select> and associated <option> elements\n *  as a child of the given parent with an optional label element\n *  @param {HTMLElement} parent\n *  @param {string} id for control element\n *  @param {Object|undefined|null} opts: {\n *             tag?:         string,    // tag name for element; default: 'input'\n *             label?:       string,    // if !!label, then create a label element\n *             label_after?: boolean,   // if !!label_after, the add label after element, otherwise before\n *             attrs?:       object,    // attributes to set on the new <select> element\n *             options?:     object[],  // array of objects, each of which contain \"value\" and \"label\" keys (value defaults to label)\n *                                      // values are the option attributes.  If no \"value\"\n *                                      // attribute is specified then the key is used.\n *         }\n * Note: we are assuming that opts.options is specified with an key-order-preserving object.\n *  @return {Element} the new <select> element\n */\nexport function create_select_element(parent, id, opts) {\n    opts = opts ?? {};\n    if ('tag' in opts || 'type' in opts) {\n        throw new Error('opts must not contain \"tag\" or \"type\"');\n    }\n    const option_elements = [];\n    if (opts.options) {\n        for (const { value, label } of opts.options) {\n            const option_attrs = { value: (value ?? label) };\n            const option_element = create_element({\n                tag: 'option',\n                attrs: option_attrs,\n            });\n            option_element.innerText = label;\n            option_elements.push(option_element);\n        }\n    }\n    const select_opts = {\n        ...opts,\n        tag: 'select',\n    };\n    const select_element = create_control_element(parent, id, select_opts);\n    for (const option_element of option_elements) {\n        select_element.appendChild(option_element);\n    }\n    return select_element;\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    generate_object_id,\n} from '../sys/uuid.js';\n\nimport {\n    beep,\n} from './beep.js';\n\nimport {\n    assets_server_url,\n} from '../../src/assets-server-url.js';\n\n\n// === ESCAPE TEXT AND HTML ===\n\nexport function escape_unescaped_$(s) {\n    // Note: add $ to the end and then remove the last two characters ('\\\\$') from\n    // the result.  Why?  Because the RE does not work correctly when the remaining\n    // part after a match does not contain a non-escaped $.  This workaround works\n    // correctly even if s ends with \\.\n    const re = /((\\\\?.)*?)\\$/g;\n    return (s + '$').replace(re, (...args) => `${args[1]}\\\\$`).slice(0, -2);\n}\n\n/** escape_for_html(s)\n *  convert all '<' and '>' to their corresponding HTML entities\n *  @param {string} string to be converted\n *  @return {string} converted string\n */\nexport function escape_for_html(s) {\n    return s.replaceAll('<', '&lt;').replaceAll('>', '&gt;');\n}\n\n/** make_string_literal(s)\n *  @param {string} s\n *  @return {string} string representation of a string literal for s\n */\nexport function make_string_literal(s) {\n    return `'${[ ...s ].map(s => s === \"'\" ? \"\\\\'\" : s).join('')}'`;\n}\n\n\n// === INITIALIZATION FAILED DISPLAY ===\n\nexport function show_initialization_failed(error) {\n    console.error('initialization failed', error.stack);\n    document.body.innerText = '';  // completely reset body\n    document.body.classList.add('error');\n    const error_h1 = document.createElement('h1');\n    error_h1.textContent = 'Initialization Failed';\n    const error_pre = document.createElement('pre');\n    error_pre.textContent = error.stack;\n    document.body.appendChild(error_h1);\n    document.body.appendChild(error_pre);\n}\n\n\n// === TIMEOUT / NEXT TICK UTILITIES ===\n\nexport async function delay_ms(ms, resolve_result=undefined) {\n    return new Promise(resolve => setTimeout(resolve, (ms ?? 0), resolve_result));\n}\n\nexport async function next_tick() {\n    return new Promise(resolve => setTimeout(resolve));\n}\n\nexport async function next_micro_tick() {\n    return new Promise(resolve => queueMicrotask(resolve));\n}\n\n\n// === DOCUMENT UTILITIES ===\n\n/** temporarily set document.designMode while executing thunk\n *  @param {Boolean} on\n *  @param {Function} thunk zero-parameter function to execute with temporary setting\n *  @return {any} return value of thunk()\n * thunk may be an async function or a regular function.\n */\nexport async function with_designMode(on, thunk) {\n    return new Promise((resolve, reject) => {\n        const original_setting = document.designMode;\n        document.designMode = (on ? 'on' : 'off');\n        delay_ms(0)\n            .then(() => thunk())\n            .then(thunk_result => delay_ms(0, thunk_result))\n            .then(resolve)\n            .finally(() => {\n                document.designMode = original_setting;\n            });\n    });\n}\n\n\n// === ELEMENT UTILITIES ===\n\n/** find the nearest ancestor of node that matches selector\n *  @param {Node} node for which to find nearest ancestor\n *  @param {String} selector to match\n *  @param {Boolean} strict_ancestor if true, then don't return node even if it matches\n *  @return {Element} the ancestor or null if none found\n */\nexport function find_matching_ancestor(node, selector, strict_ancestor=false) {\n    for (let scan = (strict_ancestor ? node.parentNode : node); scan; scan = scan.parentNode) {\n        if (scan instanceof Element) {\n            if (scan.matches(selector)) {\n                return scan;\n            }\n        }\n    }\n    return null;  // indicate: not found\n}\n\n/** remove all child elements and nodes of element\n *  @param {Node} element\n *  @return {Node} element\n */\nexport function clear_element(element) {\n    if (element instanceof HTMLElement) {\n        element.innerText = '';  // removes all child elements and nodes, and their event handlers\n    } else if (element instanceof Node) {\n        while (element.firstChild) {\n            // note that removeChild() does not remove the\n            // event handlers from the removed node, but\n            // we are letting the node go so it will be\n            // garbage-collected soon....\n            element.removeChild(element.firstChild);\n        }\n    } else {\n        throw new Error('element must be an instance of Node');\n    }\n    return element;\n}\n\n/** scroll element into view\n *  @param {Element} element\n *  @return {Element} element\n */\nexport function scroll_element_into_view(element) {\n    const element_rect = element.getBoundingClientRect();\n    if (element_rect.bottom > window.innerHeight) {\n        window.scrollBy(0, (element_rect.bottom - window.innerHeight));\n    }\n    return element;\n}\n\n/** set attributes on an element which are taken from an object.\n *  @param {Element} element\n *  @param {Object|undefined|null} attrs\n *  @return {Element} element\n * Attributes specified in attrs with a value of either null or undefined are cause\n * the corresponding property to be removed.\n * Attribute values obtained by calling toString() on the values in attrs\n * except that values which are undefined are translated to ''.\n */\nexport function set_element_attrs(element, attrs) {\n    if (attrs) {\n        if ('id' in attrs && document.getElementById(_attr_value(attrs.id))) {\n            throw new Error(`element already exists with id ${attrs.id}`);\n        }\n        for (const k in attrs) {\n            const v = attrs[k];\n            if (v !== null && typeof v !== 'undefined') {\n                element.setAttribute(k, _attr_value(v));\n            } else {\n                element.removeAttribute(k);\n            }\n        }\n    }\n    return element;\n}\n\n/** add/remove style properties on element\n *  @param {HTMLElement} element\n *  @param {Object} spec collection of properties to add or remove.\n *                  If the value of an entry is null or undefined, then\n *                  the corresponding property is removed.  If the value\n *                  of an entry is null, then the property is removed.\n *                  If the value of an entry is undefined, then that\n *                  entry is ignored.  Otherwise, the value of the\n *                  corresponding property is set.\n *  @return {HTMLElement} element\n */\nexport function update_element_style(element, spec) {\n    for (const name in spec) {\n        const value = spec[name];\n        if (typeof value !== 'undefined') {\n            if (value === null) {\n                element.style.removeProperty(name);\n            } else {\n                element.style.setProperty(name, value);\n            }\n        }\n    }\n    return element;\n}\n\nfunction _attr_value(v) {\n    return (typeof v === 'undefined') ? '' : v.toString();\n}\n\n\n/** safely set namespaced attributes\n *  @param {Element} element on which to set attribute\n *  @param {String|null} namespace\n *  @param {String} name of attribute\n *  @param {any} value\n * According to MDN, https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttributeNS :\n *     setAttributeNS is the only method for namespaced attributes which\n *     expects the fully qualified name, i.e. \"namespace:localname\".\n */\nexport function safe_setAttributeNS(element, namespace, name, value) {\n    //!!! is this a correct implementation???\n    if (namespace && !name.includes(':')) {\n        // use the last non-empty component of the namespace\n        //!!! is this correct?\n        const namespace_components = new URL(namespace).pathname.split('/');\n        const namespace_specfier = namespace_components.findLast(s => s.length > 0);\n        name = `${namespace_specfier}:${name}`;\n    }\n    element.setAttributeNS(namespace, name, value);\n}\n\n\n/** validate the \"parent\" and \"before\" properties from options and return their validated values.\n *  @param {null|undefined|Object} options\n *  @param {Class} required_parent_class (default Element)\n *  @return {Object} result: { parent: Node|null, before: Node|null }\n */\nexport function validate_parent_and_before_from_options(options, required_parent_class=null) {\n    const {\n        parent: parent_from_options = null,\n        before = null,\n    } = (options ?? {});\n\n    let parent = parent_from_options;\n    if (before && !(before instanceof Node)) {\n        throw new Error('before must be null, undefined, or an instance of Node');\n    }\n\n    if (before && !before.parentNode) {\n        throw new Error('before must have a parent');\n    }\n\n    // resolve parent and before\n    if (parent) {\n        if (before && before.parentElement !== parent) {\n            throw new Error('inconsistent parent and before nodes specified');\n        }\n    } else {\n        if (before) {\n            parent = before.parentNode;\n        }\n    }\n\n    required_parent_class ??= Element;\n    if (parent && !(parent instanceof required_parent_class)) {\n        throw new Error(`parent must be null, undefined, or an instance of ${required_parent_class.name}`);\n    }\n\n    return { parent, before };\n}\n\n/** create_element(options)\n *  create a new element with the given characteristics\n *  @param {Object|undefined|null} options: {\n *      parent?:    HTMLElement|null,  // parent element, null or undefined for none; may be simply an Element if style not specified\n *      before?:    Node|null,         // sibling node before which to insert; append if null or undefined\n *      tag?:       string,            // tag name for new element; default: 'div'\n *      namespace?: string,            // namespace for new element creation\n *      attrs?:     object,            // attributes to set on new element\n *      style?:     object,            // style properties for new element\n *  }\n *  @return {Element} the new element\n * A unique id will be assigned to the element unless that element already has an id attribute\n * specified (in attrs).\n * Attributes specified in attrs with a value of either null or undefined are ignored.  This is\n * how to prevent generation of an id: specify a value of null or undefined for id.\n * The before node, if specified, must have a parent that must match parent if parent is specified.\n * If neither parent nor before is specified, the new element will have no parent.\n * Warning: '!important' in style specifications does not work!  (Should use priority method.)\n */\nexport function create_element(options) {\n    const {\n        tag = 'div',\n        namespace,\n        attrs,\n        style,\n    } = (options ?? {});\n\n    const required_parent_class = style ? HTMLElement : Element;\n\n    const {\n        parent,\n        before,\n    } = validate_parent_and_before_from_options(options, required_parent_class);\n\n    const element = namespace\n          ? document.createElementNS(namespace, tag)\n          : document.createElement(tag);\n\n    let element_id_specified = false;\n    if (attrs) {\n        for (const k in attrs) {\n            const v = attrs[k];\n            if (v !== null && typeof v !== 'undefined') {\n                element.setAttribute(k, v);\n            }\n            if (k == 'id') {\n                element_id_specified = true;\n            }\n        }\n    }\n    if (!element_id_specified) {\n        element.id = generate_object_id();\n    }\n\n    if (style) {\n        update_element_style(element, style);\n    }\n\n    if (parent) {\n        parent.insertBefore(element, before);\n    }\n\n    return element;\n}\n\n/** create or update a child text node of the given element\n *  @param {HTMLElement} element  //!!! may be sufficient to be a Node\n *  @param {any} text to be contained in the new text node\n *  @param {Object|undefined|null} options: {\n *             before?: null|Node,  // child node or element before which to insert; append if null or undefined\n *             prevent_coalesce_next?: boolean,\n *         }\n *  @return {Node|null} the new or modified text node, or null if the converted text is ''\n *\n * Text will be converted to a string (if not already a string).  A text value\n * of null or undefined is equivalent to ''.\n *\n * The text will be coalesced into the immediately previous text node, if any.\n * Otherwise, if the next node is a text node the text will be coealesced\n * into the beginning text of it unless options.prevent_coalesce_next.\n * options.prevent_coalesce_next makes sure that the same options.before\n * node can be used repeatedly with the expected results.  However,\n * options.prevent_coalesce_next may leave element non-normalized.\n * On the other hand, if !options.prevent_coalesce_next, the element\n * will not become non-normalized (but may be non-normalized if it\n * already was).\n * Note that the text is inserted into the document purely as text, and\n * no escaping or cleaning for HTML is performed (it should not be necessary).\n */\nexport function create_element_child_text_node(element, text, options=null) {\n    if (!(element instanceof HTMLElement)) {\n        throw new Error('element must be an instance of HTMLElement');\n    }\n\n    const {\n        before = null,\n        prevent_coalesce_next,\n    } = (options ?? {});\n\n    if (before !== null && !(before instanceof Node)) {\n        throw new Error('before must be null or an instance of Node');\n    }\n    if (before && before.parentNode !== element) {\n        throw new Error('before must be a child of element');\n    }\n\n    if (typeof text !== 'string') {\n        text = `${text ?? ''}`;\n    }\n    if (!text) {\n        return null;\n    }\n\n    let node;  // this will be the node that contains the text\n    if (!node) {\n        const previous = before ? before.previousSibling : element.lastChild;\n        if (previous?.nodeType === Node.TEXT_NODE) {\n            previous.nodeValue += text;\n            node = previous;\n        }\n    }\n    if (!node && before && !prevent_coalesce_next) {  // if no before then there will be no next node\n        const next = before;\n        if (next.nodeType === Node.TEXT_NODE) {\n            next.nodeValue = text + next.nodeValue;\n            node = next;\n        }\n    }\n    if (!node) {\n        node = document.createTextNode(text);\n        element.insertBefore(node, before);\n    }\n\n    return node;\n}\n\n/** normalize the text node children of element, meaning that text nodes\n *  are non-empty and no text nodes are adjacent.\n *  @param {Element} element\n *  @return {Element} element\n */\nexport function normalize_element_text(element) {\n    element.normalize();\n    return element;\n}\n\n/** create_stylesheet_link(parent, stylesheet_url, attrs)\n *  @param {Element} parent\n *  @param {string} stylesheet_url\n *  @param {Object|undefined|null} attrs\n *  @param {boolean} permit_duplication if true then do not recreate element if already present\n *  @return {HTMLElement} the new <link> element\n */\nexport function create_stylesheet_link(parent, stylesheet_url, attrs=null, permit_duplication=false) {\n    if (!(parent instanceof Element)) {\n        throw new Error('parent must be an Element');\n    }\n    attrs = attrs ?? {};\n    if ('rel' in attrs || 'href' in attrs) {\n        throw new Error('attrs must not contain \"rel\" or \"href\"');\n    }\n    let link_element;\n    if (!permit_duplication) {\n        // note that the duplication does not take into account attrs\n        link_element = parent.querySelector(`link[rel=\"stylesheet\"][href=\"${stylesheet_url.toString().replaceAll('\"', '\\\\\"')}\"]`);\n        // make sure link_element that was found is a direct child of parent\n        if (link_element?.parentElement !== parent) {\n            link_element = null;\n        }\n    }\n    return link_element ?? create_element({\n        parent,\n        tag: 'link',\n        attrs: {\n            rel: \"stylesheet\",\n            href: stylesheet_url,\n            ...attrs,\n        },\n    });\n}\n\n/** create_inline_stylesheet(parent, stylesheet_text, attrs)\n *  @param {Element} parent\n *  @param {string} stylesheet_text\n *  @param {Object|undefined|null} attrs\n *  @return {HTMLStyleElement} the new <style> element\n */\nexport function create_inline_stylesheet(parent, stylesheet_text, attrs) {\n    if (!(parent instanceof Element)) {\n        throw new Error('parent must be an Element');\n    }\n    const style_el = create_element({\n        tag: 'style',\n        attrs,\n    });\n    style_el.appendChild(document.createTextNode(stylesheet_text));\n    parent.appendChild(style_el);\n    return style_el;\n}\n\n/** create_script(parent, script_url, attrs=null, permit_duplication=false)\n *  @param {Element} parent\n *  @param {string} script_url\n *  @param {Object|undefined|null} attrs\n *  @param {boolean} permit_duplication if true then do not recreate element if already present\n *  @return {HTMLStyleElement} the new <style> element\n */\nexport function create_script(parent, script_url, attrs=null, permit_duplication=false) {\n    if (!(parent instanceof Element)) {\n        throw new Error('parent must be an Element');\n    }\n    attrs = attrs ?? {};\n    if ('src' in attrs) {\n        throw new Error('attrs must not contain \"src\"');\n    }\n    let script_element;\n    if (!permit_duplication) {\n        // note that the duplication does not take into account attrs\n        script_element = parent.querySelector(`script[src=\"${script_url.toString().replaceAll('\"', '\\\\\"')}\"]`);\n        // make sure script_element that was found is a direct child of parent\n        if (script_element?.parentElement !== parent) {\n            script_element = null;\n        }\n    }\n    return script_element ?? create_element({\n        parent,\n        tag: 'script',\n        attrs: {\n            src: script_url,\n            ...attrs,\n        },\n    });\n}\n\n/** create_inline_script(parent, script_text, attrs)\n *  @param {Element} parent\n *  @param {string} script_text\n *  @param {Object|undefined|null} attrs\n *  @return {HTMLScriptElement} the new <script> element\n */\nexport function create_inline_script(parent, script_text, attrs) {\n    if (!(parent instanceof Element)) {\n        throw new Error('parent must be an Element');\n    }\n    if (attrs && 'src' in attrs) {\n        throw new Error('attrs must not contain \"src\"');\n    }\n    const script_el = create_element({\n        tag: 'script',\n        attrs,\n    });\n    script_el.appendChild(document.createTextNode(script_text));\n    parent.appendChild(script_el);\n    return script_el;\n}\n\n\n// === SCRIPT LOADING ===\n\nconst _script_promise_data = {};  // map: url -> { promise?: Promise, resolve?: any=>void, reject?: any=>void }\n\n// _establish_script_promise_data(script_url) returns\n// { promise_data, initial } where promise_data is\n// _script_promise_data[script_url] and initial is true\n// iff the promise was newly created.\nfunction _establish_script_promise_data(full_script_url) {\n    const data_key = full_script_url.toString();\n    let promise_data = _script_promise_data[data_key];\n    let initial;\n    if (promise_data) {\n        initial = false;\n    } else {\n        promise_data = {};\n        promise_data.promise = new Promise((resolve, reject) => {\n            promise_data.resolve = resolve;\n            promise_data.reject  = reject;\n        });\n        _script_promise_data[data_key] = promise_data;\n        initial = true;\n    }\n    return { initial, promise_data };\n}\n\n/** async function load_script(parent, script_url, attrs=null, permit_duplication=false)\n *  @param {Node} parent the parent element for script\n *  @param {string} script_url url of script to load (the script tag will be created without defer or async attributes)\n *  @param {Object|undefined|null} attrs\n *  @param {boolean} permit_duplication if true then do not recreate element if already present\n *  @return {Promise}\n *  Use this to load a script and wait for its 'load' event.\n *  Only the first invokation for a particular script_url will create\n *  the script element.  Others will simply wait for the script to load\n *  or for error.\n */\nexport async function load_script(parent, script_url, attrs=null, permit_duplication=false) {\n    const full_script_url = new URL(script_url, assets_server_url(current_script_url));\n    const { promise_data, initial } = _establish_script_promise_data(full_script_url);\n    if (initial) {\n        let script_el;\n        function script_load_handler(event) {\n            promise_data.resolve?.();\n            reset();\n        }\n        function script_load_error_handler(event) {\n            promise_data.reject?.(new Error(`error loading script ${full_script_url}`));\n            reset();\n        }\n        function reset() {\n            if (script_el) {\n                script_el.removeEventListener('load',  script_load_handler);\n                script_el.removeEventListener('error', script_load_error_handler);\n            }\n            promise_data.resolve = null;\n            promise_data.reject  = null;\n        }\n        try {\n            script_el = create_script(parent, full_script_url, attrs, permit_duplication);\n            script_el.addEventListener('load',  script_load_handler,       { once: true });\n            script_el.addEventListener('error', script_load_error_handler, { once: true });\n        } catch (err) {\n            promise_data.reject?.(err);\n            reset();\n        }\n    }\n    return promise_data.promise;\n}\n\n/** async function load_script_and_wait_for_condition(parent, script_url, condition_poll_fn, attrs=null, permit_duplication=false)\n *  @param {Node} parent the parent element for script\n *  @param {string} script_url url of script to load (the script tag will be created without defer or async attributes)\n *  @param {() => boolean} condition_poll_fn function that will return true when script has loaded\n *  @param {Object|undefined|null} attrs\n *  @param {boolean} permit_duplication if true then do not recreate element if already present\n *  @return {Promise}\n *  Use this to load a script where you want to poll for condition\n *  that will be triggered asynchronously by the script, in which\n *  case waiting for the load event will not work because it fires\n *  when script execution completes but not when some later condition\n *  is triggered asynchronously by the script.\n *  Only the first invokation for a particular script_url will create\n *  the script element.  Others will simply wait for the script to load\n *  or for error.\n */\nexport async function load_script_and_wait_for_condition(parent, script_url, condition_poll_fn, attrs=null, permit_duplication=false) {\n    const full_script_url = new URL(script_url, assets_server_url(current_script_url));\n    const { promise_data, initial } = _establish_script_promise_data(full_script_url);\n    if (initial) {\n        let script_el;\n        let wait_timer_id;\n        function script_load_error_handler(event) {\n            promise_data.reject?.(new Error(`error loading script ${full_script_url}`));\n            reset();\n        }\n        function wait() {\n            if (condition_poll_fn()) {\n                promise_data.resolve?.();\n                reset();\n            } else {\n                wait_timer_id = setTimeout(wait);  // check again on next tick\n            }\n        }\n        function reset() {\n            if (typeof wait_timer_id !== 'undefined') {\n                clearTimeout(wait_timer_id);\n                wait_timer_id = undefined;\n            }\n            if (script_el) {\n                script_el.removeEventListener('error', script_load_error_handler);\n            }\n            promise_data.resolve = null;\n            promise_data.reject  = null;\n        }\n        try {\n            script_el = create_script(parent, full_script_url, attrs, permit_duplication);\n            script_el.addEventListener('error', script_load_error_handler, { once: true });\n            wait();\n        } catch (err) {\n            promise_data.reject?.(err);\n            reset();\n        }\n    }\n    return promise_data.promise;\n}\n\n\n// === NODE OFFSET IN PARENT ===\n\nexport function find_child_offset(child) {\n    const parent_child_nodes = child?.parentNode?.childNodes;\n    if (!parent_child_nodes) {\n        return undefined;\n    } else {\n        return Array.prototype.indexOf.call(parent_child_nodes, child);\n    }\n}\n\n\n// === SELECTION/POINT ===\n\nexport function set_selection_focus(node, offset) {\n    window.getSelection().setBaseAndExtent(node, offset, node, offset);\n}\n\nexport function save_current_selection() {\n    const selection = window.getSelection();\n    const {\n        anchorNode,\n        anchorOffset,\n        focusNode,\n        focusOffset,\n    } = selection;\n    const ranges = []\n    for (let i = 0; i < selection.rangeCount; i++) {\n        ranges.push(selection.getRangeAt(i).cloneRange());\n    }\n    return {\n        anchorNode,\n        anchorOffset,\n        focusNode,\n        focusOffset,\n        ranges,\n    }\n}\n\nexport function restore_selection(saved) {\n    const selection = window.getSelection();\n    selection.removeAllRanges();\n    for (const range of saved.ranges) {\n        selection.addRange(range);\n    }\n    selection.setBaseAndExtent(\n        saved.anchorNode, saved.anchorOffset,\n        saved.focusNode, saved.focusOffset\n    );\n}\n\nexport function manage_selection_for_insert(updater) {\n    const selection = window.getSelection();\n    selection?.deleteFromDocument();  // delete current selection, if any\n    let point = {\n        node:   selection?.focusNode   ?? null,\n        offset: selection?.focusOffset ?? 0,\n    };\n    point = updater(point);\n    if (!point) {\n        throw new Error('updater must return { node, offset } for the new point');\n    }\n    selection.setBaseAndExtent(point.node, point.offset, point.node, point.offset);\n    return true;  // indicate: success\n}\n\nexport function manage_selection_for_delete(updater) {\n    const selection = window.getSelection();\n    if (selection && !selection.isCollapsed) {\n        selection.deleteFromDocument();\n        // leave selection in the resultant collapsed state\n    } else {\n        let point = {\n            node:   selection?.focusNode   ?? null,\n            offset: selection?.focusOffset ?? 0,\n        };\n        point = updater(point);\n        if (!point) {\n            beep();  // there was nothing to delete\n        } else {\n            selection.setBaseAndExtent(point.node, point.offset, point.node, point.offset);\n        }\n    }\n    return true;  // indicate: success\n}\n\n// modifies point, returns true iff successful\nexport function move_point_forward(point) {\n    if (!point?.node) {\n        return false;  // nowhere to move from\n    }\n//!!! check this:\n    const child_count = (point.node.nodeType === Node.TEXT_NODE) ? point.node.length : point.node.childNodes.length;\n    if (point.offset < child_count) {\n        point.offset++;  // new point is within same (Text) node\n        return true;\n    } else {\n        const tree_walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT);\n        tree_walker.currentNode = point.node;\n        point.node = tree_walker.nextNode();\n        if (!point.node) {\n            point.offset = 0;\n            return false;\n        }\n        if (point.node.nodeType === Node.TEXT_NODE) {\n            point.offset = 0;\n        } else {\n            // must point to this Element node from its parent\n            point.offset = find_child_offset(point.node);\n            point.node = point.node.parentNode;\n        }\n        return true;\n    }\n}\n\n// modifies point, returns true iff successful\nexport function move_point_reverse(point) {\n    if (!point?.node) {\n        return false;  // nowhere to move from\n    }\n    if (point.offset > 0) {\n        point.offset--;  // new point is within same node\n        return true;\n    } else {\n        const tree_walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT);\n        tree_walker.currentNode = point.node;\n        point.node = tree_walker.previousNode();\n        if (!point.node) {\n            point.offset = 0;\n            return false;\n        }\n        if (point.node.nodeType === Node.TEXT_NODE) {\n            point.offset = point.node.length;\n        } else {\n            // must point to this Element node from its parent\n            point.offset = find_child_offset(point.node);\n            point.node = point.node.parentNode;\n        }\n        return true;\n    }\n}\n\n// modifies point, returns true iff successful\nexport function move_point(point, reverse=false) {\n    return (reverse ? move_point_reverse : move_point_forward)(point);\n}\n\n// returns new point { node, offset } if successful, otherwise null\nexport function insert_at(point, thing) {\n    if (typeof point !== 'object') {\n        throw new Error('point must be an object');\n    }\n    let { node, offset } = point;\n    if (!node) {\n        return null;\n    }\n    if (typeof thing !== 'undefined' && thing !== null) {\n        if (typeof thing === 'string') {\n            if (node instanceof Text) {\n                node.data = `${node.data.substring(0, offset)}${thing}${node.data.substring(offset)}`;\n                // update offset\n                offset += thing.length;\n            } else {\n                const text_node = document.createTextNode(thing);\n                node.insertBefore(text_node, node.childNodes[offset]);\n                // update offset\n                offset++;\n            }\n        } else if (thing instanceof Node) {\n            // note that thing may be a DocumentFragment here\n            if (node instanceof Text) {\n                //!!! could be more careful not to create empty text nodes here\n                const next_node = node.splitText(offset);\n                node.parentNode.insertBefore(thing, next_node);\n                // update node, offset\n                node = next_node;\n                offset = 0;\n            } else {\n                node.insertBefore(thing, node.childNodes[offset]);\n                offset++;\n            }\n        } else {\n            throw new Error('thing must be a string or an instance of Node');\n        }\n    }\n    return { node, offset };\n}\n\n// returns new point { node, offset } if successful, otherwise null\nexport function delete_nearest_leaf(point, options=null) {\n    const { element_too, reverse } = options ?? {};\n\n    // validate point\n    let { node, offset } = point ?? {};\n    if ( !(node instanceof Node) ||\n         (node.nodeType !== Node.TEXT_NODE && node.nodeType !== Node.ELEMENT_NODE) ||\n         typeof offset !== 'number' ||\n         offset < 0 ||\n         offset > ((node.nodeType === Node.TEXT_NODE) ? node.length : node.childNodes.length)\n       ) {\n        throw new Error('invalid point');\n    }\n\n    for (;;) {\n        // if node is a non-empty Text and offset is within range then handle directly here\n        if (node.nodeType === Node.TEXT_NODE && node.length > 0) {\n            if (reverse) {\n                if (offset > 0) {\n                    offset--;\n                    node.data = node.data.substring(0, offset) + node.data.substring(offset+1);\n                    return { node, offset };\n                }\n            } else {\n                if (offset < node.length) {\n                    node.data = node.data.substring(0, offset) + node.data.substring(offset+1);\n                    return { node, offset };\n                }\n            }\n        }\n\n        // At this point node is a Text node only if the deletion is to happen\n        // outside it (i.e., the offset was out of the node's bounds), in which\n        // case the we assume the offset indicated just one character outside\n        // (otherwise, the original point was invalid).\n        if (node.nodeType === Node.ELEMENT_NODE) {\n            // shift to node at given offset\n            node = node.childNodes[offset];\n            if (!node) {\n                return { node, offset: 0 };\n            }\n            if (reverse) {\n                const child_count = (node.nodeType === Node.TEXT_NODE) ? node.length : node.childNodes.length;\n                offset = child_count;\n            } else {\n                offset = 0;\n            }\n            continue;  // reprocess with new node, offset\n        }\n\n        break;\n    }\n\n    // if node is an empty (leaf) Element then handle directly here\n    if (node.nodeType === Node.ELEMENT_NODE && !node.hasChildNodes()) {\n        const new_point = { node: node.parentNode, offset: find_child_offset(node) };\n        node.parentNode.removeChild(node);\n        return new_point;\n    }\n\n    // use a TreeWalker to find a non-empty Text or a leaf Element\n    const tree_walker_filter = element_too\n          ? NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT\n          : NodeFilter.SHOW_TEXT;\n    const tree_walker = document.createTreeWalker(document.body, tree_walker_filter, {\n        acceptNode(node) {\n            // accept only non-empty Text nodes or empty (leaf) Element nodes\n            // (the characters in Text nodes are \"leaf\" items)\n            if ( (node.nodeType === Node.TEXT_NODE    && node.length > 0) ||\n                 (node.nodeType === Node.ELEMENT_NODE && (!node.hasChildNodes() || [ ...node.childNodes ].every(n => n.nodeType === Node.TEXT_NODE && n.length <= 0)))\n               ) {\n                return NodeFilter.FILTER_ACCEPT;\n            } else {\n                return NodeFilter.FILTER_SKIP;\n            }\n        }\n    });\n    tree_walker.currentNode = node;\n    node = reverse ? tree_walker.previousNode() : tree_walker.nextNode();\n    if (!node) {\n        return null;  // nothing found\n    } else {\n        if (node.nodeType === Node.TEXT_NODE) {\n            offset = reverse ? node.length-1 : 0;\n            node.data = node.data.substring(0, offset) + node.data.substring(offset+1);\n            return { node, offset };\n        } else {\n            const new_point = { node: node.parentNode, offset: find_child_offset(node) };\n            node.parentNode.removeChild(node);\n            return new_point;\n        }\n    }\n}\n\n\n// === MISC ===\n\nexport function is_text_direction_ltr(element) {\n    const dir_str = document.defaultView?.getComputedStyle?.(element)?.direction;\n    switch (dir_str) {\n    case 'ltr':  return true;\n    case 'rtl':  return false;\n    case 'auto': return true;\n    default:     throw new Error('unexpected direction value');\n    }\n}\n","import {\n    KeySpec,\n} from './key-spec.js';\n\nimport {\n    KeyMap,\n} from './key-map.js';\n\nimport {\n    EventListenerManager,\n} from '../../sys/event-listener-manager.js';\n\nimport {\n    beep,\n} from '../beep.js';\n\nimport {\n    Subscribable,\n} from '../../sys/subscribable.js';\n\n\nexport class KeyEventManager {\n    /** KeyEventManager constructor\n     *  @param {EventTarget} event_target the source of events\n     *  @param {Function} command_observer function to handle command events\n     */\n    constructor(event_target, command_observer) {\n        if (!(event_target instanceof EventTarget)) {\n            throw new Error('event_target must be and instance of EventTarget');\n        }\n        if (typeof command_observer !== 'function') {\n            throw new Error('command_observer must be a function');\n        }\n\n        this.#event_listener_manager = new EventListenerManager();\n\n        const commands = new Subscribable();  // emits command_context: { command: string, event: Event, target: Element, key_spec: KeySpec }\n        this.#commands_subscription = commands.subscribe(command_observer);\n        // note: we do not unsubscribe\n\n        this.#key_map_stack = [];    // stack grows from the front, i.e., the first item is the last pushed\n        this.#key_mapper    = null;  // set iff attached\n\n        Object.defineProperties(this, {\n            event_target: {\n                value:      event_target,\n                enumerable: true,\n            },\n            command_observer: {\n                value:      command_observer,\n                enumerable: true,\n            },\n            commands: {\n                value:      commands,\n                enumerable: true,\n            },\n        });\n    }\n    #event_listener_manager;\n    #commands_subscription;\n    #key_map_stack;\n    #key_mapper;  // set iff attached\n\n    reset_key_map_stack() {\n        if (this.#key_map_stack.length > 0) {\n            this.#key_map_stack.splice(0);  // clear stack\n            this.#rebuild();\n        }\n    }\n    push_key_map(key_map) {\n        if (!(key_map instanceof KeyMap)) {\n            throw new Error('key_map must be an instance of KeyMap');\n        }\n        if (this.#key_map_stack.indexOf(key_map) !== -1) {\n            throw new Error('key_map already exists in stack');\n        }\n        this.#key_map_stack.unshift(key_map);\n        this.#rebuild();\n    }\n    pop_key_map() {\n        const popped_key_map = this.#key_map_stack.shift();\n        if (popped_key_map) {\n            this.#rebuild();\n        }\n        return popped_key_map;\n    }\n    remove_key_map(key_map, remove_subsequent_too=false) {\n        const index = this.#key_map_stack.indexOf(key_map);\n        if (index === -1) {\n            return false;\n        } else {\n            if (remove_subsequent_too) {\n                this.#key_map_stack.splice(0, index+1);  // delete this and newer items\n            } else {\n                this.#key_map_stack.splice(index, 1);  // delete only this item\n            }\n            this.#rebuild();\n            return true;\n        }\n    }\n\n    get is_attached (){ return !!this.#key_mapper; }  // this.#key_mapper set iff attached\n\n    /** attach to event_target and start listening for events.\n     *  @return {Boolean} true iff successful\n     */\n    attach() {\n        if (this.is_attached) {\n            throw new Error('attach() called when already attached');\n        }\n        if (!this.#event_listener_manager.empty) {\n            throw new Error('unexpected: attach() called with event listeners already present');\n        }\n\n        // this.#key_mapper is null\n        if (this.#key_map_stack.length <= 0) {\n            return false;  // indicate: attach failed\n        }\n\n        this.#key_mapper = KeyMap.multi_mapper(...this.#key_map_stack);\n\n        const initial_state = this.#key_mapper;\n        let state;         // current \"location\" in key mapper\n        let key_sequence;  // current sequence of key_specs that have been seen\n\n        function reset() {\n            state = initial_state;\n            key_sequence = [];\n        }\n        reset();\n\n        const blur_handler = reset;  // attached to this.event_target\n\n        const key_handler = (event) => {  // attached to this.event_target\n            switch (event.key) {\n            case 'Alt':\n            case 'AltGraph':\n            case 'CapsLock':\n            case 'Control':\n            case 'Fn':\n            case 'FnLock':\n            case 'Hyper':\n            case 'Meta':\n            case 'NumLock':\n            case 'ScrollLock':\n            case 'Shift':\n            case 'Super':\n            case 'Symbol':\n            case 'SymbolLock':\n            case 'OS':  // Firefox quirk\n                // modifier key, ignore\n                break;\n\n            default: {\n                const key_spec = KeySpec.from_keyboard_event(event);\n                key_sequence.push(key_spec);\n                const mapping_result = state.consume(key_spec);\n                if (!mapping_result) {\n                    // failed\n                    if (state !== initial_state) {\n                        // beep only if at least one keypress has already been accepted\n                        event.preventDefault();\n                        beep();\n                    }\n                    // if still in initial_state, then no event.preventDefault()\n                    reset();\n                } else {\n                    event.preventDefault();\n                    if (typeof mapping_result === 'string') {\n                        const command = mapping_result;\n                        const command_context = { command, event, target: event.target, key_spec };\n                        this.commands.dispatch(command_context);\n                        reset();\n                    } else {\n                        state = mapping_result;\n                    }\n                }\n                break;\n            }\n            }\n        };\n\n        const listener_specs = [\n            [ this.event_target, 'blur',    blur_handler, { capture: true } ],\n            [ this.event_target, 'keydown', key_handler,  { capture: true } ],\n        ];\n        for (const [ target, type, listener, options ] of listener_specs) {\n            this.#event_listener_manager.add(target, type, listener, options);\n        }\n\n        return true;  // indicate: successfully attached\n    }\n\n    /** detach from event_target and stop listening for events.\n     *  no-op if called when already detached.\n     */\n    detach() {\n        this.#event_listener_manager.remove_all();\n        this.#key_mapper = null;\n    }\n\n\n    // === INTERNAL ===\n\n    #rebuild() {\n        // rebuild the event handlers and state machine.\n        const was_attached = this.is_attached;\n        this.detach();\n        if (was_attached) {\n            this.attach();  // will fail if key_map stack is empty\n        }\n    }\n}\n","import {\n    KeySpec,\n} from './key-spec.js';\n\n\nexport class KeyMap {\n    constructor(bindings=null, recognizer=null) {\n        Object.defineProperties(this, {\n            bindings: {  // key/command bindings\n                value:      bindings,\n                enumerable: true,\n            },\n            mapping: {  // canonical_key_string->(false|command|another_mapping)\n                value:      this.constructor.#create_mapping(bindings),\n                enumerable: true,\n            },\n            recognizer: {  // key_spec => (false|command)\n                value:      recognizer,\n                enumerable: true,\n            },\n        });\n    }\n\n    create_mapper(fallback_mapper=null) {\n        return new this.constructor.Mapper(this.mapping, this.recognizer, fallback_mapper);\n    }\n\n    static multi_mapper(...key_maps) {\n        if (key_maps.length <= 0) {\n            throw new Error('at least one KeyMap instance must be given');\n        }\n        if (!key_maps.every(m => m instanceof this)) {\n            throw new Error('arguments must all be KeyMap instances');\n        }\n        return key_maps.reduce((mapper, key_map) => key_map.create_mapper(mapper), null);\n    }\n\n    static #create_mapping(bindings) {\n        if (bindings !== null && typeof bindings !== 'undefined' && typeof bindings !== 'object') {\n            throw new Error('bindings must be null/undefined or an object');\n        }\n        const mapping = {};\n        for (const command in bindings) {\n            if (command.length <= 0) {\n                throw new Error('bindings keys (command names) must not be empty strings');\n            }\n            for (const key_sequence of bindings[command]) {\n                let seq_mapping = mapping;  // current mapping being acted upon by current key_string of sequence\n                const seq_key_strings = key_sequence.split(KeySpec.canonical_key_string_separator);\n                for (let i = 0; i < seq_key_strings.length; i++) {\n                    const key_string = seq_key_strings[i];\n                    const is_last = (i >= seq_key_strings.length-1);\n                    const canonical_key_string = new KeySpec(key_string).canonical;\n                    const existing = seq_mapping[canonical_key_string];\n                    if (typeof existing === 'string' || (typeof existing === 'object' && is_last)) {\n                        // something else already mapped here...\n                        const seq_so_far = seq_key_strings.slice(0, i+1).join(KeySpec.canonical_key_string_separator);\n                        throw new Error(`duplicate bindings specified for key sequence: ${seq_so_far}`);\n                    }\n                    if (!is_last) {\n                        seq_mapping = existing ?? (seq_mapping[canonical_key_string] = {});\n                    } else {\n                        seq_mapping[canonical_key_string] = command;  // and then we're done...\n                    }\n                }\n            }\n        }\n        return mapping;\n    }\n\n    static Mapper = class Mapper {\n        constructor(mapping, recognizer, fallback_mapper=null) {\n            if (mapping !== null && typeof mapping !== 'undefined' && typeof mapping !== 'object') {\n                throw new Error('mapping must be null/undefined or an object');\n            }\n            if (recognizer !== null && typeof recognizer !== 'undefined' && typeof recognizer !== 'function') {\n                throw new Error('recognizer must be null/undefined or a function');\n            }\n            if (fallback_mapper !== null && typeof fallback_mapper !== 'undefined' && !(fallback_mapper instanceof this.constructor)) {\n                throw new Error('fallback_mapper must be null/undefined or a KeyMap instance');\n            }\n            if (!mapping && !fallback_mapper) {\n                throw new Error('at least one of mapping or fallback_mapper must be given');\n            }\n            Object.defineProperties(this, {\n                mapping: {\n                    value:      mapping,\n                    enumerable: true,\n                },\n                recognizer: {\n                    value:      recognizer,\n                    enumerable: true,\n                },\n                fallback_mapper: {\n                    value:      fallback_mapper,\n                    enumerable: true,\n                },\n            });\n        }\n\n        // returns a command string (complete), or undefined (failed), or a new Mapper instance (waiting for next key in sequence)\n        consume(key_string_or_key_spec) {\n            const key_spec = (key_string_or_key_spec instanceof KeySpec)\n                  ? key_string_or_key_spec\n                  : new KeySpec(key_string_or_key_spec);\n            const recognizer_result = this.recognizer?.(key_spec);\n            // this.recognizer takes precedence over this.mapping\n            if (typeof recognizer_result === 'string') {\n                return recognizer_result;\n            }\n            // this.mapping takes precedence over this.fallback_mapper\n            const canonical_key_string = key_spec.canonical;\n            const mapping_result = this.mapping?.[canonical_key_string];  // returns: undefined, string, or another mapping (object)\n            if (typeof mapping_result === 'string') {\n                return mapping_result;\n            }\n            const fallback_mapper_result = this.fallback_mapper?.consume(key_spec);\n            if (typeof fallback_mapper_result === 'string') {\n                return fallback_mapper_result;\n            }\n            if (!mapping_result && !fallback_mapper_result) {\n                return undefined;  // indicate: failed\n            }\n            return mapping_result\n                ? new Mapper(mapping_result, null, fallback_mapper_result)\n                : fallback_mapper_result;  // no need to compose with mapping_result (which is undefined)\n        }\n    };\n}\n","export class KeySpec {\n    constructor(key_string, context=null) {\n        if (typeof key_string !== 'string' || key_string.length <= 0) {\n            throw new Error('key_string must be a non-empty string');\n        }\n        Object.defineProperties(this, {\n            key_string: {\n                value:      key_string,\n                enumerable: true,\n            },\n            context: {\n                value:      context,\n                enumerable: true,\n            },\n        });\n        this.#init();\n    }\n\n\n    // === CONSTANTS ===\n\n    static canonical_key_modifier_separator = '+';  // separator between modifier codes and key in a canonical key string\n    static canonical_key_string_separator   = ' ';  // separator between key_strings in a canonical key binding\n\n    // #basic_modifier_desc_map is the definition from which #modifier_desc_map and #modifier_code_desc_map are derived\n    static #basic_modifier_desc_map = {\n        meta:  { code: 'm', event_prop: 'metaKey',  glyph: '\\u2318', display_order: 3, alternates: [ 'cmd', 'command' ] },\n        ctrl:  { code: 'c', event_prop: 'ctrlKey',  glyph: '\\u2303', display_order: 1, alternates: [ 'control' ] },\n        shift: { code: 's', event_prop: 'shiftKey', glyph: '\\u21E7', display_order: 2, alternates: [] },\n        alt:   { code: 'a', event_prop: 'altKey',   glyph: '\\u2325', display_order: 4, alternates: [] },\n    };\n\n    static #other_key_glyphs = {\n        arrowleft:  '\\u2190',\n        arrowup:    '\\u2191',\n        arrowright: '\\u2192',\n        arrowdown:  '\\u2193',\n        enter:      'Enter',\n        backspace:  'Backspace',\n        delete:     'Delete',\n    };\n\n\n    // === PARSING ===\n\n    static from_keyboard_event(keyboard_event) {\n        const modifier_descs = [];\n        for (const modifier in this.#basic_modifier_desc_map) {\n            const desc = this.#basic_modifier_desc_map[modifier];\n            if (keyboard_event[desc.event_prop]) {\n                modifier_descs.push(desc);\n            }\n        }\n        const modifier_strings = modifier_descs\n              .map(desc => this.#modifier_code_to_modifier[desc.code]);\n        let key = event.key;\n        const key_string = [ ...modifier_strings, key ].join(this.canonical_key_modifier_separator);\n        // attaching keyboard_event as context enables commands like \"insert-self\"\n        return new this(key_string, keyboard_event);\n    }\n\n    get glyphs (){\n        if (typeof this.#glyphs === 'undefined') {\n            // cache result\n            const key = this.key;\n            const klc = key.toLowerCase();\n            const result_segments = this.modifier_descs.map(desc => desc.glyph);\n            if (klc in this.constructor.#other_key_glyphs) {\n                result_segments.push(this.constructor.#other_key_glyphs[klc]);\n            } else if (key.match(/^[a-zA-Z]$/) || key.match(/^[fF][0-9]{1,2}$/)) {\n                result_segments.push(key.toUpperCase());\n            } else {\n                result_segments.push(key);\n            }\n            this.#glyphs = result_segments.join('');\n        }\n        return this.#glyphs;\n    }\n    #glyphs;  // memoization\n\n\n    // === INTERNAL ===\n\n    #init() {\n        const modifiers = this.key_string.split(/[+-]/);\n        if (modifiers.length < 1 || modifiers.some(s => s.length <= 0)) {\n            // check for case where key is '+' or '-', e.g., \"-\" or \"shift++\":\n            if (this.key_string.match(/^[+-]$/)) {  // + or - alone?\n                modifiers.splice(0);  // remove all entries\n                modifiers.push(this.key_string)  // then add back this.key_string\n            } else if (this.key_string.match(/[+-][+-]$/)) {  // with modifier?\n                // remove last (empty) string:\n                modifiers.splice(-1);\n                // change new last (empty) string to the '+' or '-' that was specified:\n                modifiers[modifiers.length-1] = this.key_string[this.key_string.length-1];\n            } else {\n                throw new Error(`invalid key_string ${this.key_string}`);\n            }\n        }\n        let key = modifiers.at(-1);  // note: not converted to lowercase\n        modifiers.splice(-1);  // remove key from modifiers\n        for (let i = 0; i < modifiers.length; i++) {\n            modifiers[i] = modifiers[i].toLowerCase();\n        }\n        let klc = key.toLowerCase();\n        if (['up', 'down', 'left', 'right'].includes(klc)) {\n            key = `Arrow${key}`;\n            klc = `arrow${klc}`;\n        }\n        const modifier_descs = [];\n        for (const modifier of modifiers) {\n            const desc = this.constructor.#key_string_modifier_to_desc(modifier);\n            if (!desc) {\n                throw new Error(`invalid modifier \"${modifier}\" in key_string ${this.key_string}`);\n            }\n            if (desc.code in modifier_descs) {//!!! incorrect comparison\n                throw new Error(`redundant modifier \"${modifier}\" in key_string ${this.key_string}`);\n            }\n            modifier_descs.push(desc);\n        }\n        modifier_descs.sort((a, b) => (a.display_order - b.display_order));  // sort in-place\n        const modifier_flags = Object.values(modifier_descs)\n              .reduce((flags, desc) => (flags | this.constructor.#modifier_to_flag[desc.code]), 0);\n        const canonical_modifiers = modifier_descs\n              .map(desc => desc.code)\n              .join('');\n        // determine is_printable\n        let is_printable = true;\n        if ((modifier_flags & ~this.constructor.shift_flag) !== 0) {\n            // not printable if any modifier other than shift is applied\n            is_printable = false;\n        } else {\n            // \\p{C}: see https://unicode.org/reports/tr18/#General_Category_Property (\"Control\" characters)\n            is_printable = !(key.length !== 1 || key.match(/^[\\p{C}]$/u));\n        }\n        // note: preserve alphabetic case if is_printable, otherwise use lower-cased key\n        const canonical = `${canonical_modifiers}${this.constructor.canonical_key_modifier_separator}${is_printable ? key : klc}`;\n\n        Object.freeze(modifiers);\n        Object.freeze(modifier_descs);\n\n        Object.defineProperties(this, {\n            key: {\n                value:      key,\n                enumerable: true,\n            },\n            modifiers: {\n                value:      modifiers,\n                enumerable: true,\n            },\n            modifier_descs: {\n                value:      modifier_descs,\n                enumerable: true,\n            },\n            modifier_flags: {\n                value:      modifier_flags,\n                enumerable: true,\n            },\n            canonical_modifiers: {\n                value:      canonical_modifiers,\n                enumerable: true,\n            },\n            canonical: {\n                value:      canonical,\n                enumerable: true,\n            },\n            is_printable: {\n                value:      is_printable,\n                enumerable: true,\n            },\n        });\n\n        for (const modifier in this.constructor.#basic_modifier_desc_map) {\n            Object.defineProperty(this, `has_${modifier}`, {\n                value:      this.modifiers.includes(modifier),\n                enumerable: true,\n            });\n        }\n\n    }\n\n    // modifier_desc: {\n    //     modifier:       string,  // modifier string\n    //     basic_modifier: string,  // canonical modifier string\n    //     code:           string,  // canonical code for modifier\n    //     event_prop:     string,  // corresponding property in KeyboardEvent object\n    //     alternates:     string,  // all alternates, including basic_modifier\n    // }\n    static #modifier_desc_map;       // modifier_string->modifier_desc; initialized in this._init_static()\n    static #modifier_code_desc_map;  // modifier_code->modifier_desc;   initialized in this._init_static()\n\n    static #is_on_macos;  // initialized in this._init_static()\n\n    static #key_string_modifier_to_desc(modifier) {\n        modifier = modifier.toLowerCase();\n        if (['cmdorctrl', 'commandorctrl'].includes(modifier)) {\n            const CmdOrCtrl = this.#is_on_macos ? 'meta' : 'ctrl';\n            modifier = CmdOrCtrl.toLowerCase();\n        }\n        return this.#modifier_desc_map[modifier];\n    }\n\n    static #modifier_code_to_modifier;       // code->modifier; initialized in this.#_init_static()\n    static #modifier_code_to_glyph;          // code->glyph;    initialized in this.#_init_static()\n    static #modifier_code_to_display_order;  // code->number;   initialized in this.#_init_static()\n\n    static #modifier_to_flag;  // (code|full)->bit_field_integer\n\n    // Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\n    static _init_static() {\n        this.#is_on_macos = (globalThis.navigator?.platform ?? globalThis.navigator?.userAgentData?.platform ?? '').toLowerCase().startsWith('mac');\n\n        this.#modifier_code_to_modifier = {};  // code->modifier\n        for (const modifier in this.#basic_modifier_desc_map) {\n            const desc = this.#basic_modifier_desc_map[modifier];\n            this.#modifier_code_to_modifier[desc.code] = modifier;\n        }\n\n        this.#modifier_code_to_glyph =  // code->glyph\n            Object.fromEntries(\n                Object.entries(this.#basic_modifier_desc_map)\n                    .map(([modifier_key, { code, glyph }]) => [ code, glyph ])\n            );\n\n        this.#modifier_code_to_display_order =  // code->number\n            Object.fromEntries(\n                Object.entries(this.#basic_modifier_desc_map)\n                    .map(([modifier_key, { code, display_order }]) => [ code, display_order ])\n            );\n\n        this.#modifier_desc_map = this.#build_modifier_desc_map();  // modifier_string->modifier_desc\n\n        this.#modifier_code_desc_map =  // modifier_code->modifier_desc\n            Object.freeze(\n                Object.fromEntries(\n                    Object.keys(this.#basic_modifier_desc_map)\n                        .map(k => this.#modifier_desc_map[k])\n                        .map(desc => [ desc.code, desc ])\n                )\n            );\n\n        let current_bit = 1;\n        this.#modifier_to_flag = {};  // (code|full)->bit_field_integer\n        for (const modifier in this.#basic_modifier_desc_map) {\n            const desc = this.#basic_modifier_desc_map[modifier];\n            this.#modifier_to_flag[modifier]  = current_bit;\n            this.#modifier_to_flag[desc.code] = current_bit;\n            current_bit <<= 1;\n        }\n        Object.freeze(this.#modifier_to_flag);\n\n        for (const modifier in this.#basic_modifier_desc_map) {\n            Object.defineProperty(this, `${modifier}_flag`, {\n                value:      this.#modifier_to_flag[modifier],\n                enumerable: true,\n            });\n        }\n    }\n\n    static #build_modifier_desc_map() {\n        // validate this.#basic_modifier_desc_map:\n        {\n            const disallowed_modifier_codes = ('+-' + this.canonical_key_modifier_separator + this.canonical_key_string_separator);\n\n            const keys = Object.keys(this.#basic_modifier_desc_map);\n            if (keys.some(k => k !== k.toLowerCase())) {\n                throw new Error('KeySpec.#basic_modifier_desc_map keys must be lowercase');\n            }\n            const all_alternates = keys.map(k => this.#basic_modifier_desc_map[k].alternates).reduce((acc, a) => [...acc, ...a]);\n            if (all_alternates.some(k => k !== k.toLowerCase())) {\n                throw new Error('KeySpec.#basic_modifier_desc_map alternates must be lowercase');\n            }\n            if (new Set([...keys, ...all_alternates]).size !== (keys.length + all_alternates.length)) {\n                throw new Error('KeySpec.#basic_modifier_desc_map keys and alternates must all be distinct');\n            }\n            const codes = keys.map(k => this.#basic_modifier_desc_map[k].code)\n            for (const code of codes) {\n                if (code.length !== 1) {\n                    throw new Error('KeySpec.#basic_modifier_desc_map codes must be single characters');\n                }\n                if (disallowed_modifier_codes.includes(code)) {\n                    throw new Error(`KeySpec.#basic_modifier_desc_map codes are not allowed to be any of following: ${disallowed_modifier_codes}`);\n                }\n            }\n            if (new Set(codes).size !== codes.length) {\n                throw new Error('KeySpec.#basic_modifier_desc_map code values must be distinct');\n            }\n            const props = keys.map(k => this.#basic_modifier_desc_map[k].event_prop)\n            if (new Set(props).size !== props.length) {\n                throw new Error('KeySpec.#basic_modifier_desc_map event_prop values must be distinct');\n            }\n        }\n        // validation passed; build the map\n        const mdm = {};\n        function create_extended_desc(basic_modifier_key, modifier_key, desc) {\n            const ext_desc = {\n                modifier: modifier_key,\n                basic_modifier: basic_modifier_key,\n                ...desc,\n                alternates: [ ...new Set([ basic_modifier_key, modifier_key, ...desc.alternates ]) ],\n            };\n            return Object.freeze(ext_desc);\n        }\n        for (const bmdm_key in this.#basic_modifier_desc_map) {\n            const desc = this.#basic_modifier_desc_map[bmdm_key];\n            mdm[bmdm_key] = create_extended_desc(bmdm_key, bmdm_key, desc);\n            for (const alt_key of desc.alternates) {\n                mdm[alt_key] = create_extended_desc(bmdm_key, alt_key, desc);\n            }\n        }\n        return Object.freeze(mdm);\n    }\n}\n\n// Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\nKeySpec._init_static();\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    Subscribable,\n} from '../../sys/subscribable.js';\n\nimport {\n    generate_object_id,\n} from '../../sys/uuid.js';\n\nimport {\n    create_element,\n} from '../dom-util.js';\n\nimport {\n    KeySpec,\n} from '../key/_.js';\n\nimport {\n    assets_server_url,\n} from '../../../src/assets-server-url.js';\n\n// import {\n//     create_stylesheet_link,\n// } from '../dom-util.js';\n// create_stylesheet_link(document.head, new URL('./style.css', assets_server_url(current_script_url)));\nimport './style.css';  // webpack implementation\n\n\n// === MENUBAR CLASS ===\n\n// css classification classes: menubar, menu, menuitem\n// other css classes: disabled, selected, active\n// also: menuitem-label, menuitem-separator, menuitem-annotation, collection, collection-arrow\n\nexport class MenuBar {\n    static menu_element_tag_name     = 'menu';\n    static menuitem_element_tag_name = 'li';\n\n    static find_previous_menuitem(menuitem) {\n        let mi = menuitem.previousElementSibling;\n        while (mi && (!mi.classList.contains('menuitem') || mi.classList.contains('disabled'))) {\n            mi = mi.previousElementSibling;\n        }\n        return mi;\n    }\n\n    static find_next_menuitem(menuitem) {\n        let mi = menuitem.nextElementSibling;\n        while (mi && (!mi.classList.contains('menuitem') || mi.classList.contains('disabled'))) {\n            mi = mi.nextElementSibling;\n        }\n        return mi;\n    }\n\n    /** call this static method, not the constructor directly\n     *  @param {Element} parent\n     *  @param {Object} menubar_spec: {\n     *      ...\n     *  }\n     *  @param {Function|null|undefined} get_command_bindings\n     *  @return {MenuBar} menu bar instance\n     */\n    static create(parent, menubar_spec, get_command_bindings) {\n        const menubar = new this(parent, menubar_spec, get_command_bindings);\n        return menubar;\n    }\n\n    constructor(parent, menubar_spec, get_command_bindings) {\n        if (!(parent instanceof Element)) {\n            throw new Error('parent must be an instance of Element');\n        }\n        if (get_command_bindings !== null && typeof get_command_bindings !== 'undefined' && typeof get_command_bindings !== 'function') {\n            throw new Error('get_command_bindings must be null, undefined, or a function');\n        }\n\n        get_command_bindings ??= () => [];\n\n        const commands = new Subscribable();  // emits command_context: { command: string, event: Event, target: Element }\n        const selects  = new Subscribable();  // emits { select: Boolean, target: Element }  // select: true is sent before, select: false is sent after\n\n        Object.defineProperties(this, {\n            get_command_bindings: {\n                value:      get_command_bindings,\n                enumerable: true,\n            },\n            commands: {\n                value:      commands,\n                enumerable: true,\n            },\n            selects: {\n                value:      selects,\n                enumerable: true,\n            },\n        });\n\n        this.#menu_id_to_element = {};\n        this.#menubar_container = this.#build_menubar(parent, menubar_spec);\n    }\n    #menu_id_to_element;\n    #menubar_container;\n\n    get element (){ return this.#menubar_container; }\n\n    #get_menu_element(menu_id) {\n        const element = this.#menu_id_to_element[menu_id];\n        if (!element) {\n            throw new Error(`no element found for menu id \"${menu_id}\"`);\n        }\n        if (!element.classList.contains('menuitem')) {\n            throw new Error(`element for menu id \"${menu_id}\" is not a menuitem`);\n        }\n        return element;\n    }\n\n    /** activate menu\n     *  @param {Object} options: {\n     *      set_focus?: Boolean,  // set focus, too?\n     *  }\n     */\n    async activate(options=null) {\n        if (!(this.#menubar_container instanceof Element) || !this.#menubar_container.classList.contains('menubar')) {\n            throw new Error('this.#menubar_container must be an Element with class \"menubar\"');\n        }\n        const {\n            set_focus,\n        } = (options ?? {});\n        if (!this.#menubar_container.querySelector('.selected')) {\n            // select the first menuitem of the menubar\n            const menubar_first_menuitem = this.#menubar_container.querySelector('.menuitem');\n            if (menubar_first_menuitem) {\n                this.#select_menuitem(menubar_first_menuitem);\n            }\n        }\n        if (set_focus) {\n            return new Promise(resolve => setTimeout(() => {\n                this.#menubar_container.focus();\n                resolve();\n            }));\n        }\n    }\n\n    /** deactivate menu\n     */\n    deactivate() {\n        this.#deactivate_menu(this.#menubar_container);\n    }\n\n    set_menu_state(menu_id, state_specs) {\n        state_specs ??= {};\n        if (typeof state_specs !== 'object') {\n            throw new Error('state_specs must be an object');\n        }\n        const element = this.#get_menu_element(menu_id);\n        for (const [ name, value ] of Object.entries(state_specs ?? {})) {\n            switch (name) {\n            case 'enabled': {\n                if (value) {\n                    element.classList.remove('disabled');\n                } else {\n                    element.classList.add('disabled');\n                }\n                break;\n            }\n            case 'checked': {\n                if (value) {\n                    element.classList.add('checked');\n                } else {\n                    element.classList.remove('checked');\n                }\n                break;\n            }\n            default: {\n                throw new Error('unknown state name');\n            }\n            }\n        }\n    }\n\n\n    // === INTERNAL ===\n\n    /** deactivate the menubar or menu that contains the given menuitem\n     *  and reset all subordinate state.\n     *  @param {Element|undefined|null} menu_element an Element object with class either .menubar or .menu\n     *  This is compatible with menuitem elements that are contained\n     *  in either a .menubar or .menu element.\n     */\n    #deactivate_menu(menu_element) {\n        if (menu_element) {\n            if ( !(menu_element instanceof Element) ||\n                 (!menu_element.classList.contains('menubar') && !menu_element.classList.contains('menu')) ) {\n                throw new Error('menu_element must be an Element with class \"menubar\" or \"menu\"');\n            }\n            menu_element.classList.remove('active');\n            menu_element.classList.remove('selected');\n            for (const mi of menu_element.children) {\n                mi.classList.remove('selected');\n                if (mi.classList.contains('collection')) {\n                    this.#deactivate_menu(mi.querySelector('.menu'));\n                }\n            }\n            if (menu_element.classList.contains('menubar')) {\n                this.selects.dispatch({ select: false, target: menu_element });\n            }\n        }\n    }\n\n    /** select the given menuitem and deselect all others\n     *  @param {Element} menuitem_element\n     *  This is compatible with menuitem elements that are contained\n     *  in either a .menubar or .menu element.\n     */\n    #select_menuitem(menuitem_element) {\n        if (!menuitem_element.classList.contains('selected')) {\n            // change selection only if not already selected\n            const container = menuitem_element.closest('.menubar, .menu');\n            if (container.classList.contains('menubar') && !this.#menubar_container.querySelector('.selected')) {\n                this.selects.dispatch({ select: true, target: menuitem_element });\n            }\n            // add .selected to menuitem_element\n            menuitem_element.classList.add('selected');\n            if (menuitem_element.classList.contains('collection')) {\n                // make it \"active\" so that the submenu is displayed\n                menuitem_element.querySelector('.menu').classList.add('active');\n                // adjust the position of the collection\n                const collection = menuitem_element.querySelector('.menu');\n                const menuitem_element_br = menuitem_element.getBoundingClientRect();\n                if (menuitem_element.parentElement.classList.contains('menubar')) {\n                    collection.style.top  = `${menuitem_element_br.y + menuitem_element_br.height}px`;\n                    collection.style.left = `${menuitem_element_br.x}px`;\n                } else {\n                    collection.style.top  = `${menuitem_element_br.y - menuitem_element_br.height}px`;\n                    collection.style.left = `${menuitem_element_br.x + menuitem_element_br.width}px`;\n                }\n            }\n            // we updated menuitem_element first so that we don't erroneously\n            // fire a selects event with select: false while we deselect all\n            // other children now\n            for (const mi of container.children) {\n                if (mi !== menuitem_element) {\n                    this.#deselect_menuitem(mi);\n                }\n            }\n        }\n    }\n\n    /** deselect the given menuitem\n     *  @param {Element} menuitem_element\n     *  This is compatible with menuitem elements that are contained\n     *  in either a .menubar or .menu element.\n     */\n    #deselect_menuitem(menuitem_element) {\n        if (menuitem_element.classList.contains('selected')) {\n            menuitem_element.classList.remove('selected');\n            if (menuitem_element.parentElement.classList.contains('menubar') && !this.#menubar_container.querySelector('.selected')) {\n                this.selects.dispatch({ select: false, target: menuitem_element });\n            }\n        }\n        if (menuitem_element.classList.contains('collection')) {\n            this.#deactivate_menu(menuitem_element.querySelector('.menu'));\n        }\n    }\n\n    /** Return a new menu Element object which represents a separator.\n     *  @param {Element} parent\n     */\n    #build_menu_item_separator(parent) {\n        if (!(parent instanceof Element)) {\n            throw new Error('parent must be an instance of Element');\n        }\n        const element = create_element({\n            parent,\n            tag: this.constructor.menuitem_element_tag_name,\n            attrs: {\n                class: 'disabled menuitem menuitem-separator',\n            },\n        });\n    }\n\n    /** Return a new menu Element object for the given menu_spec.\n     *  @param {object|string} menu_spec specification for menu item or collection.\n     *         If a string, then create a separator (regardless of the string contents).\n     *  @param {Element} parent\n     *  @param {boolean} (optional) toplevel if the menu is the top-level \"menubar\" menu\n     *         default value: false\n     *  @return {Element} new menu Element\n     *  Also updates this.#menu_id_to_element\n     */\n    #build_menu(menu_spec, parent, toplevel=false) {\n        if (!(parent instanceof Element)) {\n            throw new Error('parent must be an instance of Element');\n        }\n        if (typeof menu_spec === 'string') {\n            return this.#build_menu_item_separator(parent);\n        }\n\n        const {\n            label,\n            collection,\n            item,\n            id: menu_id,\n        } = menu_spec;\n\n        if (typeof label !== 'string') {\n            throw new Error('label must be specified as a string');\n        }\n        if (item && collection) {\n            throw new Error('item and collection must not both be specified');\n        }\n        if (collection) {\n            if (!Array.isArray(collection)) {\n                throw new Error('collection must be an array');\n            }\n        }\n        if (item) {\n            if (typeof item !== 'object' || typeof item.command !== 'string') {\n                throw new Error('item must specify an object with a string property \"command\"');\n            }\n        }\n        if (!['undefined', 'string'].includes(typeof menu_id) || menu_id === '') {\n            throw new Error('id must be a non-empty string');\n        }\n\n        // both items and collections are menuitem elements, but the collection also has children...\n        const element = this.#build_menuitem(label, toplevel);\n\n        if (item) {\n            this.#add_item_menuitem_annotations_and_click_handler(element, item.command);\n        } else {\n            // collection\n            element.classList.add('collection');\n\n            const collection_element = create_element({\n                parent: element,\n                tag:    this.constructor.menu_element_tag_name,\n                attrs: {\n                    class: 'menu',\n                },\n            });\n            if (!toplevel) {\n                create_element({\n                    parent: element,\n                    attrs: {\n                        class: 'menuitem-annotation collection-arrow',\n                    },\n                }).innerText = '\\u25b8';  // right-pointing triangle\n            }\n            collection.forEach(spec => this.#build_menu(spec, collection_element));\n\n            if (toplevel) {\n                element.addEventListener('click', (event) => {\n                    if (event.target.closest('.menuitem') === element) {  // make sure click is not in a child (submenu)\n                        if (element.classList.contains('selected')) {\n                            this.#deselect_menuitem(element);\n                        } else {\n                            this.#select_menuitem(element);\n                        }\n                        event.stopPropagation();\n                        event.preventDefault();\n                    }\n                });\n            }\n        }\n\n        if (menu_id) {\n            this.#menu_id_to_element[menu_id] = element;\n        }\n\n        // wait to add to parent until everything else happens without error\n        if (parent) {\n            parent.appendChild(element);\n        }\n\n        return element;\n    }\n\n    #build_menuitem(label, toplevel=false) {\n        // both items and collections are menuitem elements, but the collection also has children...\n        const id = generate_object_id();\n        const menuitem = create_element({\n            tag: this.constructor.menuitem_element_tag_name,\n            attrs: {\n                id,\n                class: 'menuitem',\n            },\n        });\n\n        // add the label\n        create_element({\n            parent: menuitem,\n            attrs: {\n                class: 'menuitem-label',\n            },\n        }).innerText = label;\n\n        menuitem.addEventListener('mousemove', (event) => {\n            // don't pop open top-level menus unless one is already selected\n            // this means that the user must click the top-level menu to get things started\n            if (!toplevel || this.#menubar_container.querySelector('.selected')) {\n                if (!menuitem.classList.contains('disabled')) {\n                    this.#select_menuitem(menuitem);\n                }\n            }\n        });\n        return menuitem;\n    }\n    #add_item_menuitem_annotations_and_click_handler(menuitem, command) {\n        if (command) {\n            const command_bindings = this.get_command_bindings();\n            const kbd_bindings = command_bindings[command];\n            if (kbd_bindings) {\n                const kbd_container = create_element({\n                    parent: menuitem,\n                    attrs: {\n                        class: 'menuitem-annotation',\n                    },\n                });\n                // create <kbd>...</kbd> elements\n                kbd_bindings.forEach(binding => {\n                    const binding_glyphs = new KeySpec(binding).glyphs;\n                    create_element({ parent: kbd_container, tag: 'kbd' }).innerText = binding_glyphs;\n                });\n            }\n        }\n\n        menuitem.addEventListener('click', (event) => {\n            this.#deactivate_menu(menuitem.closest('.menubar'));\n            const command_context = { command, event, target: event.target };\n            this.commands.dispatch(command_context);\n            event.stopPropagation();\n            event.preventDefault();\n        });\n    }\n\n    #build_menubar(parent, menubar_spec) {\n        const menubar_container = create_element({\n            parent,\n            tag: this.constructor.menu_element_tag_name,\n            attrs: {\n                class:    'active menubar',\n                role:     'navigation',\n                tabindex: 0,\n            },\n            before: parent.firstChild,  // prepend\n        });\n        menubar_spec.forEach(spec => this.#build_menu(spec, menubar_container, true));\n\n        // add event listener to close menu when focus is lost\n        menubar_container.addEventListener('blur', (event) => {\n            this.#deactivate_menu(menubar_container);\n        });\n\n        // add keyboard navigation event listener\n        menubar_container.addEventListener('keydown', (event) => {\n            const selected_elements = menubar_container.querySelectorAll('.selected');\n            if (selected_elements.length <= 0) {\n                if (! ['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Enter', ' '].includes(event.key)) {\n                    return;  // do not handle or alter propagation\n                } else {\n                    // select the first menuitem of the menubar\n                    const menubar_first_menuitem = menubar_container.querySelector('.menuitem');\n                    if (menubar_first_menuitem) {\n                        this.#select_menuitem(menubar_first_menuitem);\n                    }\n                }\n            } else {\n                const menuitem = selected_elements[selected_elements.length-1];\n\n                const is_in_menubar = (menuitem.parentElement === menubar_container);\n\n                let key_menu_prev, key_menu_next, key_cross_prev, key_cross_next;\n                if (is_in_menubar) {\n                    key_menu_prev  = 'ArrowLeft';\n                    key_menu_next  = 'ArrowRight';\n                    key_cross_prev = 'ArrowUp';\n                    key_cross_next = 'ArrowDown';\n                } else {\n                    key_menu_prev  = 'ArrowUp';\n                    key_menu_next  = 'ArrowDown';\n                    key_cross_prev = 'ArrowLeft';\n                    key_cross_next = 'ArrowRight';\n                }\n\n                switch (event.key) {\n                case 'Enter':\n                case ' ': {\n                    menuitem.click();\n                    break;\n                }\n                case 'Escape': {\n                    this.#deactivate_menu(menubar_container);\n                    break;\n                }\n                case key_menu_prev: {\n                    const mi = this.constructor.find_previous_menuitem(menuitem);\n                    if (mi) {\n                        this.#select_menuitem(mi);\n                    } else if (!is_in_menubar) {\n                        menuitem.classList.remove('selected');  // parent menuitem will still be selected\n                    }\n                    break;\n                }\n                case key_menu_next: {\n                    const mi = this.constructor.find_next_menuitem(menuitem);\n                    if (mi) {\n                        this.#select_menuitem(mi);\n                    }\n                    break;\n                }\n                case key_cross_prev: {\n                    if (!is_in_menubar) {\n                        const menubar_menuitem = menubar_container.querySelector('.menuitem.selected');\n                        const mbi = this.constructor.find_previous_menuitem(menubar_menuitem);\n                        if (mbi) {\n                            this.#select_menuitem(mbi);\n                        }\n                    }\n                    break;\n                }\n                case key_cross_next: {\n                    let navigated_into_collection = false;\n                    if (menuitem.classList.contains('collection')) {\n                        // enter collection if possible\n                        const mi = menuitem.querySelector('.menuitem:not(.disabled)');\n                        if (mi) {\n                            this.#select_menuitem(mi);\n                            navigated_into_collection = true;\n                        }\n                    }\n                    if (!navigated_into_collection && !is_in_menubar) {\n                        const menubar_menuitem = menubar_container.querySelector('.menuitem.selected');\n                        const mbi = this.constructor.find_next_menuitem(menubar_menuitem);\n                        if (mbi) {\n                            this.#select_menuitem(mbi);\n                        }\n                    }\n                    break;\n                }\n\n                default:\n                    return;  // do not handle or alter propagation\n                }\n            }\n\n            // if we get here, assume the event was handled and therefore\n            // we should stop propagation and prevent default action.\n            event.stopPropagation();\n            event.preventDefault();\n        }, {\n            capture: true,\n        });\n\n        return menubar_container;\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nconst assets_server_script = document.querySelector('script');\nif (!assets_server_script || !assets_server_script.src) {\n    throw new Error('no script for assets server found in document');\n}\nconst assets_server_root = new URL('..', assets_server_script.src);  // assumes script src points to is one directory level below the server root\nconst local_server_root  = new URL('..', current_script_url);        // assumes this script is located one directory level below server root\n\n\nexport function assets_server_url(local_url) {\n    if (typeof local_url === 'string') {\n        local_url = new URL(local_url);\n    }\n    if (!(local_url instanceof URL)) {\n        throw new Error('local_url must be a string or an instance of URL');\n    }\n\n    if ( local_url.protocol !== 'file:' ||\n         local_server_root.protocol !== 'file:' ||\n         assets_server_root.protocol === 'file:' ||\n         !local_url.href.startsWith(local_server_root.href) ) {\n        return local_url;  // nothing to do...\n    } else {\n        const relative = local_url.href.slice(local_server_root.href.length);\n        return new URL(assets_server_root.href + relative);\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    manage_selection_for_insert,\n    manage_selection_for_delete,\n    insert_at,\n    delete_nearest_leaf,\n    validate_parent_and_before_from_options,\n    create_element,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    logbook_manager,\n} from '../logbook-manager.js';\n\nimport {\n    EventListenerManager,\n} from '../../lib/sys/event-listener-manager.js';\n\nimport {\n    KeyEventManager,\n    KeyMap,\n} from '../../lib/ui/key/_.js';\n\nimport {\n    ChangeManager,\n} from '../../lib/ui/change-manager.js';\n\nimport {\n    ToolBarElement,\n} from '../tool-bar-element/_.js';\n\nimport {\n    beep,\n} from '../../lib/ui/beep.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n// import {\n//     create_stylesheet_link,\n// } from '../../lib/ui/dom-util.js';\n// create_stylesheet_link(document.head, new URL('./style.css', assets_server_url(current_script_url)));\nimport './style.css';  // webpack implementation\n\n\nexport class EditorCellElement extends HTMLElement {\n    static custom_element_name = 'editor-cell';\n\n    static attribute__active  = 'data-active';\n    static attribute__visible = 'data-visible';\n\n    constructor() {\n        super();\n        this.#event_listener_manager = new EventListenerManager();\n\n        this.#key_event_manager = new KeyEventManager(this, this.#command_observer.bind(this));\n        this.#command_bindings  = this.get_command_bindings();\n\n        const key_map = new KeyMap(this.constructor.get_initial_key_map_bindings(), this.constructor.key_map_insert_self_recognizer);\n        this.push_key_map(key_map);\n\n        // _tool_bar is used instead of #tool_bar so that subclasses have access (see establish_tool_bar())\n        this._tool_bar = null;\n    }\n    #event_listener_manager;\n    #key_event_manager;\n    #command_bindings;\n\n\n    // === EDITABLE ===\n\n    get editable (){\n        if (!this.hasAttribute('contenteditable')) {\n            return false;\n        } else {\n            const contenteditable_value = this.getAttribute('contenteditable');\n            return (contenteditable_value !== false.toString());\n        }\n    }\n\n    set_editable(editable) {\n        if (editable) {\n            this.setAttribute('contenteditable', true.toString());\n        } else {\n            this.removeAttribute('contenteditable');\n        }\n    }\n\n\n    // === KEY MAP STACK ===\n\n    reset_key_map_stack() {\n        this.#key_event_manager.reset_key_map_stack();\n    }\n    push_key_map(key_map) {\n        this.#key_event_manager.push_key_map(key_map);\n    }\n    pop_key_map() {\n        return this.#key_event_manager.pop_key_map();\n    }\n    remove_key_map(key_map, remove_subsequent_too=false) {\n        return this.#key_event_manager.remove_key_map(key_map, remove_subsequent_too);\n    }\n\n    static key_map_insert_self_recognizer(key_spec) {\n        return (key_spec.is_printable ? 'insert-self' : false);\n    }\n\n\n    // === TOOL BAR ===\n\n    establish_tool_bar() {\n        if (!this._tool_bar) {\n            this._tool_bar = ToolBarElement.create_for(this, {\n                editable: false,\n                visible:  { initial: this.visible,  on: (event) => this.set_visible(!this.visible) },\n                autoeval: false,\n                modified: true,\n            });\n            this.parentElement.insertBefore(this._tool_bar, this);\n        }\n    }\n\n    remove_tool_bar() {\n        if (this._tool_bar) {\n            this._tool_bar.remove();\n            this._tool_bar = undefined;\n        }\n    }\n\n\n    // === DOM ===\n\n    /** return the first and last elements in the DOM that are associated with this editor-cell\n     *  @return {Object|null} null if this is not in the DOM body, otherwise { first: Element, last: Element }\n     */\n    get_dom_extent() {\n        if (document.body === this || !document.body?.contains(this)) {\n            return null;  // indicate: not in DOM body\n        } else {\n            let first = this,\n                last  = this;\n            if (this._tool_bar) {\n                if (first.compareDocumentPosition(this._tool_bar) & Node.DOCUMENT_POSITION_PRECEDING) {\n                    first = this._tool_bar;\n                }\n                if (last.compareDocumentPosition(this._tool_bar) & Node.DOCUMENT_POSITION_FOLLOWING) {\n                    last = this._tool_bar;\n                }\n            }\n            return { first, last };\n        }\n    }\n\n    /** create a new EditorCellElement instance with standard settings\n     *  @param {null|undefined|Object} options: {\n     *      parent?:   Node,     // default: document.body\n     *      before?:   Node,     // default: null\n     *      editable:  Boolean,  // set contenteditable?  default: current logbook editable setting\n     *      innerText: String,   // cell.innerText to set\n     *  }\n     *  @return {EditorCellElement} new cell\n     */\n    static create_cell(options=null) {\n        const {\n            parent   = document.body,\n            before   = null,\n            editable = logbook_manager.editable,\n            innerText,\n        } = (options ?? {});\n\n        const cell = create_element({\n            parent,\n            before,\n            tag: this.custom_element_name,\n            attrs: {\n                tabindex: 0,  // permit focus\n            },\n        });\n        cell.set_editable(editable);\n\n        if (innerText) {\n            cell.innerText = innerText;\n        }\n\n        cell.establish_tool_bar();\n\n        return cell;\n    }\n\n    /** return the next cell in the document with this.tagName, or null if none\n     *  @param {Boolean} forward (default false) if true, return the next cell, otherwise previous\n     *  @return {null|Element} the adjacent cell, or null if not found\n     */\n    adjacent_cell(forward=false) {\n        // note that this.tagName is a selector for elements with that tag name\n        const cells = [ ...document.querySelectorAll(this.tagName) ];\n        const index = cells.indexOf(this);\n        if (index === -1) {\n            return null\n        } else {\n            if (forward) {\n                if (index >= cells.length-1) {\n                    return null;\n                } else {\n                    return cells[index+1];\n                }\n            } else {\n                if (index <= 0) {\n                    return null;\n                } else {\n                    return cells[index-1];\n                }\n            }\n        }\n    }\n\n    /** move (or remove) this cell within the DOM\n     *  @param {null|undefined|Object} options: {\n     *      parent?: Node,  // default: null  // new parent, or null/undefined to remove\n     *      before?: Node,  // default: null  // new before node\n     *  }\n     */\n    move_cell(options=null) {\n        const { parent, before } = validate_parent_and_before_from_options(options);\n        if (!parent) {\n            if (this.parentNode) {\n                this.remove_cell();\n            }\n        } else {\n            const had_tool_bar = !!this._tool_bar;\n            this.remove_tool_bar();\n            parent.insertBefore(this, before);\n            if (had_tool_bar) {\n                this.establish_tool_bar();\n            }\n        }\n    }\n\n    /** remove this cell from the DOM\n     */\n    remove_cell() {\n        this.remove_tool_bar();\n        this.remove();\n    }\n\n    /** reset the cell; this base class version does nothing\n     *  @return {EvalCellElement} this\n     */\n    reset() {\n        return this;\n    }\n\n\n    // === COMMAND HANDLER INTERFACE ===\n\n    /** return the initial key map bindings\n     *  @return {Object} mapping from command strings to arrays of triggering key sequences\n     */\n    static get_initial_key_map_bindings() {\n        return {\n            ...logbook_manager.constructor.get_global_initial_key_map_bindings(),\n\n//!!!            'insert-line-break':   [ 'Enter' ],\n\n//!!!            'delete-forward':      [ 'Delete' ],\n//!!!            'delete-reverse':      [ 'Backspace' ],\n//!!!            'delete-text-forward': [ 'Alt-Delete' ],\n//!!!            'delete-text-reverse': [ 'Alt-Backspace' ],\n\n//!!!            'cut':                 [ 'CmdOrCtrl-X' ],\n//!!!            'copy':                [ 'CmdOrCtrl-C' ],\n//!!!            'paste':               [ 'CmdOrCtrl-V' ],\n        };\n    }\n\n    /** return command bindings for this cell\n     *  @return {Object} mapping from command strings to functions implementing that command\n     * The bindings are obtained by merging local command bindings with logbook_manager\n     * command bindings.\n     */\n    get_command_bindings() {\n        const command_bindings = {\n            ...logbook_manager.get_global_command_bindings(),\n\n            'insert-self':         this.command_handler__insert_self.bind(this),\n            'insert-line-break':   this.command_handler__insert_line_break.bind(this),\n\n            'delete-text-forward': this.create_command_handler___delete({ element_too: false, reverse: false }),\n            'delete-text-reverse': this.create_command_handler___delete({ element_too: false, reverse: true  }),\n            'delete-forward':      this.create_command_handler___delete({ element_too: true,  reverse: false }),\n            'delete-reverse':      this.create_command_handler___delete({ element_too: true,  reverse: true  }),\n\n            'cut':                 this.command_handler__cut.bind(this),\n            'copy':                this.command_handler__copy.bind(this),\n            'paste':               this.command_handler__paste.bind(this),\n\n            'reset-cell':          this.command_handler__reset_cell.bind(this),\n\n            'toggle-cell-visible': this.command_handler__toggle_visible.bind(this),\n        };\n\n        return command_bindings;\n    }\n\n    #command_observer(command_context) {\n        try {\n            const success = this.perform_command(command_context);\n            if (!success) {\n                beep();\n            }\n        } catch (error) {\n            console.error('error processing command', command_context, error);\n            beep();\n        }\n    }\n\n    perform_command(command_context) {\n        if (!command_context) {\n            return false;  // indicate: command not handled\n        } else {\n            const target = command_context.target;\n            if (!target || !this.contains(target)) {\n                return false;  // indicate: command not handled\n            } else {\n                const bindings_fn = this.#command_bindings[command_context.command];\n                if (!bindings_fn) {\n                    return false;  // indicate: command not handled\n                } else {\n                    return bindings_fn(command_context);\n                }\n            }\n        }\n    }\n\n    // === COMMAND HANDLERS ===\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__insert_self(command_context) {\n        const key_spec = command_context.key_spec;\n        const text = key_spec?.key ?? key_spec?.canonical ?? '';\n        if (!text) {\n            return false;\n        } else {\n            return manage_selection_for_insert(\n                (point) => insert_at(point, text)\n            );\n        }\n    }\n\n    command_handler__insert_line_break(command_context) {\n        return manage_selection_for_insert(\n//            (point) => insert_at(point, document.createElement('br'))\n            (point) => insert_at(point, '\\n')\n        );\n    }\n\n    create_command_handler___delete(options) {\n        return (command_context) => {\n            return manage_selection_for_delete(\n                (point) => delete_nearest_leaf(point, options)\n            );\n        };\n    }\n\n    command_handler__cut(command_context) {\n        document.execCommand('cut');  // updates selection\n        return true;\n    }\n\n    command_handler__copy(command_context) {\n        document.execCommand('copy');  // updates selection\n        return true;\n    }\n\n    async command_handler__paste(command_context) {\n        //!!! THIS NO LONGER WORKS: return document.execCommand('paste');  // updates selection\n        //!!! Also, the following does not work on Firefox:\n        const text = await navigator.clipboard.readText();\n        if (!text) {\n            return false;\n        } else {\n            return manage_selection_for_insert(\n                (point) => insert_at(point, text)\n            );\n        }\n    }\n\n    command_handler__reset_cell(command_context) {\n        this.reset();\n        return true;\n    }\n\n    command_handler__toggle_visible(command_context) {\n        this.set_visible(!this.visible);\n        return true;\n    }\n\n\n    // === ATTRIBUTES ===\n\n    get active (){ return !!this.hasAttribute(this.constructor.attribute__active); }\n    set_active(state=false) {\n        if (state) {\n            this.setAttribute(this.constructor.attribute__active, true);\n        } else {\n            this.removeAttribute(this.constructor.attribute__active);\n        }\n    }\n\n    get visible (){ return !!this.hasAttribute(this.constructor.attribute__visible); }\n    set_visible(state=false) {\n        state = !!state;\n        this._tool_bar.set_for('visible', state);\n        if (state) {\n            this.setAttribute(this.constructor.attribute__visible, true);\n        } else {\n            this.removeAttribute(this.constructor.attribute__visible);\n        }\n    }\n\n\n    // === FOCUS HANDLERS / ACTIVE ===\n\n    #connect_focus_listeners() {\n        if (this.#event_listener_manager.empty()) {\n            function focus_handler(event) {\n                // logbook_manager.set_active_cell() clears/sets the \"active\" attributes of cells\n                logbook_manager.set_active_cell(this);\n            }\n            const listener_specs = [\n                [ this, 'focus', focus_handler, { capture: true } ],\n            ];\n            for (const [ target, type, listener, options ] of listener_specs) {\n                this.#event_listener_manager.add(target, type, listener, options);\n            }\n        }\n    }\n\n    #disconnect_focus_listeners() {\n        this.#event_listener_manager.remove_all();\n    }\n\n\n    // === WEB COMPONENT LIFECYCLE ===\n\n    // connectedCallback:\n    //     Invoked each time the custom element is appended into a document-connected element.\n    //     This will happen each time the node is moved, and may happen before the element's contents have been fully parsed.\n    //     Note: connectedCallback may be called once your element is no longer connected, use Node.isConnected to make sure.\n    connectedCallback() {\n        this.#connect_focus_listeners();\n        this.#key_event_manager.attach();\n    }\n\n    // disconnectedCallback:\n    //     Invoked each time the custom element is disconnected from the document's DOM.\n    disconnectedCallback() {\n        this.#disconnect_focus_listeners();\n        this.#key_event_manager.detach();\n    }\n\n    // adoptedCallback:\n    //     Invoked each time the custom element is moved to a new document.\n    adoptedCallback() {\n        this.#connect_focus_listeners();\n        this.#key_event_manager.attach();\n    }\n\n    // attributeChangedCallback:\n    //     Invoked each time one of the custom element's attributes is added, removed, or changed.\n    //     Which attributes to notice change for is specified in a static get observedAttributes method\n    attributeChangedCallback(name, old_value, new_value) {\n        switch (name) {\n        case 'xyzzy': {\n            //!!!\n            break;\n        }\n        }\n        //!!!\n    }\n\n    static get observedAttributes() {\n        return [\n            'xyzzy',//!!!\n        ];\n    }\n\n\n    // === INTERNAL ===\n\n    // Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\n    static _init_static() {\n        globalThis.customElements.define(this.custom_element_name, this);\n    }\n}\n\n// Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\nEditorCellElement._init_static();\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    create_element,\n    clear_element,\n    validate_parent_and_before_from_options,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    logbook_manager,\n} from '../logbook-manager.js';\n\nimport {\n    EditorCellElement,\n} from '../editor-cell-element/_.js';\n\nimport {\n    Evaluator,\n} from '../evaluator/_.js';\n\nimport {\n    Stoppable,\n} from '../../lib/sys/stoppable.js';\n\nimport {\n    ToolBarElement,\n} from '../tool-bar-element/_.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n// import {\n//     create_stylesheet_link,\n// } from '../../lib/ui/dom-util.js';\n// create_stylesheet_link(document.head, new URL('./style.css', assets_server_url(current_script_url)));\nimport './style.css';  // webpack implementation\n\n\nexport class EvalCellElement extends EditorCellElement {\n    static custom_element_name = 'eval-cell';\n\n    static #attribute__input_type        = 'data-input-type';\n    static #attribute__output_element_id = 'data-output-element-id';\n\n    get input_type (){ return this.getAttribute(this.constructor.#attribute__input_type); }\n    set input_type (input_type){\n        this.setAttribute(this.constructor.#attribute__input_type, input_type);\n        this._tool_bar?.set_type(input_type);\n        return input_type;\n    }\n\n\n    constructor() {\n        super();\n        // create a single bound handler function so that\n        // we have a consistent handler function for add\n        // and remove\n        this.#output_element_pointerdown_handler_bound = this.#output_element_pointerdown_handler.bind(this);\n    }\n\n\n    // === OUTPUT ELEMENT ===\n\n    // CSS class for output elements created by establish_output_element()\n    static get output_element_class (){ return 'eval-cell-output'; }\n\n    get output_element_id (){\n        return this.getAttribute(this.constructor.#attribute__output_element_id);\n    }\n\n    set output_element_id (id){\n        if (id === null || typeof id === 'undefined' || id === '') {\n            this.setAttribute(this.constructor.#attribute__output_element_id, '');\n        } else {\n            const element = document.getElementById(id);\n            if (!element) {\n                throw new Error('element with specified id does not exist');\n            }\n            if (!(element instanceof HTMLElement)) {\n                throw new Error('element specified by id must be an instance of HTMLElement');\n            }\n            this.setAttribute(this.constructor.#attribute__output_element_id, id);\n        }\n        return id;\n    }\n\n    get output_element (){\n        const oid = this.output_element_id;\n        if (!oid) {\n            return null;\n        } else {\n            const element = document.getElementById(oid);\n            if (!element || !(element instanceof HTMLElement)) {\n                console.warn('bad configuration of EvalCellElement: id does not specify an HTMLElement');\n                return null;\n            } else {\n                return element;\n            }\n        }\n    }\n\n    set output_element (element){\n        element ??= null;\n        if (element && (!element.id || !(element instanceof HTMLElement))) {\n            throw new Error('element must be null, undefined, or an instance of HTMLElement with an id');\n        }\n\n        // remove handler from old output_element and add handler to new output_element\n        const current_output_element = this.output_element;\n        if (current_output_element !== element) {\n            if (current_output_element) {\n                current_output_element.removeEventListener('pointerdown', this.#output_element_pointerdown_handler_bound);\n            }\n            if (element) {\n                element.addEventListener('pointerdown', this.#output_element_pointerdown_handler_bound);\n            }\n        }\n\n        this.output_element_id = element ? element.id : null;\n        return element;\n    }\n\n    /** create an output element, if necessary, and set its standard attributes\n     *  @return {HTMLElement} output element;\n     */\n    establish_output_element() {\n        let output_element = this.output_element;\n        if (!output_element) {\n            const dom_extent = this.get_dom_extent();\n            const before = dom_extent ? dom_extent.last.nextSibling : this.nextSibling;\n            const parent = before?.parentElement ?? this.parentElement;\n            output_element = create_element({ parent, before });\n            this.output_element = output_element;\n        }\n        output_element.classList.add(this.constructor.output_element_class);\n        return output_element;\n    }\n\n    /** remove the output_element, if any, from this eval-cell and from the DOM\n     *  @return {EvalCellElement} this\n     */\n    remove_output_element() {\n        const output_element = this.output_element;\n        if (output_element) {\n            this.output_element = null;\n            output_element.remove();\n        }\n        return this;\n    }\n\n    #output_element_pointerdown_handler(event) {\n        if (!this.contains(document.activeElement)) {\n            this.focus();\n            event.preventDefault();\n            event.stopPropagation();\n        }\n    }\n    #output_element_pointerdown_handler_bound;  // initialized in constructor\n\n    // === OUTPUT ELEMENT AWARE OVERRIDES ===\n\n    /** move (or remove) this cell within the DOM\n     *  @param {null|undefined|Object} options: {\n     *      parent?: Node,  // default: null  // new parent, or null/undefined to remove\n     *      before?: Node,  // default: null  // new before node\n     *  }\n     */\n    move_cell(options=null) {\n        const { parent, before } = validate_parent_and_before_from_options(options);\n        const output_element = this.output_element;\n        const output_element_precedes = output_element && !!(this.compareDocumentPosition(output_element) & Node.DOCUMENT_POSITION_PRECEDING);\n        super.move_cell(options);\n        // if !parent, then cell and output_element will have  been removed\n        if (parent && output_element) {\n            const element_after_output = output_element_precedes ? this : before;\n            parent.insertBefore(output_element, element_after_output);\n        }\n    }\n\n    /** override of EditorCellElement.remove_cell().\n     *  remove this cell and its output_element, if any, from the DOM\n     */\n    remove_cell() {\n        this.remove_output_element();\n        super.remove_cell();\n    }\n\n    /** reset the cell; clear the output_element, if any\n     *  @return {EvalCellElement} this\n     */\n    reset() {\n        super.reset();\n        const output_element = this.output_element;\n        if (output_element) {\n            clear_element(output_element);\n        }\n        return this;\n    }\n\n    // === EVAL ===\n\n    /** evaluate the contents of this element\n     *  @param {null|undefined|Object} options: {\n     *      evaluator_class?: Evaluator,    // evaluator class to use\n     *      output_element?:  HTMLElement,  // output_element for eval(); if given, will be set as this.output_element\n     *      eval_context?:    Object,       // default: a new {}; will be \"this\" during expression evaluation.\n     *  }\n     *  @return {Promise} promise returned by evaluator_class eval method\n     * If evaluator_class is not given, then Evaluator.class_for_content() is called to get one.\n     */\n    async eval(options=null) {  // options: { evaluator_class?, output_element?, eval_context? }\n        const {\n            evaluator_class: evaluator_class_from_options,\n            output_element:  output_element_from_options,\n            eval_context,\n        } = (options ?? {});\n\n        const evaluator_class = evaluator_class_from_options ?? Evaluator.class_for_content(this);\n\n        if (!(evaluator_class === Evaluator || evaluator_class.prototype instanceof Evaluator)) {\n            throw new Error('evaluator_class must be an instance of Evaluator');\n        }\n\n        // stop current evaluator, if any\n        this.stop();  // clears this.#evaluator_stoppable\n\n        let output_element;\n        if (output_element_from_options) {\n            output_element = output_element_from_options;\n            this.output_element = output_element;\n        } else {\n            output_element = this.establish_output_element();\n        }\n        clear_element(output_element);\n\n        // allocate the evaluator, store it, then eval\n        const evaluator = new evaluator_class(this, output_element, eval_context);\n\n        this.#evaluator_stoppable = new Stoppable(evaluator);  // already cleared by this.stop() above\n        this.#evaluator_foreground = true;\n        this._tool_bar?.set_for('running', true);\n        logbook_manager.emit_eval_state(this, true);\n\n        return evaluator._perform_eval()\n            .then(() => {\n                this.#evaluator_foreground = undefined;\n                this._tool_bar?.set_for('running', false);\n                logbook_manager.emit_eval_state(this, false);\n            })\n            .catch(error => {\n                this.stop();  // stop anything that may have been started\n                return evaluator.output_context.invoke_renderer_for_type('error', error);\n            });\n    }\n    #evaluator_foreground;  // true iff evaluating and before return\n    #evaluator_stoppable;\n\n    /** @return true iff an evaluation is running and has not yet returned\n     */\n    get evaluator_foreground (){ return !!this.#evaluator_foreground; }\n\n    /** @return true iff an evaluation has run and returned (but may still have pending asynchonous evaluations)\n     */\n    get can_stop (){ return !!this.#evaluator_stoppable; }\n\n    stop() {\n        if (this.#evaluator_stoppable) {\n            try {\n                this.#evaluator_stoppable.stop();\n            } catch (error) {\n                console.warn('error stopping evaluator', error, this.#evaluator_stoppable);\n                // continue...\n            }\n        }\n        this.#evaluator_stoppable  = undefined;\n        this.#evaluator_foreground = undefined;\n        this._tool_bar?.set_for('running', false);\n        logbook_manager.emit_eval_state(this, false);\n    }\n\n    establish_tool_bar() {  // override of EditorCellElement.establish_tool_bar()\n        if (!this._tool_bar) {\n            let initial_type = this.input_type || undefined;\n            this._tool_bar = ToolBarElement.create_for(this, {\n                editable: false,\n                visible:  { initial: this.visible,  on: (event) => this.set_visible(event.target.get_state()) },\n                autoeval: false,\n                type:     { ...(initial_type ? { initial: initial_type } : {}),  on: (event) => { this.input_type = event.target.value } },//!!!\n                running:  true,\n                modified: false,\n                run:      false,\n            });\n            this.parentElement.insertBefore(this._tool_bar, this);\n        }\n    }\n\n    // === DOM ===\n\n    /** return the first and last elements in the DOM that are associated with this eval-cell\n     *  @return {Object|null} null if this is not in the DOM body, otherwise { first: Element, last: Element }\n     */\n    get_dom_extent() {\n        if (document.body === this || !document.body?.contains(this)) {\n            return null;  // indicate: not in DOM body\n        } else {\n            let { first, last } = super.get_dom_extent();\n            const output_element = this.output_element;\n            if (output_element) {\n                if (first.compareDocumentPosition(output_element) & Node.DOCUMENT_POSITION_PRECEDING) {\n                    first = output_element;\n                }\n                if (last.compareDocumentPosition(output_element) & Node.DOCUMENT_POSITION_FOLLOWING) {\n                    last = output_element;\n                }\n            }\n            return { first, last };\n        }\n    }\n\n\n    // === COMMAND HANDLER INTERFACE ===\n\n    /** return the initial key map bindings\n     *  @return {Object} mapping from command strings to arrays of triggering key sequences\n     */\n    static get_initial_key_map_bindings() {\n        const key_map_bindings = super.get_initial_key_map_bindings();\n        return {\n            ...key_map_bindings,\n\n            'eval': [ 'CmdOrCtrl-Enter' ],\n        };\n    }\n\n    /** return command bindings for this cell\n     *  @return {Object} mapping from command strings to functions implementing that command\n     */\n    get_command_bindings() {\n        const command_bindings = super.get_command_bindings();\n        return {\n            ...command_bindings,\n\n            'eval':                this.command_handler__eval.bind(this),\n\n            'set-mode-markdown':   this.command_handler__set_mode_markdown.bind(this),\n            'set-mode-tex':        this.command_handler__set_mode_tex.bind(this),\n            'set-mode-javascript': this.command_handler__set_mode_javascript.bind(this),\n        };\n    }\n\n\n    // === COMMAND HANDLERS ===\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    async command_handler__eval(command_context) {\n        await this.eval({\n            eval_context: logbook_manager.global_eval_context,\n        });\n        return true;\n    }\n\n    command_handler__set_mode_markdown(command_context) {\n        this.input_type = 'markdown';\n        return true;\n    }\n    command_handler__set_mode_tex(command_context) {\n        this.input_type = 'tex';\n        return true;\n    }\n    command_handler__set_mode_javascript(command_context) {\n        this.input_type = 'javascript';\n        return true;\n    }\n\n\n    // === INTERNAL ===\n\n    // Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\n    static _init_static() {\n        // Error when using the \"extends\" property on Chromium 112.0.5615.49:\n        //     caught DOMException: Failed to execute 'define' on 'CustomElementRegistry': \"eval-cell\" is a valid custom element name at EvalCellElement._init_static\n        // This is probably correct.  The documentation for customElements.define() states:\n        //     extends: String specifying the name of a built-in element to extend.\n        // built-in element, not custom element\n        const options = {\n            //!!! extends: EditorCellElement.custom_element_name,\n        };\n        globalThis.customElements.define(this.custom_element_name, this, options);\n    }\n}\n\n// Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\nEvalCellElement._init_static();\n","// Evaluator is defined in a separate file to break dependency cycle in get_evaluator_classes()\nexport {\n    Evaluator,\n} from './evaluator.js';\n\nimport { MarkdownEvaluator   } from './markdown-evaluator.js';\nimport { TeXEvaluator        } from './tex-evaluator.js';\nimport { JavaScriptEvaluator } from './javascript-evaluator.js';\n\n/** return an array of all known evaluator classes, with the first entry being considered as the \"default\"\n *  @return {String[]} array of evaluator classes\n */\nexport function get_evaluator_classes() {\n    return [\n        MarkdownEvaluator,  // first entry is the default\n        TeXEvaluator,\n        JavaScriptEvaluator,\n    ];\n}\n","import {\n    generate_uuid,\n} from '../../lib/sys/uuid.js';\n\nimport {\n    StoppableObjectsManager,\n} from '../../lib/sys/stoppable.js';\n\nimport {\n    OutputContext,\n} from '../output-context.js';\n\nimport {\n    get_evaluator_classes,\n} from './_.js';\n\n\nexport class Evaluator extends StoppableObjectsManager {\n    /** Call this function instead of constructing an instance with new.\n     *  @param {HTMLElement} input_element the source element\n     *  @param {HTMLElement} output_element the destination element\n     *  @param {undefined|null|Object} eval_context, default {}\n     *  @return {Promise} resolves to the new instance after its\n     *          _perform_eval method resolves.  Note that the return\n     *          of the _perform_eval method does not necessarily mean\n     *          that the evaluation is \"done\".\n     * If an object is passed as eval_context, then that object may be modified\n     * as a result of the evaluation.  This is the basis for persistence of\n     * state across evaluations.\n     */\n    static async eval(input_element, output_element, eval_context=null) {\n        const instance = new this(input_element, output_element, eval_context);\n        return instance._perform_eval()\n            .catch(error => instance.output_context.invoke_renderer_for_type('error', error));\n    }\n\n    // do not call the constructor via new, instead use the static async method Evaluator.eval()\n    constructor(input_element, output_element, eval_context) {\n        super();\n        if (!(input_element instanceof HTMLElement)) {\n            throw new Error('input_element must be an instance of HTMLElement');\n        }\n        if (!(output_element instanceof HTMLElement)) {\n            throw new Error('output_element must be an instance of HTMLElement');\n        }\n\n        eval_context ??= {};\n        if (typeof eval_context !== 'object') {\n            throw new Error('eval_context must be undefined, null, or an object');\n        }\n\n        const output_context = new OutputContext(output_element);\n\n        Object.defineProperties(this, {\n            id: {\n                value: generate_uuid(),\n                enumerable: true,\n            },\n            input_element: {\n                value: input_element,\n                enumerable: true,\n            },\n            output_element: {\n                value: output_element,\n                enumerable: true,\n            },\n            eval_context: {\n                value: eval_context,\n                enumerable: true,\n            },\n            output_context: {\n                value: output_context,\n                enumerable: true,\n            },\n        });\n    }\n\n    async _perform_eval() {\n        // to be implemented by subclasses\n        // exceptions thrown out of this function will be handled in this.constructor.eval()\n        throw new Error('NOT UNIMPLEMENTED');\n    }\n\n\n    // === RECOGNIZER ===\n\n    /** array of input_type strings for input types handled by this evaluator\n     *  must be overridden in subclasses\n     */\n    static handled_input_types = [];\n\n    /** return an evauluator class for a given input_element\n     *  @param {Element} input_element\n     *  @return {Class} evaluator class\n     */\n    static class_for_content(input_element) {\n        if (!(input_element instanceof Element)) {\n            throw new Error('input_element must be an instance of Element');\n        }\n\n        const evaluator_classes = get_evaluator_classes();\n\n        const default_evaluator_class = evaluator_classes[0];\n\n        // check if there is an evaluator that handles the input_element input_type\n        const input_type = input_element.input_type;\n        if (input_type) {\n            // use the first evaluator that handles a specifically-set\n            // input_type on the input_element\n            for (const evaluator_class of evaluator_classes) {\n                if (evaluator_class.handled_input_types.includes(input_type)) {\n                    return evaluator_class;\n                }\n            }\n        }\n\n        return default_evaluator_class;\n    }\n}\n","import {\n    Evaluator,\n} from './evaluator.js';\n\nimport {\n    Stoppable,\n} from '../../lib/sys/stoppable.js';\n\n\nexport class JavaScriptEvaluator extends Evaluator {\n    static handled_input_types = [\n        'javascript',\n    ];\n\n    async _perform_eval() {\n        const options = {\n            style:  undefined,//!!!\n            eval_context: this.eval_context,\n        };\n        const renderer = this.output_context.renderer_for_type('javascript');\n        this.add_stoppable(new Stoppable(renderer));\n        return this.output_context.invoke_renderer(renderer, this.input_element.innerText, options);\n    }\n}\n","import {\n    Evaluator,\n} from './evaluator.js';\n\nimport {\n    Stoppable,\n} from '../../lib/sys/stoppable.js';\n\n\nexport class MarkdownEvaluator extends Evaluator {\n    static handled_input_types = [\n        'markdown',\n    ];\n\n    async _perform_eval() {\n        const options = {\n            //!!!\n        };\n        const renderer = this.output_context.renderer_for_type('markdown');\n        this.add_stoppable(new Stoppable(renderer));\n        return this.output_context.invoke_renderer(renderer, this.input_element.innerText, options);\n    }\n}\n","import {\n    Evaluator,\n} from './evaluator.js';\n\nimport {\n    Stoppable,\n} from '../../lib/sys/stoppable.js';\n\n\nexport class TeXEvaluator extends Evaluator {\n    static handled_input_types = [\n        'tex',\n    ];\n\n    async _perform_eval() {\n        const options = {\n            style:  undefined,//!!!\n            inline: false,//!!!\n            rtl:    false,//!!!\n        };\n        const renderer = this.output_context.renderer_for_type('tex');\n        this.add_stoppable(new Stoppable(renderer));\n        return this.output_context.invoke_renderer(renderer, this.input_element.innerText, options);\n    }\n}\n","import {\n    EvalCellElement,  // ensure that the \"eval-cell\" custom element has been defined\n} from './eval-cell-element/_.js';\n\nimport {\n    logbook_manager,\n} from './logbook-manager.js';\n\n\nlogbook_manager.initialize();\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    EditorCellElement,  // also ensures that the \"editor-cell\" custom element has been defined\n} from './editor-cell-element/_.js';\n\nimport {\n    EvalCellElement,  // also ensures that the \"eval-cell\" custom element has been defined\n} from './eval-cell-element/_.js';\n\nimport {\n    ToolBarElement,  // also ensures that the \"tool-bar\" custom element has been defined\n} from './tool-bar-element/_.js';\n\nimport {\n    Subscribable,\n} from '../lib/sys/subscribable.js';\n\nimport {\n    show_initialization_failed,\n    create_element,\n    clear_element,\n} from '../lib/ui/dom-util.js';\n\nimport {\n    MenuBar,\n} from '../lib/ui/menu/_.js';\n\nimport {\n    ChangeManager,\n} from '../lib/ui/change-manager.js';\n\nimport {\n    fs_interface,\n} from '../lib/sys/fs-interface.js';\n\nimport {\n    SettingsDialog,\n} from './settings-dialog/_.js';\n\nimport {\n    beep,\n} from '../lib/ui/beep.js';\n\nimport {\n    assets_server_url,\n} from './assets-server-url.js';\n\n\n// import {\n//     create_stylesheet_link,\n// } from '../lib/ui/dom-util.js';\n// {\n//     const server_url = assets_server_url(current_script_url);\n//     create_stylesheet_link(document.head, new URL('./style.css',       server_url));\n//     create_stylesheet_link(document.head, new URL('./style-hacks.css', server_url));\n// }\nimport './style.css';        // webpack implementation\nimport './style-hacks.css';  // webpack implementation\n\n\n// Note: Each eval-cell maintains its own key_event_manager and key maps.\n// Therefore the (active) eval-cell is the locus for incoming commands,\n// whether from the menu or the keyboard.  The eval-cell in effect \"precompiles\"\n// command dispatch in eval_cell.get_command_bindings().\n\n\nclass LogbookManager {\n    constructor() {\n        this.#editable = false;\n        this.#active_cell = null;\n        this.#initialize_called = false;\n        this.reset_global_eval_context();\n        this.#eval_states = new Subscribable();\n        //!!! this.#eval_states_subscription is never unsubscribed\n        this.#eval_states_subscription = this.#eval_states.subscribe(this.#eval_states_observer.bind(this));\n\n    }\n    #editable;\n    #active_cell;\n    #initialize_called;\n    #controls_element;  // element inserted into document by initialize() to hold menus, etc\n    #content_element;   // element wrapped around original body content by initialize()\n    #eval_states;\n    #eval_states_subscription;\n    #menubar;\n    #menubar_commands_subscription;\n    #menubar_selects_subscription;\n    #tool_bar;\n    #global_eval_context;  // persistent eval_context for eval commands\n    #global_change_manager;\n    #file_handle;\n\n    get editable (){ return this.#editable }\n\n    set_editable(editable) {\n        editable = !!editable;\n        this.#editable = editable;\n        this.#menubar.set_menu_state('toggle-editable', { checked: editable });\n        this.#tool_bar.set_for('editable', editable);\n        for (const cell of this.constructor.get_cells()) {\n            cell.set_editable(editable);\n        }\n    }\n\n    get active_cell (){ return this.#active_cell; }\n    set_active_cell(cell) {\n        this.#active_cell = (cell ?? null);\n        for (const cell of this.constructor.get_cells()) {\n            cell.set_active(cell === this.active_cell);\n        }\n    }\n\n    get controls_element (){ return this.#controls_element; }\n    get content_element  (){ return this.#content_element; }\n\n    get global_eval_context (){ return this.#global_eval_context; }\n    reset_global_eval_context() {\n        this.#global_eval_context = {};\n    }\n\n    /** reset the document, meaning that all cells will be reset,\n     *  and this.global_eval_context will be reset.  Also,\n     *  the saved file handle this.#file_handle set to undefined.\n     *  @return {LogbookManager} this\n     */\n    reset() {\n        for (const cell of this.constructor.get_cells()) {\n            cell.reset();\n        }\n        this.reset_global_eval_context();\n        this.#file_handle = undefined;\n        return this;\n    }\n\n    /** clear the current document\n     */\n    clear() {\n        clear_element(this.content_element);\n        const first_cell = this.create_cell();\n        first_cell.focus();\n    }\n\n    stop() {\n        for (const cell of this.constructor.get_cells()) {\n            cell.stop();\n        }\n    }\n\n    initialize() {\n        if (this.#initialize_called) {\n            throw new Error('initialize() called more than once');\n        }\n        this.#initialize_called = true;\n\n        try {\n\n            // establish this.#content_element / this.content_element\n            this.#initialize_document_structure();\n\n            this.#setup_csp();\n            this.#setup_controls();\n\n            this.set_editable(this.editable);  // update all cells consistently\n\n            // validate structure of document\n            const cells = this.constructor.get_cells();\n            if (cells.length > 0) {\n                //!!! improve this !!!\n            }\n\n            // set up active cell\n            // ... find the first incoming \"active\" cell, or the first cell, or create a new cell\n            const active_cell = cells.find(cell => cell.active) ?? cells[0] ?? this.create_cell();\n            this.set_active_cell(active_cell);  // also resets \"active\" tool on all cells except for active_cell\n            active_cell.focus();\n\n            // Set up this.#global_change_manager now so that it is available\n            // during initialization of cells.  It will be reset when document\n            // initialization is complete.\n            this.#global_change_manager = new ChangeManager(this.content_element, {\n                neutral_changes_observer: this.#neutral_changes_observer.bind(this),\n            });\n\n            // add \"save before quit\" prompt for when document is being closed while modified\n            window.addEventListener('beforeunload', (event) => {\n                if (!this.#global_change_manager.is_neutral) {\n                    event.preventDefault();\n                    return (event.returnValue = '');\n                }\n            });  //!!! event handler never removed\n\n\n            // set baseline for undo/redo\n            // it is important that all async operations have finished before getting here\n            this.#global_change_manager.set_neutral();\n\n        } catch (error) {\n\n            show_initialization_failed(error);\n\n        }\n    }\n\n    /** create a new cell in the document\n     *  @param (Object|null|undefined} options\n     *  @return {EvalCellElement} cell\n     * options is passed to EvalCellElement.create_cell() but\n     * with parent overridden to this.content_element.\n     */\n    create_cell(options=null) {\n        return EvalCellElement.create_cell({\n            ...(options ?? {}),\n            parent: this.content_element,\n        });\n    }\n\n    /** return an ordered list of the cells in the document\n     *  @return {Array} all cells in the document\n     */\n    static get_cells() {\n        return [\n            ...document.getElementsByTagName(EditorCellElement.custom_element_name),\n            ...document.getElementsByTagName(EvalCellElement.custom_element_name),\n        ];\n    }\n\n\n    // === DOCUMENT UTILITIES ===\n\n    static controls_element_id = 'controls';\n    static content_element_id  = 'content';\n\n    // put everything this the body into a top-level content element\n    #initialize_document_structure() {\n        if (document.getElementById(this.constructor.controls_element_id)) {\n            throw new Error(`bad format for document: element with id ${this.constructor.controls_element_id} already exists`);\n        }\n        if (document.getElementById(this.constructor.content_element_id)) {\n            throw new Error(`bad format for document: element with id ${this.constructor.content_element_id} already exists`);\n        }\n\n        // establish favicon\n        if (!document.querySelector('link[rel=\"icon\"]')) {\n            create_element({\n                parent: document.head,\n                tag:    'link',\n                attrs: {\n                    rel: 'icon',\n                    href: new URL('favicon.ico', assets_server_url(current_script_url)),\n                },\n            });\n        }\n        // establish body element if not already present\n        if (!document.body) {\n            document.documentElement.appendChild(document.createElement('body'));\n            // document.body is now set\n        }\n        // create the content element and move the current children of the body to it\n        this.#content_element = document.createElement('div');\n        this.#content_element.id = this.constructor.content_element_id;\n        while (document.body.firstChild) {\n            this.#content_element.appendChild(document.body.firstChild);  // moves document.body.firstChild\n        }\n        // create controls element\n        this.#controls_element = document.createElement('div');\n        this.#controls_element.id = this.constructor.controls_element_id;\n        // add controls and content elements\n        document.body.appendChild(this.#controls_element);\n        document.body.appendChild(this.#content_element);\n\n        // add a tool-bar element to each pre-existing cell\n        for (const cell of this.constructor.get_cells()) {\n            cell.establish_tool_bar();\n            // the following will establish the event handlers for cell\n            const current_output_element = cell.output_element;\n            cell.output_element = null;\n            cell.output_element = current_output_element;\n        }\n    }\n    #assets_server_root;\n    #local_server_root;\n\n    #save_serializer() {\n        const queried_content_element = document.getElementById(this.constructor.content_element_id);\n        if (!queried_content_element || queried_content_element !== this.content_element) {\n            throw new Error('bad format for document');\n        }\n        const contents = [ ...this.content_element?.querySelectorAll(`${EvalCellElement.custom_element_name}, .${EvalCellElement.output_element_class}`) ]\n              .map(e => e.outerHTML)\n              .join('\\n');\n        return `\\\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"utf-8\">\n    <script type=\"module\" src=\"../src/init.js\"></script>\n</head>\n<body>\n${contents}\n</body>\n</html>\n`;\n}\n\n    #setup_csp() {\n        if (false) {  //!!!\n\n            // === CONTENT SECURITY POLICY ===\n\n            // set a Content-Security-Policy that will permit us\n            // to dynamically load associated content\n\n            const csp_header_content = [\n                //!!! audit this !!!\n                \"default-src 'self' 'unsafe-eval'\",\n                \"style-src   'self' 'unsafe-inline' *\",\n                \"script-src  'self' 'unsafe-inline' 'unsafe-eval' *\",\n                \"img-src     'self' data: blob: *\",\n                \"media-src   'self' data: blob: *\",\n                \"connect-src data:\",\n            ].join('; ');\n\n            create_element({\n                parent: document.head,\n                tag:    'meta',\n                attrs: {\n                    \"http-equiv\": \"Content-Security-Policy\",\n                    \"content\":    csp_header_content,\n                },\n            });\n        }\n    }\n\n    get_suggested_file_name() {\n        return window.location.pathname.split('/').slice(-1)[0];\n    }\n\n\n    // === MENU AND COMMAND CONFIGURATION ===\n\n    update_menu_state() {\n        const cells        = this.constructor.get_cells();\n        const active_cell  = this.active_cell;\n        const active_index = cells.indexOf(active_cell);\n        const can_undo     = this.#global_change_manager.can_perform_undo;\n        const can_redo     = this.#global_change_manager.can_perform_redo;\n/*\n'toggle-editable'  // directly handled in this.set_editable()\n'save'  // directly handled in this.#neutral_changes_observer()\n*/\n        this.#menubar.set_menu_state('undo', { enabled: can_undo });\n        this.#menubar.set_menu_state('redo', { enabled: can_redo });\n\n        this.#menubar.set_menu_state('toggle-cell-visible', { checked: active_cell?.visible });\n\n        this.#menubar.set_menu_state('focus-up',   { enabled: (active_cell && active_index > 0) });\n        this.#menubar.set_menu_state('focus-down', { enabled: (active_cell && active_index < cells.length-1) });\n        this.#menubar.set_menu_state('move-up',    { enabled: (active_cell && active_index > 0) });\n        this.#menubar.set_menu_state('move-down',  { enabled: (active_cell && active_index < cells.length-1) });\n        this.#menubar.set_menu_state('delete',     { enabled: !!active_cell });\n\n        this.#menubar.set_menu_state('eval-and-refocus', { enabled: !!active_cell });\n        this.#menubar.set_menu_state('eval',             { enabled: !!active_cell });\n        this.#menubar.set_menu_state('eval-before',      { enabled: !!active_cell });\n        this.#menubar.set_menu_state('eval-all',         { enabled: !!active_cell });\n        this.#menubar.set_menu_state('stop',             { enabled: active_cell?.can_stop });\n        this.#menubar.set_menu_state('stop-all',         { enabled: cells.some(cell => cell.can_stop) });\n/*\nrecents\n*/\n        //!!!\n    }\n\n    #setup_controls() {\n        if (!this.controls_element) {\n            throw new Error(`bad format for document: controls element does not exist`);\n        }\n        const get_command_bindings = () => EvalCellElement.get_initial_key_map_bindings();\n        const get_recents = null;//!!! implement this\n        this.#menubar = MenuBar.create(this.controls_element, this.constructor.#get_menubar_spec(), get_command_bindings, get_recents);\n        //!!! this.#menubar_commands_subscription is never unsubscribed\n        this.#menubar_commands_subscription = this.#menubar.commands.subscribe(this.#menubar_commands_observer.bind(this));\n        //!!! this.#menubar_selects_subscription is never unsubscribed\n        this.#menubar_selects_subscription = this.#menubar.selects.subscribe(this.update_menu_state.bind(this));\n\n        // add a tool-bar element to the main document\n        this.#tool_bar = ToolBarElement.create_for(this.controls_element, {\n            editable: { initial: this.editable,  on: (event) => this.set_editable(event.target.get_state()) },\n            //!!!autoeval: { initial: this.autoeval,  on: (event) => this.set_autoeval(!this.autoeval) },//!!!\n            modified: true,\n            running:  true,\n        });\n        this.#controls_element.appendChild(this.#tool_bar);\n    }\n\n    #menubar_commands_observer(command_context) {\n        const target = this.active_cell;\n        if (!target) {\n            beep();\n        } else if (!(target instanceof EditorCellElement)) {\n            beep();\n        } else {\n            // set target in command_context to be the active cell\n            const updated_command_context = {\n                ...command_context,\n                target,\n            };\n            target.perform_command(updated_command_context);\n        }\n    }\n\n    static #get_menubar_spec() {\n        return [\n            { label: 'File', collection: [\n                { label: 'Recent logbooks', id: 'recents', collection: [\n                    // ...\n                ] },\n                '---',\n                { label: 'Reset cells',    item: { command: 'reset',               } },\n                { label: 'Clear document', item: { command: 'clear',               } },\n                '---',\n                { label: 'Editable',       item: { command: 'toggle-editable',     }, id: 'toggle-editable' },\n                '---',\n                { label: 'Save',           item: { command: 'save',                }, id: 'save' },\n                { label: 'Save as...',     item: { command: 'save-as',             } },\n                '---',\n                { label: 'Settings...',    item: { command: 'settings',            } },\n            ] },\n\n            { label: 'Edit', collection: [\n                { label: 'Undo',           item: { command: 'undo',                }, id: 'undo' },\n                { label: 'Redo',           item: { command: 'redo',                }, id: 'redo' },\n            ] },\n\n            { label: 'Cell', collection: [\n                { label: 'Eval',           item: { command: 'eval-and-refocus',    }, id: 'eval-and-refocus' },\n                { label: 'Eval and stay',  item: { command: 'eval',                }, id: 'eval' },\n                { label: 'Eval before',    item: { command: 'eval-before',         }, id: 'eval-before' },\n                { label: 'Eval all',       item: { command: 'eval-all',            }, id: 'eval-all' },\n                '---',\n                { label: 'Stop cell',      item: { command: 'stop',                }, id: 'stop' },\n                { label: 'Stop all',       item: { command: 'stop-all',            }, id: 'stop-all' },\n                '---',\n                { label: 'Reset cell',     item: { command: 'reset-cell',          } },\n                { label: 'Visible',        item: { command: 'toggle-cell-visible', }, id: 'toggle-cell-visible' },\n                '---',\n                { label: 'Focus up',       item: { command: 'focus-up',            }, id: 'focus-up' },\n                { label: 'Focus down',     item: { command: 'focus-down',          }, id: 'focus-down' },\n                '---',\n                { label: 'Move up',        item: { command: 'move-up',             }, id: 'move-up' },\n                { label: 'Move down',      item: { command: 'move-down',           }, id: 'move-down' },\n                { label: 'Add before',     item: { command: 'add-before',          } },\n                { label: 'Add after',      item: { command: 'add-after',           } },\n                { label: 'Delete',         item: { command: 'delete',              }, id: 'delete' },\n            ] },\n\n            { label: 'Help', collection: [\n                { label: 'Help...',        item: { command: 'help',                } },\n            ] },\n        ];\n    }\n\n    /** return the initial key map bindings\n     *  @return {Object} mapping from command strings to arrays of triggering key sequences\n     */\n    static get_global_initial_key_map_bindings() {\n        return {\n            'create-cell':         [ 'CmdOrCtrl-Shift-Alt-N' ],\n\n            'reset':               [ ],\n            'clear':               [ ],\n\n            'save':                [ 'CmdOrCtrl-S' ],\n            'save-as':             [ 'CmdOrCtrl-Shift-S' ],\n\n            'settings':            [ 'CmdOrCtrl-,' ],\n\n            'eval-and-refocus':    [ 'Shift-Enter' ],\n            'eval-before':         [ 'CmdOrCtrl-Shift-Enter' ],\n            'eval-all':            [ 'CmdOrCtrl-Shift-Alt-Enter' ],\n\n            'stop':                [ 'CmdOrCtrl-Alt-!' ],\n            'stop-all':            [ 'CmdOrCtrl-Shift-Alt-!' ],\n\n            'focus-up':            [ 'Alt-Up' ],\n            'focus-down':          [ 'Alt-Down' ],\n\n            'move-up':             [ 'CmdOrCtrl-Alt-Up' ],\n            'move-down':           [ 'CmdOrCtrl-Alt-Down' ],\n            'add-before':          [ 'CmdOrCtrl-Alt-Shift-Up' ],\n            'add-after':           [ 'CmdOrCtrl-Alt-Shift-Down' ],\n            'delete':              [ 'CmdOrCtrl-Alt-Backspace' ],\n\n            'set-mode-markdown':   [ 'Alt-M m' ],\n            'set-mode-tex':        [ 'Alt-M t' ],\n            'set-mode-javascript': [ 'Alt-M j' ],\n\n            'toggle-cell-visible': [ 'Alt-M v' ],\n            'toggle-editable':     [ 'Alt-M e' ],\n\n            'undo':                [ 'CmdOrCtrl-Z' ],\n            'redo':                [ 'CmdOrCtrl-Shift-Z' ],\n        };\n    }\n\n    /** return global command bindings\n     *  @return {Object} mapping from command strings to functions implementing that command\n     * The bindings are obtained by merging local command bindings with logbook_manager\n     * command bindings.\n     */\n    get_global_command_bindings() {\n        const command_bindings = {\n            'create-cell':      this.command_handler__create_cell.bind(this),\n\n            'reset':            this.command_handler__reset.bind(this),\n            'clear':            this.command_handler__clear.bind(this),\n\n            'save':             this.command_handler__save.bind(this),\n            'save-as':          this.command_handler__save_as.bind(this),\n\n            'settings':         this.command_handler__show_settings_dialog.bind(this),\n\n            'eval-and-refocus': this.command_handler__eval_and_refocus.bind(this),\n            'eval-before':      this.command_handler__eval_before.bind(this),\n            'eval-all':         this.command_handler__eval_all.bind(this),\n\n            'stop':             this.command_handler__stop.bind(this),\n            'stop-all':         this.command_handler__stop_all.bind(this),\n\n            'focus-up':         this.command_handler__focus_up.bind(this),\n            'focus-down':       this.command_handler__focus_down.bind(this),\n\n            'move-up':          this.command_handler__move_up.bind(this),\n            'move-down':        this.command_handler__move_down.bind(this),\n            'add-before':       this.command_handler__add_before.bind(this),\n            'add-after':        this.command_handler__add_after.bind(this),\n            'delete':           this.command_handler__delete.bind(this),\n\n            'toggle-editable':  this.command_handler__toggle_editable.bind(this),\n\n            'undo':             this.command_handler__undo.bind(this),\n            'redo':             this.command_handler__redo.bind(this),\n        };\n\n        return command_bindings;\n    }\n\n\n    // === NEUTRAL CHANGES OBSERVER ===\n\n    #neutral_changes_observer(data) {\n        const {\n            is_neutral,\n        } = data;\n        this.#tool_bar.set_for('modified', !is_neutral);\n        this.#menubar.set_menu_state('save', { checked: !is_neutral });\n    }\n\n\n    // === EVAL STATES ===\n\n    emit_eval_state(cell, eval_state) {\n        this.#eval_states.dispatch({ cell, eval_state });\n    }\n\n    #eval_states_observer(data) {\n        // data is ignored\n        const {\n            cell,\n            eval_state,\n        } = data;\n        const something_foreground = this.constructor.get_cells().some(cell => cell.evaluator_foreground);\n        this.#tool_bar.set_for('running', something_foreground);\n    }\n\n\n    // === COMMAND HANDLERS ===\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__create_cell(command_context) {\n        let before = null;\n        const next_cell = command_context.target?.adjacent_cell?.(true);\n        if (next_cell) {\n            before = next_cell.get_dom_extent().first;\n        }\n        const cell = this.create_cell({ before });\n        if (!cell) {\n            return false;\n        } else {\n            cell.focus();\n            return true;\n        }\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__reset(command_context) {\n        this.reset();\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__clear(command_context) {\n        this.clear();\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    async command_handler__save(command_context) {\n        const save_result = await fs_interface.save(this.#save_serializer.bind(this), {\n            file_handle: this.#file_handle,\n            prompt_options: {\n                suggestedName: this.get_suggested_file_name(),//!!!\n            },\n        });\n        const {\n            canceled,\n            file_handle,\n            stats,\n        } = save_result;\n        if (!canceled) {\n            //!!!\n            this.#file_handle = file_handle ?? undefined;\n            this.#global_change_manager.set_neutral();\n        }\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    async command_handler__save_as(command_context) {\n        this.#file_handle = undefined;\n        await fs_interface.save(this.#save_serializer.bind(this), {\n            prompt_options: {\n                suggestedName: this.get_suggested_file_name(),//!!!\n            },\n        });\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__show_settings_dialog(command_context) {\n        SettingsDialog.run();\n        return true;\n    }\n\n    /** eval target cell and refocus to next cell (or a new one if at the end of the document)\n     *  @return {Boolean} true iff command successfully handled\n     */\n    async command_handler__eval_and_refocus(command_context) {\n        const cell = command_context.target;\n        if (!cell || !(cell instanceof EvalCellElement)) {\n            return false;\n        } else {\n            await cell.eval({\n                eval_context: this.global_eval_context,\n            });\n            const next_cell = cell.adjacent_cell(true) ?? this.create_cell();\n            next_cell.focus();\n            return true;\n        }\n    }\n\n    /** reset this.global_eval_context and then eval all cells in the document\n     *  from the beginning up to but not including the target cell.\n     *  @return {Boolean} true iff command successfully handled\n     */\n    async command_handler__eval_before(command_context) {\n        const cell = command_context.target;\n        if (!cell || !(cell instanceof EvalCellElement)) {\n            return false;\n        } else {\n            this.reset_global_eval_context();\n            for (const iter_cell of this.constructor.get_cells()) {\n                if (iter_cell === cell) {\n                    break;\n                }\n                await iter_cell.eval({\n                    eval_context: this.global_eval_context,\n                });\n            }\n            return true;\n        }\n    }\n\n    /** stop all running evaluations, reset this.global_eval_context and then eval all cells in the document\n     *  from first to last, and set focus to the last.\n     *  @return {Boolean} true iff command successfully handled\n     */\n    async command_handler__eval_all(command_context) {\n        const cell = command_context.target;\n        if (!cell || !(cell instanceof EvalCellElement)) {\n            return false;\n        } else {\n            this.stop();\n            this.reset_global_eval_context();\n            let final_cell;\n            for (const iter_cell of this.constructor.get_cells()) {\n                await iter_cell.eval({\n                    eval_context: this.global_eval_context,\n                });\n                final_cell = iter_cell;\n            }\n            final_cell.focus();\n            return true;\n        }\n    }\n\n    /** stop evaluation for the active cell.\n     *  @return {Boolean} true iff command successfully handled\n     */\n    command_handler__stop(command_context) {\n        const cell = command_context.target;\n        if (!cell || !(cell instanceof EvalCellElement)) {\n            return false;\n        } else {\n            cell.stop();\n            return true;\n        }\n    }\n\n    /** stop all running evaluations.\n     *  @return {Boolean} true iff command successfully handled\n     */\n    command_handler__stop_all(command_context) {\n        this.stop();\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__focus_up(command_context) {\n        const focus_cell = command_context.target.adjacent_cell(false);\n        if (!focus_cell) {\n            return false;\n        } else {\n            focus_cell.focus();\n            return true;\n        }\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__focus_down(command_context) {\n        const focus_cell = command_context.target.adjacent_cell(true);\n        if (!focus_cell) {\n            return false;\n        } else {\n            focus_cell.focus();\n            return true;\n        }\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__move_up(command_context) {\n        const cell = command_context.target;\n        if (!cell) {\n            return false;\n        } else {\n            const previous = cell.adjacent_cell(false);\n            if (!previous) {\n                return false;\n            } else {\n                cell.move_cell({\n                    before: previous.get_dom_extent().first,\n                });\n                cell.focus();\n                return true;\n            }\n        }\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__move_down(command_context) {\n        const cell = command_context.target;\n        if (!cell) {\n            return false;\n        } else {\n            const next = cell.adjacent_cell(true);\n            if (!next) {\n                return false;\n            } else {\n                cell.move_cell({\n                    before: next.get_dom_extent().last.nextSibling,\n                    parent: cell.parentElement,  // necessary if before is null\n                });\n                cell.focus();\n                return true;\n            }\n        }\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__add_before(command_context) {\n        const cell = command_context.target;\n        const new_cell = this.create_cell({\n            before: cell.get_dom_extent().first,\n        });\n        new_cell.focus();\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__add_after(command_context) {\n        const cell = command_context.target;\n        const new_cell = this.create_cell({\n            before: cell.get_dom_extent().last.nextSibling,\n            parent: cell.parentElement,  // necessary if before is null\n        });\n        new_cell.focus();\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__delete(command_context) {\n        const cell = command_context.target;\n        let next_cell = cell.adjacent_cell(true) ?? cell.adjacent_cell(false);\n        cell.remove_cell();\n        if (!next_cell) {\n            next_cell = this.create_cell();\n        }\n        next_cell.focus();\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__toggle_editable(command_context) {\n        this.set_editable(!this.editable);\n        return true;\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__undo(command_context) {\n        return this.#global_change_manager?.perform_undo();\n    }\n\n    /** @return {Boolean} true iff command successfully handled\n     */\n    command_handler__redo(command_context) {\n        return this.#global_change_manager?.perform_redo();\n    }\n}\n\n\nexport const logbook_manager = new LogbookManager();\nglobalThis.logbook_manager = logbook_manager;//!!!\n","import {\n    clear_element,\n    scroll_element_into_view,\n    set_element_attrs,\n    update_element_style,\n    create_element,\n    create_element_child_text_node,\n    normalize_element_text,\n} from '../lib/ui/dom-util.js';\n\nimport {\n    Renderer,\n} from './renderer/_.js';\n\n\nexport class OutputContext {\n    constructor(element) {\n        if (!(element instanceof HTMLElement)) {\n            throw new Error('element must be an instance of HTMLElement');\n        }\n        Object.defineProperties(this, {\n            element: {\n                value: element,\n                enumerable: true,\n            },\n        });\n    }\n\n    // === STATIC METHODS ===\n\n    static get_svg_string(svg_node) {\n        const serializer = new XMLSerializer();\n        let svg_string = serializer.serializeToString(svg_node);\n        svg_string = svg_string.replace(/(\\w+)?:?xlink=/g, 'xmlns:xlink=');  // fix root xlink without namespace\n        svg_string = svg_string.replace(/NS\\d+:href/g, 'xlink:href');  // Safari NS namespace fix\n        return svg_string;\n    }\n\n    /** remove all child elements and nodes of element\n     *  @param {HTMLElement} element\n     *  @return {HTMLElement} element\n     */\n    static clear_element(element) {\n        return clear_element(element);\n    }\n\n    /** scroll element into view\n     *  @param {Element} element\n     *  @return {Element} element\n     */\n    static scroll_element_into_view(element) {\n        return scroll_element_into_view(element);  // from dom-util.js\n    }\n\n    /** set attributes on an element which are taken from an object.\n     *  @param {Element} element\n     *  @param {Object|undefined|null} attrs\n     *  @return {Element} element\n     *  Attribute values obtained by calling toString() on the values in attrs\n     *  except that values which are undefined are translated to ''.\n     */\n    static set_element_attrs(element, attrs) {\n        return set_element_attrs(element, attrs);  // from dom-util.js\n    }\n\n    /** add/remove style properties on element\n     *  @param {HTMLElement} element\n     *  @param {Object} spec collection of properties to add or remove.\n     *                  If the value of an entry is null or undefined, then\n     *                  the corresponding property is removed.  If the value\n     *                  of an entry is null, then the property is removed.\n     *                  If the value of an entry is undefined, then that\n     *                  entry is ignored.  Otherwise, the value of the\n     *                  corresponding property is set.\n     *  @return {HTMLElement} element\n     */\n    static update_element_style(element, spec) {\n        return update_element_style(element, spec);  // from dom-util.js\n    }\n\n    /** create a new child element of the given element with the given characteristics\n     *  @param {Object|undefined|null} options: {\n     *      before?:    Node|null,  // sibling node before which to insert; append if null or undefined\n     *      tag?:       string,     // tag name for new element; default: 'div'\n     *      namespace?: string,     // namespace for new element creation\n     *      attrs?:     object,     // attributes to set on new element\n     *      style?:     object,     // style properties for new element\n     *  }\n     *  @return {HTMLElement} the new element\n     * A unique id will be assigned to the element unless that element already has an id attribute\n     * specified (in attrs).\n     * The before node, if specified, must have a parent that must match parent if parent is specified.\n     * If neither parent nor before is specified, the new element will have no parent.\n     * Warning: '!important' in style specifications does not work!  (Should use priority method.)\n     */\n    static create_element_child(element, options=null) {\n        return create_element({ parent: element, ...(options ?? {}) });  // from dom-util.js\n    }\n\n    /** create or update a child text node of the given element\n     *  @param {HTMLElement} element\n     *  @param {any} text to be contained in the new text node\n     *  @param {Object|undefined|null} options: {\n     *             before?: null|Node,  // child node or element before which to insert; append if null or undefined\n     *             prevent_coalesce_next?: boolean,\n     *         }\n     *  @return {Node|null} the new or modified text node, or null if the converted text is ''\n     *\n     * Text will be converted to a string (if not already a string).  A text value\n     * of null or undefined is equivalent to ''.\n     *\n     * The text will be coalesced into the immediately previous text node, if any.\n     * Otherwise, if the next node is a text node the text will be coealesced\n     * into the beginning text of it unless options.prevent_coalesce_next.\n     * options.prevent_coalesce_next makes sure that the same options.before\n     * node can be used repeatedly with the expected results.  However,\n     * options.prevent_coalesce_next may leave element non-normalized.\n     * On the other hand, if !options.prevent_coalesce_next, the element\n     * will not become non-normalized (but may be non-normalized if it\n     * already was).\n     */\n    static create_element_child_text_node(element, text, options=null) {\n        return create_element_child_text_node(element, text, options);  // from dom-util.js\n    }\n\n    /** normalize the text node children of element, meaning that text nodes\n     *  are non-empty and no text nodes are adjacent.\n     *  @param {Element} element\n     *  @return {Element} element\n     */\n    static normalize_element_text(element) {\n        return normalize_element_text(element);  // from dom-util.js\n    }\n\n\n    // === INSTANCE METHODS ===\n\n    /** remove all child elements and nodes of this.element via this.constructor.clear_element()\n     *  @return this\n     */\n    clear() {\n        this.constructor.clear_element(this.element);\n        return this;\n    }\n\n    /** scroll this.element into view via this.constructor.scroll_element_into_view()\n     *  @return this\n     */\n    scroll_into_view() {\n        this.constructor.scroll_element_into_view(this.element);\n        return this;\n    }\n\n    /** set attributes on an element which are taken from an object, via this.constructor.set_element_attrs()\n     *  @return this\n     */\n    set_attrs(attrs) {\n        this.constructor.set_element_attrs(this.element, attrs);\n        return this;\n    }\n\n    /** add/remove style properties on this.element via this.constructor.update_element_style()\n     *  @return this\n     */\n    update_style(spec) {\n        this.constructor.update_element_style(this.element, spec);\n        return this;\n    }\n\n    /** create a new child element of this.element via this.constructor.create_element_child()\n     *  @return {HTMLElement} the new child element\n     */\n    create_child(options=null) {\n        return this.constructor.create_element_child(this.element, options);\n    }\n\n    /** create or update a child text node of this.element via this.constructor.create_element_child_text_node()\n     *  @return {Node|null} the new or modified text node, or null if the converted text is ''\n     */\n    create_child_text_node(text, options=null) {\n        return this.constructor.create_element_child_text_node(this.element, text, options);\n    }\n\n    /** normalize this.element via this.constructor.normalize_element_text()\n     *  @return this\n     */\n    normalize_text() {\n        this.constuctor.normalize_element_text(this.element);\n        return this;\n    }\n\n\n    // === RENDERER INTERFACE ===\n\n    /** return a new instance of the appropriate Renderer class for the given type\n     *  @param {String} type\n     *  @return {Renderer} renderer_class\n     */\n    renderer_for_type(type) {\n        const renderer_class = Renderer.class_from_type(type);\n        if (!renderer_class) {\n            throw new Error(`unknown output type: ${type}`);\n        } else {\n            return new renderer_class();\n        }\n    }\n\n    /** run the given renderer with the given arguments and this output_context\n     *  @param {Renderer} renderer instance\n     *  @param {any} value\n     *  @param {Object} options for renderer\n     *  @return {any} return value from renderer\n     */\n    async invoke_renderer(renderer, value, options=null) {\n        return renderer.render(this, value, options)\n            .catch(error => {\n                renderer.stop();  // stop anything that may have been started\n                throw error;      // propagate the error\n            });\n    }\n\n    /** find a renderer and invoke it for the given arguemnts\n     *  @param {String} type\n     *  @param {any} value\n     *  @param {Object} options for renderer\n     *  @return {any} return value from renderer\n     */\n    async invoke_renderer_for_type(type, value, options=null) {\n        const renderer = this.renderer_for_type(type);\n        return this.invoke_renderer(renderer, value, options);\n    }\n}\n","// Renderer is defined in a separate file to break dependency cycle in get_renderer_classes()\nexport {\n    Renderer,\n} from './renderer.js';\n\nimport { TextRenderer       } from './text-renderer.js';\nimport { ErrorRenderer      } from './error-renderer.js';\nimport { MarkdownRenderer   } from './markdown-renderer.js';\nimport { TeXRenderer        } from './tex-renderer.js';\nimport { JavaScriptRenderer } from './javascript-renderer/_.js';\nimport { ImageDataRenderer  } from './image-data-renderer.js';\nimport { ChartRenderer      } from './chart-renderer.js';\nimport { GraphvizRenderer   } from './graphviz-renderer.js';\nimport { PlotlyRenderer     } from './plotly-renderer.js';\n\nexport function get_renderer_classes() {\n    return [\n        TextRenderer,\n        ErrorRenderer,\n        MarkdownRenderer,\n        TeXRenderer,\n        JavaScriptRenderer,\n        ImageDataRenderer,\n        ChartRenderer,\n        GraphvizRenderer,\n        PlotlyRenderer,\n    ];\n}\n","import {\n    Chart,\n} from './chart.js';\n\nimport {\n    Renderer,\n} from './renderer.js';\n\n\nexport class ChartRenderer extends Renderer {\n    static type = 'chart';\n\n    // Format of config object: see Chart.js documentation\n\n    // may throw an error\n    async render(output_context, config, options) {\n        const style = options?.style;\n\n        // Re: Chart.js:\n        // Wrap the canvas element in a div to prevent quirky behavious of Chart.js size handling.\n        // See: https://stackoverflow.com/questions/19847582/chart-js-canvas-resize.\n        // (Note: doing this for all text/graphics types)\n\n        const parent = output_context.create_child({\n            attrs: {\n                'data-type': this.type,\n            },\n        });\n        const canvas = output_context.constructor.create_element_child(parent, {\n            tag: 'canvas',\n            style,\n        });\n        const ctx = canvas.getContext('2d');\n        // eliminate animation so that the canvas.toDataURL() call below will have something to render:\n        Chart.defaults.global.animation.duration = 0;\n        const chart_object = new Chart(ctx, config);  // simply for effect, chart_object not used...\n\n        return parent;\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    load_script,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\nawait load_script(document.head, new URL('../../node_modules/chart.js/dist/Chart.bundle.min.js', assets_server_url(current_script_url)));  // defines globalThis.Chart\n\nexport const Chart = globalThis.Chart;\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    load_script,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\nawait load_script(document.head, new URL('../../node_modules/d3/dist/d3.min.js', assets_server_url(current_script_url)));  // defines globalThis.d3\n\nexport const d3 = globalThis.d3;\n","import {\n    Renderer,\n} from './renderer.js';\n\n\nexport class ErrorRenderer extends Renderer {\n    static type = 'error';\n\n    static error_element_class      = 'error';\n    static error_element_text_color = 'red';//!!! should be configurable\n\n    async render(output_context, error_object, options) {\n        const style = options?.style;\n\n        const text_segments = [];\n        if (error_object.stack) {\n            text_segments.push(error_object.stack);\n        } else {\n            text_segments.push(error_object.message || 'error');\n        }\n        const text = text_segments.join('\\n');\n\n        const parent = output_context.create_child({\n            tag: 'pre',\n            attrs: {\n                'data-type': this.type,\n            },\n            style: {\n                ...(style ?? {}),\n                color: this.constructor.error_element_text_color,\n            }\n        });\n        parent.innerText = text;  // innerText sanitizes text\n\n        return parent;\n    }\n}\n","import {\n    Renderer,\n} from './renderer.js';\n\nimport {\n    render as graphviz_render,\n} from './graphviz.js';\n\n\nexport class GraphvizRenderer extends Renderer {\n    static type = 'graphviz';\n\n    // Format of config object: {\n    //     node_config?: string,\n    //     nodes[]?: (string | [ string/*name*/, string/*node_options*/ ])[],\n    //     edges[]?: [ string/*from*/, string/*to*/, { label?: string, ... }? ][],\n    // }\n\n    // may throw an error\n    async render(output_context, config, options) {\n        const style = options?.style;\n\n        const element = output_context.create_child({\n            attrs: {\n                'data-type': this.type,\n            },\n            style,\n        });\n        const element_selector = `#${element.id}`;\n\n        const dot_stmts = [];\n        if (config.node_config) {\n            dot_stmts.push(`node ${node_config}`);\n        }\n        for (const node_spec of (config.nodes ?? [])) {\n            if (typeof node_spec === 'string') {\n                const name = node_spec;\n                dot_stmts.push(name);\n            } else {\n                const [ name, node_options ] = node_spec;\n                dot_stmts.push(`${name} [${node_options}]`);\n            }\n        }\n        for (const [ from, to, edge_options ] of (config.edges ?? [])) {\n            dot_stmts.push(`${from}->${to}${edge_options ? `[${edge_options}]` : ''}`);\n        }\n        const dot = `digraph { ${dot_stmts.join(';')} }`;\n\n        // create and run the renderer\n        await graphviz_render(element_selector, dot, {});\n\n        return element;\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    d3,\n} from './d3.js';\n\nimport {\n    load_script,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\nawait load_script(document.head, new URL('../../node_modules/@hpcc-js/wasm/dist/graphviz.umd.js',   assets_server_url(current_script_url)));\nawait load_script(document.head, new URL('../../node_modules/d3-graphviz/build/d3-graphviz.min.js', assets_server_url(current_script_url)));\n\nexport async function render(element_selector, dot, options) {\n    const {\n        transition = \"main\",\n        ease       = d3.easeLinear,\n        delay      = 500,\n        duration   = 1500,\n        logEvents  = true,\n    } = (options ?? {});\n    try {\n        return new Promise((resolve, reject) => {\n            function reject_with_string(...args) {\n                reject(new Error(args[0]));\n            }\n            const graphviz = d3.select(element_selector).graphviz({\n                useWorker:       false,\n                useSharedWorker: false,\n            });\n            graphviz\n                .transition(function () {\n                    return d3.transition(transition)\n                        .ease(ease)\n                        .delay(delay)\n                        .duration(duration);\n                })\n                .logEvents(logEvents)\n                .onerror(reject_with_string)\n                .on(\"initEnd\", function () {\n                    graphviz\n                        .renderDot(dot)\n                        .onerror(reject_with_string)\n                        .on(\"end\", resolve);\n                });\n        });\n    } catch (error) {\n        reject(error);\n    }\n}\n","import {\n    Renderer,\n} from './renderer.js';\n\n\nexport class ImageDataRenderer extends Renderer {\n    static type = 'image-data';\n\n    // Format of config object: {\n    //     x?:         number,  // default value: 0\n    //     y?:         number,  // default value: 0\n    //     image_data: ImageData,\n    // }\n    // (or an array of these objects)\n\n    // may throw an error\n    async render(output_context, config, options) {\n        const style = options?.style;\n\n        const parent = output_context.create_child({\n            attrs: {\n                'data-type': this.type,\n            },\n        });\n        const canvas = output_context.constructor.create_element_child(parent, {\n            tag: 'canvas',\n            style,\n        });\n        const ctx = canvas.getContext('2d');\n        const iter_config = Array.isArray(config) ? config : [ config ];\n        for (const { x = 0, y = 0, image_data } of iter_config) {\n            ctx.putImageData(image_data, x, y);\n        }\n\n        return parent;\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    assets_server_url,\n} from '../../assets-server-url.js';\n\nconst lib_dir_path = '../../../lib/';//!!!\nconst lib_dir_url = new URL(lib_dir_path, assets_server_url(current_script_url));\n\n\n// ======================================================================\n//!!!\n// CODE EVALUATION\n// ---------------\n// Within the code given for evaluation, \"this\" references the eval_context\n// passed to the eval() method.  This object will be obtained from the\n// logbook, and will persist until the logbook is opened to a new file or\n// is cleared.\n//\n// vars(...objects) assigns new properties to eval_context (i.e., \"this\"\n// within the code), and those properties persist across all cells.\n// The return value is undefined; this makes ${vars(...)} in a template\n// string literal or in markup not insert anything into the output.\n//\n// A return statement within a cell terminates the evaluation (except\n// for asynchronous parts that have already been evaluated), and the\n// value passed to the return statement becomes the synchronous result\n// of the evaluation.\n//\n// ephemeral_eval_context\n// ----------------------\n// During evaluation, a number of other values are available \"globally\",\n// though these values do not persist after the particular evaluation\n// (except for references from async code started during the evaluation).\n// These values include output_context (which provides utilities for\n// manipulation of the output of the cell), various graphics, etc functions.\n// Also included are:\n//\n//     println:        prints its argument followed by newline\n//     printf:         implementation of std C printf()\n//     sprintf:        implementation of std C sprintf()\n//     settings:       current settings\n//     theme_settings: current theme_settings\n//     import_lib:     import other libraries from the lib/ directory\n//     vars:           export new \"global\" properties\n//     is_stopped:     determine if the evaluation has been stopped\n//     delay_ms:       return a Promise that resolves after a specified delay\n//     create_worker:  create a new EvalWorker instance\n//\n// These all continue to be available even after the evaluation has\n// returned if there are any async operations still active.\n// See the method #create_ephemeral_eval_context().\n// ======================================================================\n\nconst AsyncGeneratorFunction = Object.getPrototypeOf(async function* () {}).constructor;\n\nimport {\n    logbook_manager,\n} from '../../logbook-manager.js';\n\nimport {\n    Renderer,\n} from '../renderer.js';\n\nimport {\n    EvalWorker,\n} from './eval-worker/_.js';\n\nimport {\n    OutputContext,\n} from '../../output-context.js';\n\nimport {\n    Stoppable,\n} from '../../../lib/sys/stoppable.js';\n\nimport {\n    sprintf,\n} from '../../../lib/sys/sprintf.js';\n\nimport {\n    get_settings,\n} from '../../settings.js';\n\nimport {\n    get_theme_settings,\n} from '../../theme-settings/_.js';\n\nimport {\n    delay_ms        as util_delay_ms,\n    next_tick       as util_next_tick,\n    next_micro_tick as util_next_micro_tick,\n} from '../../../lib/ui/dom-util.js';\n\n\nexport class JavaScriptRenderer extends Renderer {\n    static type = 'javascript';\n\n    // options: { style?: Object, eval_context?: Object, inline?: Boolean }\n\n    // may throw an error\n    // if eval_context is not given in options, then logbook_manager.global_eval_context is used\n    async render(output_context, code, options=null) {\n        const {\n            style,\n            eval_context = logbook_manager.global_eval_context,\n            inline,\n        } = (options ?? {});\n\n        // if !style && inline, then use the given output_context,\n        // otherwise, if style || !inline, create a new output_context\n        if (style || !inline) {\n            const parent = output_context.create_child({\n                tag: inline ? 'span' : 'div',\n                attrs: {\n                    'data-type': this.type,\n                },\n                style,\n            });\n            output_context = new OutputContext(parent);\n        }\n\n        const ephemeral_eval_context = this.#create_ephemeral_eval_context(eval_context, output_context);\n        const ephemeral_eval_context_entries = Object.entries(ephemeral_eval_context);\n\n        // create an async generator with the given code as the heart of its\n        // body, and with parameters being the keys of ephemeral_eval_context.\n        // Then, the code will be evaluated by applying the function to the\n        // corresponding values from ephemeral_eval_context.  Note that\n        // evaluation will be performed in the JavaScript global environment.\n        const eval_fn_params = ephemeral_eval_context_entries.map(([k, _]) => k);\n        const eval_fn_args   = ephemeral_eval_context_entries.map(([_, v]) => v);\n\n        // evaluate the code:\n        const eval_fn_this = eval_context;\n        const eval_fn_body = code;\n        const eval_fn = new AsyncGeneratorFunction(...eval_fn_params, eval_fn_body);\n        const result_stream = eval_fn.apply(eval_fn_this, eval_fn_args);\n\n        // note that using for await ... of misses the return value and we\n        // want to process that, too.  Therefore, instead of the following,\n        // we consume the stream \"manually\".\n        //\n        // for await (const result of result_stream) {\n        //     if (typeof result !== 'undefined') {\n        //         await ephemeral_eval_context.render_value(result);\n        //     }\n        // }\n\n        for (;;) {\n            const { value, done } = await result_stream.next();\n\n            // output any non-undefined values that were received either from\n            // a return or a yield statement in the code\n            if (typeof value !== 'undefined') {\n                if (done) {\n                    // this was the return value, so precede with a special demarcation\n                    await ephemeral_eval_context.render_text('\\n>>> ');\n                }\n\n                await ephemeral_eval_context.render_value(value);\n            }\n\n            if (done) {\n                break;\n            }\n        }\n    }\n\n    #create_ephemeral_eval_context(eval_context, output_context) {\n        const self = this;\n\n        function is_stopped() {\n            return self.stopped;\n        }\n\n        async function create_worker(options) {\n            const worker = new EvalWorker(options);\n            self.add_stoppable(new Stoppable(worker, worker => worker.terminate()));\n            return worker;\n        }\n\n        async function import_lib(lib_path) {\n            return import(new URL(lib_path, lib_dir_url));\n        }\n\n        function vars(...objects) {\n            Object.assign(eval_context, ...objects);\n            return undefined;\n        }\n\n        async function delay_ms(ms) {\n            return util_delay_ms(ms);\n        }\n\n        async function next_tick() {\n            return util_next_tick();\n        }\n\n        async function next_micro_tick() {\n            return util_next_micro_tick();\n        }\n\n        async function sleep(s) {\n            return util_delay_ms(1000*s);\n        }\n\n        async function render(type, value, options=null) {\n            const renderer = output_context.renderer_for_type(type);\n            self.add_stoppable(new Stoppable(renderer));\n            return output_context.invoke_renderer(renderer, value, options)\n                  .catch(error => output_context.invoke_renderer_for_type('error', error));\n        }\n\n        async function render_text(text, options=null) {\n            text ??= '';\n            if (typeof text !== 'string') {\n                text = text?.toString() ?? '';\n            }\n            return render('text', text, options);\n        }\n\n        const render_error = render.bind(null, 'error');\n\n        async function render_value(value) {\n            // transform value to text and then render as text\n            let text;\n            if (typeof value === 'undefined') {\n                text = '[undefined]';\n            } else if (typeof value?.toString === 'function') {\n                text = value.toString();\n            } else {\n                text = '[unprintable value]';\n            }\n            return render_text(text);\n        }\n\n        async function println(text) {\n            return render_text((text ?? '') + '\\n');\n        }\n\n        async function print__() {\n            output_context.create_child({\n                tag: 'hr',\n                attrs: {\n                    id: undefined,  // prevent generation of id\n                },\n            });\n        }\n\n        async function printf(format, ...args) {\n            if (typeof format !== 'undefined' && format !== null) {\n                if (typeof format !== 'string') {\n                    format = format.toString();\n                }\n                const text = sprintf(format, ...args);\n                return render_text(text).\n                    catch(error => output_context.invoke_renderer_for_type('error', error));\n            }\n        }\n\n        async function javascript(code, options) {  // options: { style?: Object, eval_context?: Object, inline?: Boolean }\n            return render('javascript', code, options);\n        }\n\n        // wrapper to abort the given function if the renderer is stopped\n        // this is the strategy for terminating a running evaluation...\n        function AIS(f) {\n            if (typeof f !== 'function') {\n                throw new Error('f must be a function');\n            }\n            const AsyncFunction = (async () => {}).constructor;\n            if (f instanceof AsyncFunction) {\n                return async (...args) => {\n                    abort_if_stopped(f.name ?? 'FUNCTION');\n                    return f.apply(this, args);\n                }\n            } else {\n                return (...args) => {\n                    abort_if_stopped(f.name ?? 'FUNCTION');\n                    return f.apply(this, args);\n                }\n            }\n        }\n        function abort_if_stopped(operation) {\n            if (self.stopped) {\n                throw new Error(`${operation} called after ${self.constructor.name} stopped`);\n            }\n        }\n\n        const ephemeral_eval_context = {\n            // external\n            settings:        get_settings(),\n            theme_settings:  get_theme_settings(),\n            sprintf:         AIS(sprintf),\n            // functions defined above\n            is_stopped,\n            create_worker:   AIS(create_worker),\n            import_lib:      AIS(import_lib),\n            vars:            AIS(vars),\n            delay_ms:        AIS(delay_ms),\n            next_tick:       AIS(next_tick),\n            next_micro_tick: AIS(next_micro_tick),\n            sleep:           AIS(sleep),\n            render:          AIS(render),\n            render_text:     AIS(render_text),\n            render_error:    AIS(render_error),\n            render_value:    AIS(render_value),\n            println:         AIS(println),\n            print__:         AIS(print__),\n            printf:          AIS(printf),\n            // graphics, etc\n            markdown:        AIS(render.bind(null, 'markdown')),\n            tex:             AIS(render.bind(null, 'tex')),\n            image_data:      AIS(render.bind(null, 'image-data')),\n            chart:           AIS(render.bind(null, 'chart')),\n            graphviz:        AIS(render.bind(null, 'graphviz')),\n            plotly:          AIS(render.bind(null, 'plotly')),\n            // code\n            javascript:      AIS(javascript),\n        };\n\n        return ephemeral_eval_context;\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    generate_object_id,\n} from '../../../../lib/sys/uuid.js';\n\nimport {\n    OpenPromise,\n} from '../../../../lib/sys/open-promise.js';\n\nimport {\n    assets_server_url,\n} from '../../../assets-server-url.js';\n\n\nexport class EvalWorker {\n    /** @param {null|undefined|Object} options: {\n     *      keepalive: Boolean,  // (default false) keep running after eval() or stream_eval() completes\n     *  }\n     */\n    constructor(options=null) {\n        const {\n            keepalive = false,\n        } = (options ?? {});\n\n        this.keepalive = !!keepalive;\n\n        Object.defineProperties(this, {\n            id: {\n                value: generate_object_id(),\n                enumerable: true,\n            },\n        });\n        this._worker = new Worker(this.constructor.#worker_code_uri);\n        this._terminated = false;\n        this._current_expression = undefined;\n    }\n\n    get terminated (){ return this._terminated; }\n\n    terminate() {\n        if (!this._terminated) {\n            this._reset_event_handlers();\n            this._current_expression?.terminate();\n            this._current_expression = undefined;\n            this._worker.terminate();\n            this._worker = undefined;\n            this._terminated = true;\n        }\n    }\n\n    async eval(expression, eval_context) {\n        if (this.terminated) {\n            throw new Error(`eval worker ${this.id}: worker has been terminated`);\n        }\n        if (this._current_expression) {\n            throw new Error(`eval worker ${this.id}: an expression evaluation is already in process`);\n        }\n\n        const result_promise = new OpenPromise();\n        let result_promise_fulfilled = false;\n\n        const handle_done = () => {\n            this._current_expression = undefined;\n            this._reset_event_handlers();\n            if (!result_promise_fulfilled) {\n                result_promise.reject(new Error(`eval worker ${this.id} / expression ${expression_id}: evaluation terminated`));\n            }\n            if (!this.keepalive) {\n                this.terminate();\n            }\n        };\n\n        const expression_id = generate_object_id();\n\n        const worker_message = {\n            request: 'eval',\n            id: expression_id,\n            worker_id: this.id,\n            expression,\n            eval_context,\n        };\n\n        this._current_expression = {\n            ...worker_message,\n            terminate() {\n                handle_done();\n            },\n        };\n\n        this._worker.onmessage = (event) => {\n            const result = event.data;\n            if ('value' in result) {\n                result_promise.resolve(result.value);\n            } else {\n                result_promise.reject(result.error);\n            }\n            result_promise_fulfilled = true;\n            handle_done();\n        };\n        this._worker.onerror = (event) => {\n            result_promise.reject(new Error(`eval worker ${this.id} / expression ${expression_id}: error in worker`));\n            result_promise_fulfilled = true;\n            handle_done();\n        };\n        this._worker.onmessageerror = (event) => {\n            result_promise.reject(new Error(`eval worker ${this.id} / expression ${expression_id}: serialization error in worker`));\n            result_promise_fulfilled = true;\n            handle_done();\n        };\n\n        this._worker.postMessage(worker_message);\n\n        return result_promise.promise;\n    }\n\n    // returns an async interator, i.e., this function is an async generator\n    stream_eval(expression, eval_context) {\n        if (this.terminated) {\n            throw new Error(`eval worker ${this.id}: worker has been terminated`);\n        }\n        if (this._current_expression) {\n            throw new Error(`eval worker ${this.id}: an expression evaluation is already in process`);\n        }\n\n        // at least one of pending_results and pending_promises should be empty at any given time\n        const pending_results  = [];  // values/errors waiting to be consumed\n        const pending_promises = [];  // consumed promises waiting for a value/error\n        let   done             = false;\n\n        const handle_done = () => {\n            done = true;\n            this._current_expression = undefined;\n            this._reset_event_handlers();\n            while (pending_promises.length > 0) {\n                pending_promises.shift().resolve({ done: true });\n            }\n            if (!this.keepalive) {\n                this.terminate();\n            }\n        }\n\n        const handle_result = (result) => {\n            if (done) {\n                console.warn(`eval worker ${this.id} / expression ${expression_id}: result received after done`, result);\n            } else {\n                if (pending_promises.length > 0) {\n                    if ('value' in result) {\n                        pending_promises.shift().resolve({ value: result.value });\n                    } else {\n                        pending_promises.shift().reject(result.error);\n                    }\n                } else {\n                    pending_results.push(result);\n                }\n\n                // errors terminate the stream\n                if (result.error) {\n                    handle_done();\n                }\n            }\n        }\n\n        const expression_id = generate_object_id();\n\n        const worker_message = {\n            request: 'stream_eval',\n            id: expression_id,\n            worker_id: this.id,\n            expression,\n            eval_context,\n        };\n\n        this._current_expression = {\n            ...worker_message,\n            terminate() {\n                handle_done();\n            },\n        };\n\n        this._worker.onmessage = (event) => {\n            const result = event.data;\n            if (result.done) {\n                handle_done();\n            } else {\n                handle_result(result);\n            }\n        };\n        this._worker.onerror = (event) => {\n            handle_result({ error: new Error(`eval worker ${this.id} / expression ${expression_id}: error in worker`) });\n            handle_done();\n        };\n        this._worker.onmessageerror = (event) => {\n            handle_result({ error: new Error(`eval worker ${this.id} / expression ${expression_id}: serialization error in worker`) });\n            handle_done();\n        };\n\n        this._worker.postMessage(worker_message);\n\n        return {\n            [Symbol.asyncIterator]() {\n                let i = 0;\n                return {\n                    next() {\n                        if (pending_results.length > 0) {\n                            const result = pending_results.shift()\n                            if ('value' in result) {\n                                return Promise.resolve({ value: result.value });\n                            } else {\n                                return Promise.reject(result.error);\n                            }\n                        } else if (done) {\n                            while (pending_promises.length > 0) {\n                                pending_promises.shift().reject(new Error(`eval worker ${this.id} / expression ${expression_id}: no further results available`));\n                            }\n                            return Promise.resolve({ done: true });\n                        } else {\n                            const new_promise = new OpenPromise();\n                            pending_promises.push(new_promise);\n                            return new_promise.promise;\n                        }\n                    },\n                    return() {\n                        // This will be reached if the consumer called 'break' or 'return' early in the loop.\n                        return { done: true };\n                    },\n                };\n            },\n        };\n    }\n\n    _reset_event_handlers() {\n        if (!this.terminated) {\n            this._worker.onmessage      = undefined;\n            this._worker.onerror        = undefined;\n            this._worker.onmessageerror = undefined;\n        }\n    }\n\n    // Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\n    static async _async_init_static() {\n        // create a data: URI for the web worker code so that we avoid cross-origin access errors\n        // see: https://stackoverflow.com/questions/23953543/cross-domain-web-workers\n        // and: https://github.com/CezaryDanielNowak/CrossOriginWorker/blob/main/index.js\n        const worker_path = './web-worker.js';\n        const worker_url  = new URL(worker_path, assets_server_url(current_script_url));\n        return fetch(worker_url)\n            .then(res => res.text())\n            .catch(error => {\n                throw new Error('unable to fetch worker code');\n            })\n            .then(code => {\n                const preamble = `\\\n{\n    const original_importScripts = globalThis.importScripts;\n    globalThis.importScripts = (...urls) => {\n        return original_importScripts( ...urls.map(url => new URL(url, \"${worker_url.href}\")) );\n    };\n}\n`;\n                this.#worker_code_uri = `data:text/javascript,${encodeURIComponent(preamble + code)}`;\n            });\n    }\n    static #worker_code_uri;\n}\n\n// Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\nawait EvalWorker._async_init_static();\n","import {\n    Renderer,\n} from './renderer.js';\n\nimport {\n    marked,\n} from './marked.js';\n\nimport {\n    TeXZilla,\n} from './texzilla.js';\n\nimport {\n    OutputContext,\n} from '../output-context.js';\n\n\nexport class MarkdownRenderer extends Renderer {\n    static type = 'markdown';\n\n    // options: { style?: Object }\n\n    // may throw an error\n    async render(output_context, markdown, options=null) {\n\n        markdown ??= '';\n\n        const {\n            style,\n        } = (options ?? {});\n\n        const parent = output_context.create_child({\n            attrs: {\n                'data-type': this.type,\n            },\n            style,\n        });\n        const markup = await marked.parse(markdown);  // using extensions, see below\n        parent.innerHTML = markup;\n\n        return parent;\n    }\n}\n\n\n// === MARKED EXTENSIONS ===\n\n// TeX handling adapted from: marked-katex-extension/index.js\n// https://github.com/UziTech/marked-katex-extension/blob/main/src/index.js\n// See also: https://marked.js.org/using_pro#async\n\nconst extension_name__inline    = 'inline-tex';\nconst extension_name__block     = 'block-tex';\nconst extension_name__eval_code = 'eval-code';\n\nmarked.use({\n    extensions: [\n        {\n            name: extension_name__inline,\n            level: 'inline',\n            start(src) { return src.indexOf('$'); },\n            tokenizer(src, tokens) {\n                const match = src.match(/^\\$+([^$]+?)\\$+/);\n                if (match) {\n                    return {\n                        type: extension_name__inline,\n                        raw:  match[0],\n                        text: match[1].trim(),\n                    };\n                }\n            },\n            renderer(token) {\n                const inline = true;\n                const rtl = false;//!!!\n                const exc_on_err = false;\n                return TeXZilla.toMathMLString(token.text, !inline, rtl, exc_on_err);\n            },\n        },\n        {\n            name: extension_name__block,\n            level: 'block',\n            start(src) { return src.indexOf('$$'); },\n            tokenizer(src, tokens) {\n                const match = src.match(/^\\$\\$([^$]+?)\\$\\$/);\n                if (match) {\n                    return {\n                        type: extension_name__block,\n                        raw:  match[0],\n                        text: match[1].trim(),\n                    };\n                }\n            },\n            renderer(token) {\n                const inline = false;\n                const rtl = false;//!!!\n                const exc_on_err = false;\n                return `<p>${TeXZilla.toMathMLString(token.text, !inline, rtl, exc_on_err)}</p>`;\n            },\n        },\n\n        {\n            name: extension_name__eval_code,\n            level: 'block',\n            start(src) { return src.match(/^[`]{3}[ ]*[!]/)?.index; },\n            tokenizer(src, tokens) {\n                const match = src.match(/^[`]{3}[ ]*[!](.*?)[`]{3}/s);\n                if (match) {\n                    return {\n                        type: extension_name__eval_code,\n                        raw:  match[0],\n                        text: match[1],\n                        html: '',  // filled in later by walkTokens\n                    };\n                }\n            },\n            renderer(token) {\n                return token.html;\n            },\n        },\n    ],\n\n    async: true,  // needed to tell the marked parser operate asynchronously, and to return a promise\n    async walkTokens(token) {\n        if (token.type === extension_name__eval_code) {\n            const output_element = document.createElement('div');\n            const output_context = new OutputContext(output_element);\n            const options = {\n                //!!!\n            };\n            const renderer = output_context.renderer_for_type('javascript');\n            await output_context.invoke_renderer(renderer, token.text, options)\n                .catch(error => output_context.invoke_renderer_for_type('error', error));\n            renderer?.stop();  // stop background processing, if any\n            token.html = output_element.innerHTML;\n        }\n    }\n});\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    load_script,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\nawait load_script(document.head, new URL('../../node_modules/marked/marked.min.js', assets_server_url(current_script_url)));\n\nexport const marked = globalThis.marked;\n","import {\n    Renderer,\n} from './renderer.js';\n\nimport {\n    Plotly,\n} from './plotly.js';\n\n\nexport class PlotlyRenderer extends Renderer {\n    static type = 'plotly';\n\n    // Format of config object: { data, layout, config, frames }\n    // (the sub-objects layout, config and frames are optional)\n\n    // may throw an error\n    async render(output_context, config, options) {\n        const style = options?.style;\n\n        const parent = output_context.create_child({\n            attrs: {\n                'data-type': this.type,\n            },\n        });\n        const output_element = output_context.constructor.create_element_child(parent, {\n            style,\n        });\n        await Plotly.newPlot(output_element, config);  // render to the output_element\n\n        return parent;\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    load_script,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\nawait load_script(document.head, new URL('../../node_modules/plotly.js-dist/plotly.js', assets_server_url(current_script_url)));  // defines globalThis.Plotly\n\nexport const Plotly = globalThis.Plotly;\n","import {\n    StoppableObjectsManager,\n} from '../../lib/sys/stoppable.js';\n\nimport {\n    get_renderer_classes,\n} from './_.js';\n\n\nexport class Renderer extends StoppableObjectsManager {\n    static type = undefined;  // type which instances handle; to be overridden in subclasses\n\n    get type (){ return this.constructor.type }\n\n    async render(output_context, value, options) {\n        // to be implemented by subclasses\n        throw new Error('NOT UNIMPLEMENTED');\n    }\n\n    static class_from_type(type) {\n        return this.#establish_type_to_class_mapping()[type];\n    }\n\n\n    // === TYPE TO RENDERER MAPPING ===\n\n    // importing the classes is deferred until this function is called to avoid dependency cycles\n    static #establish_type_to_class_mapping() {\n        if (!this.#type_to_class_mapping) {\n            this.#type_to_class_mapping =\n                Object.fromEntries(\n                    get_renderer_classes().map(renderer_class => {\n                        return [ renderer_class.type, renderer_class ];\n                    })\n                );\n        }\n        return this.#type_to_class_mapping;\n    }\n    static #type_to_class_mapping;  // memoization\n\n    // paths to known renderer class implementations, default-exported\n    static #renderer_paths = [\n\n        './text-renderer.js',\n        './error-renderer.js',\n        './markdown-renderer.js',\n        './tex-renderer.js',\n        './javascript-renderer/_.js',\n        './image-data-renderer.js',\n        './chart-renderer.js',\n        './graphviz-renderer.js',\n        './plotly-renderer.js',\n    ];\n}\n","import {\n    Renderer,\n} from './renderer.js';\n\nimport {\n    TeXZilla,\n} from './texzilla.js';\n\n\nexport class TeXRenderer extends Renderer {\n    static type = 'tex';\n\n    // options: { style?: Object, inline?: Boolean, rtl?: Boolean }\n\n    // may throw an error\n    async render(output_context, tex, options=null) {\n        tex ??= '';\n\n        const {\n            style,\n            inline,\n            rtl,\n        } = (options ?? {});\n\n        const parent = output_context.create_child({\n            attrs: {\n                'data-type': this.type,\n            },\n            style,\n        });\n        const exc_on_err = false;\n        const mathml = TeXZilla.toMathMLString(tex, !inline, rtl, exc_on_err);\n        parent.innerHTML = mathml;\n\n        return parent;\n    }\n}\n","import {\n    Renderer,\n} from './renderer.js';\n\n\nexport class TextRenderer extends Renderer {\n    static type = 'text';\n\n    async render(output_context, text, options) {\n        if (options?.style) {\n            const span = output_context.create_child({\n                tag: 'span',\n                attrs: {\n                    'data-type': this.type,\n                },\n                style: options.style,\n            });\n            span.innerText = text;  // innerText sanitizes text\n            return span;\n        } else {\n            return output_context.create_child_text_node(text);  // inserted as pure text\n        }\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    load_script,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\nawait load_script(document.head, new URL('../../node_modules/texzilla/TeXZilla.js', assets_server_url(current_script_url)));  // defines globalThis.TeXZilla\n\nexport const TeXZilla = globalThis.TeXZilla;\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    create_element,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    Dialog,\n    AlertDialog,\n    create_control_element,\n    create_select_element,\n} from '../../lib/ui/dialog/_.js';\n\nimport {\n    get_obj_path,\n    set_obj_path,\n} from '../../lib/sys/obj-path.js';\n\nimport {\n    get_settings,\n    update_settings,\n    analyze_editor_options_indentUnit,\n    analyze_editor_options_tabSize,\n    analyze_editor_options_indentWithTabs,\n    valid_editor_options_keyMap_values,\n    analyze_editor_options_keyMap,\n    valid_formatting_options_align_values,\n    analyze_formatting_options_align,\n    analyze_formatting_options_indent,\n    valid_theme_colors_values,\n    analyze_theme_colors,\n} from '../settings.js';\n\nimport {\n    beep,\n} from '../../lib/ui/beep.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\n// import {\n//     create_stylesheet_link,\n// } from '../../lib/ui/dom-util.js';\n// {\n//     const stylesheet_url = new URL('./settings-dialog.css', assets_server_url(current_script_url));\n//     create_stylesheet_link(document.head, stylesheet_url);\n// }\nimport './settings-dialog.css';  // webpack implementation\n\n\n// dialog definitiion\n\nconst sections = [{\n    section: {\n        name: 'Editor',\n        settings: [{\n            id: 'editor_options_indentUnit',\n            label: 'Indent',\n            type: 'text',\n            settings_path: [ 'editor_options', 'indentUnit' ],\n            analyze: (value) => analyze_editor_options_indentUnit(value, 'Indent'),\n            convert_to_number: true,\n        }, {\n            id: 'editor_options_tabSize',\n            label: 'Tab size',\n            type: 'text',\n            settings_path: [ 'editor_options', 'tabSize' ],\n            analyze: (value) => analyze_editor_options_tabSize(value, 'Tab size'),\n            convert_to_number: true,\n        }, {\n            id: 'editor_options_indentWithTabs',\n            label: 'Indent with tabs',\n            type: 'checkbox',\n            settings_path: [ 'editor_options', 'indentWithTabs' ],\n            analyze: (value) => analyze_editor_options_indentWithTabs(value, 'Indent with tabs'),\n        }, {\n            id: 'editor_options_keyMap',\n            label: 'Key map',\n            type: 'select',\n            options: valid_editor_options_keyMap_values.map(value => ({ value, label: value })),\n            settings_path: [ 'editor_options', 'keyMap' ],\n            analyze: (value) => analyze_editor_options_keyMap(value, 'Key map'),\n        }],\n    },\n}, {\n    section: {\n        name: 'TeX Formatting',\n        settings: [{\n            id: 'formatting_options_align',\n            label: 'Horizontal alignment',\n            type: 'select',\n            options: valid_formatting_options_align_values.map(value => ({ value, label: value })),\n            settings_path: [ 'formatting_options', 'align' ],\n            analyze: (value) => analyze_formatting_options_align(value, 'Align'),\n        }, {\n            id: 'formatting_options_indent',\n            label: 'Indentation',\n            type: 'text',\n            settings_path: [ 'formatting_options', 'indent' ],\n            analyze: (value) => analyze_formatting_options_indent(value, 'Indentation'),\n        }],\n    },\n}, {\n    section: {\n        name: 'Appearance',\n        settings: [{\n            id: 'theme_colors',\n            label: 'Theme',\n            type: 'select',\n            options: valid_theme_colors_values.map(value =>({ value, label: value })),\n            settings_path: [ 'theme_colors' ],\n            analyze: (value) => analyze_theme_colors(value, 'Theme colors'),\n        }],\n    },\n}];\n\n\nexport class SettingsDialog extends Dialog {\n    static settings_dialog_css_class = 'settings-dialog';\n\n    static run(message, options) {\n        const pre_existing_element = document.querySelector(`#content #ui .${this.settings_dialog_css_class}`);\n        if (pre_existing_element) {\n            const pre_existing_instance = Dialog.instance_from_element(pre_existing_element);\n            if (!pre_existing_instance) {\n                throw new Error(`unexpected: Dialog.instance_from_element() returned null for element with class ${this.settings_dialog_css_class}`);\n            }\n            return pre_existing_instance.promise;\n        } else {\n            return new this().run();\n        }\n    }\n\n    _populate_dialog_element() {\n        const current_settings = get_settings();\n\n        // make this dialog identifiable so that the static method run()\n        // can find it if it already exists.\n        this._dialog_element.classList.add(this.constructor.settings_dialog_css_class);\n\n        this._dialog_text_container.innerText = 'Settings';\n\n        for (const { section } of sections) {\n            const { name, settings } = section;\n            const section_div = create_element({ parent: this._dialog_form, attrs: { class: 'section' } });\n\n            const named_section_div = create_element({ parent: section_div, attrs: { 'data-section': name } });\n            const error_div = create_element({ parent: section_div, attrs: { class: `error-message` } });\n\n            for (const setting of settings) {\n                const { id, label, type, settings_path, options, analyze, convert_to_number } = setting;\n                const setting_div = create_element({ parent: named_section_div, attrs: { 'data-setting': undefined } });\n                let control;\n                if (type === 'select') {\n                    control = create_select_element(setting_div, id, {\n                        label,\n                        options,\n                    });\n                } else {\n                    control = create_control_element(setting_div, id, {\n                        label,\n                        type,\n                    });\n                }\n\n                if (type === 'checkbox') {\n                    control.checked = get_obj_path(current_settings, settings_path);\n                } else {\n                    control.value = get_obj_path(current_settings, settings_path);\n                }\n\n                const update_handler = async (event) => {\n                    const current_settings = get_settings();\n\n                    const handle_error = async (error_message) => {\n                        error_div.classList.add('active');\n                        error_div.innerText = error_message;\n                        const existing_control = document.getElementById(control.id);\n                        if (!this._completed && existing_control) {\n                            existing_control.focus();\n                            if (existing_control instanceof HTMLInputElement && existing_control.type === 'text') {\n                                existing_control.select();\n                            }\n                            await beep();\n                        } else {\n                            await AlertDialog.run(`settings update failed: ${error_message}`);\n                        }\n                    };\n\n                    const value = (type === 'checkbox') ? control.checked : control.value;\n                    if (analyze) {\n                        const complaint = analyze(value)\n                        if (complaint) {\n                            await handle_error(complaint);\n                            return;\n                        }\n                    }\n                    set_obj_path(current_settings, settings_path, (convert_to_number ? +value : value));\n\n                    try {\n                        await update_settings(current_settings)\n                        error_div.classList.remove('active');\n                    } catch (error) {\n                        await handle_error(error.message);\n                    }\n                };\n\n                control.addEventListener('change', update_handler);\n                control.addEventListener('blur',   update_handler);\n            }\n        }\n\n        // Done button should not cause Enter to automatically submit the form\n        // unless directly clicked.\n        const accept_button = create_element({\n            parent: this._dialog_form,\n            tag:    'input',\n            attrs: {\n                type: 'button',\n                value: 'Done',\n            },\n        });\n        accept_button.onclick = (event) => this._dialog_element.close();\n\n        this._dialog_element.onclose = (event) => this._complete();\n    }\n}\n","import {\n    Subscribable,\n} from '../lib/sys/subscribable.js';\n\nimport {\n    deep_freeze,\n} from '../lib/sys/util.js';\n\nimport {\n    db_key_settings,\n    storage_db,\n} from './storage.js';\n\n\n// === INITIAL SETTINGS ===\n\nexport const initial_settings = {\n    editor_options: {\n        indentUnit:     2,\n        tabSize:        4,\n        indentWithTabs: false,\n        keyMap:         'default',\n    },\n    formatting_options: {\n        align:  'left',\n        indent: '0em',\n    },\n    theme_colors: 'system',\n};\ndeep_freeze(initial_settings);\n\n\n// === EVENT INTERFACE ===\n\nfunction copy_settings(settings) {\n    return JSON.parse(JSON.stringify(settings));\n}\n\nexport const settings_updated_events = new Subscribable();\n\n\n// === GENERIC VALIDATION ===\n\nconst numeric_re = /^([+-]?[0-9]+[.][0-9]*[Ee][+-]?[0-9]+|[+-]?[.][0-9]+[Ee][+-]?[0-9]+|[+-]?[0-9]+[Ee][+-]?[0-9]+|[+-]?[0-9]+[.][0-9]*|[+-]?[.][0-9]+|[+-]?[0-9]+)$/;\n\n/** validate test_value for being numeric\n *  @param {string|number} test_value string (or number) to be tested\n *  @param {Object|undefined} options an object that may contain values for any of the following flags:\n *             require_integer\n *             reject_negative\n *             reject_zero\n *             reject_positive\n *  @return {boolean} result of validation\n */\nexport function validate_numeric(test_value, options) {\n    const {\n        require_integer,\n        reject_negative,\n        reject_zero,\n        reject_positive,\n    } = (options ?? {})\n\n    let numeric_value;\n    if (typeof test_value === 'number') {\n        numeric_value = test_value;\n    } else {\n        if (typeof test_value !== 'string') {\n            return false;\n        }\n        if (!test_value.trim().match(numeric_re)) {\n            return false;\n        }\n        numeric_value = Number.parseFloat(test_value);\n    }\n\n    if ( isNaN(numeric_value)                                  ||\n         (require_integer && !Number.isInteger(numeric_value)) ||\n         (reject_positive && numeric_value >   0)              ||\n         (reject_zero     && numeric_value === 0)              ||\n         (reject_negative && numeric_value <   0)                 ) {\n        return false;\n    }\n    return true;\n}\n\n/** check if test_value is in a collection of objects\n *  @param {any} test_value value to be tested if it is in collection\n *  @param {Array} collection objects to test membership in\n *  @param {string} name (Optional) name to use for test_value\n *  @return {string|undefined} complaint string if not in collection, or undefined if it is.\n */\nexport function analyze_contained(test_value, collection, name) {\n    if (!collection.includes(test_value)) {\n        return `${name ?? 'value'} must be one of: ${collection.join(', ')}`;\n    }\n    return undefined;\n}\n\n\n// === SETTINGS VALIDATION ===\n\nexport function analyze_editor_options_indentUnit(value, name) {\n    if (!validate_numeric(value, { require_integer: true, reject_negative: true })) {\n        return `${name ?? 'indentUnit'} must be a non-negative integer`;\n    }\n    return undefined;\n}\nexport function analyze_editor_options_tabSize(value, name) {\n    if (!validate_numeric(value, { require_integer: true, reject_negative: true })) {\n        return `${name ?? 'tabSize'} must be a non-negative integer`;\n    }\n    return undefined;\n}\nexport function analyze_editor_options_indentWithTabs(value, name) {\n    if (typeof value !== 'boolean') {\n        return `${name ?? 'indentWithTabs'} must be a boolean value`;\n    }\n    return undefined;\n}\nexport const valid_editor_options_keyMap_values = ['default', 'emacs', 'sublime', 'vim'];\nexport function analyze_editor_options_keyMap(value, name) {\n    return analyze_contained(value, valid_editor_options_keyMap_values, (name ?? 'keyMap'));\n}\n\nexport function analyze_editor_options(editor_options, name) {\n    if (typeof editor_options !== 'object') {\n        return `${name ?? 'editor_options'} must be an object`;\n    }\n    const keys = Object.keys(editor_options);\n    if (!keys.every(k => ['indentUnit', 'tabSize', 'indentWithTabs', 'keyMap'].includes(k))) {\n        return `${name ?? 'editor_options'} may only have the keys \"indentUnit\", \"tabSize\", \"indentWithTabs\" and \"keyMap\"`;\n    }\n    if ('indentUnit' in editor_options) {\n        const complaint = analyze_editor_options_indentUnit(editor_options.indentUnit);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    if ('tabSize' in editor_options) {\n        const complaint = analyze_editor_options_tabSize(editor_options.tabSize);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    if ('indentWithTabs' in editor_options) {\n        const complaint = analyze_editor_options_indentWithTabs(editor_options.indentWithTabs);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    if ('keyMap' in editor_options) {\n        const complaint = analyze_editor_options_keyMap(editor_options.keyMap);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    return undefined;\n}\n\nexport const valid_formatting_options_align_values = ['left', 'center', 'right'];\n/** analyze/validate a formatting_options align property\n *  @param {string} value\n *  @return {string|undefined} returns a complaint string if invalid, or undefined if valid\n */\nexport function analyze_formatting_options_align(value, name) {\n    return analyze_contained(value, valid_formatting_options_align_values, (name ?? 'align'));\n}\nexport const valid_formatting_options_indent_units = ['pt', 'pc', 'in', 'cm', 'mm', 'em', 'ex', 'mu'];\n/** analyze/validate a formatting_options indent property\n *  @param {string} value\n *  @return {string|undefined} returns a complaint string if invalid, or undefined if valid\n */\nexport function analyze_formatting_options_indent(value, name) {\n    if (!valid_formatting_options_indent_units.every(s => (s.length === 2))) {\n        throw new Error('unexpected: valid units contains a string whose length is not 2');\n    }\n    const complaint = `${name ?? 'indent'} must be a string containing a non-negative number followed by one of: ${valid_formatting_options_indent_units.join(', ')}`;\n    if (typeof value !== 'string') {\n        return complaint;\n    }\n    // all valid units strings are length 2\n    value = value.trim();\n    const amount_str = value.slice(0, -2);\n    const units      = value.slice(-2);\n    if ( !validate_numeric(amount_str, { reject_negative: true }) ||\n         !valid_formatting_options_indent_units.includes(units) ) {\n        return complaint;\n    }\n    return undefined;\n}\n/** analyze/validate a formatting_options object\n *  @param {Object} formatting_options: { align?: string, indent?: string }\n *  @return {string|undefined} returns a complaint string if invalid, or undefined if valid\n */\nexport function analyze_formatting_options(formatting_options, name) {\n    if (typeof formatting_options !== 'object') {\n        return `${name ?? 'formatting_options'} must be an object`;\n    }\n    const keys = Object.keys(formatting_options);\n    if (!keys.every(k => ['align', 'indent'].includes(k))) {\n        return `${name ?? 'formatting_options'} may only have the keys \"align\" and \"indent\"`;\n    }\n    if ('align' in formatting_options) {\n        const complaint = analyze_formatting_options_align(formatting_options.align);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    if ('indent' in formatting_options) {\n        const complaint = analyze_formatting_options_indent(formatting_options.indent);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    return undefined;\n}\n\nexport const valid_theme_colors_values = ['system', 'dark', 'light'];\nexport function analyze_theme_colors(value, name) {\n    return analyze_contained(value, valid_theme_colors_values, (name ?? 'theme_colors'));\n}\n\nexport function analyze_settings(settings, name) {\n    if (typeof settings !== 'object') {\n        return `${name ?? 'settings'} must be an object`;\n    }\n    const keys = Object.keys(settings);\n    if (!keys.every(k => ['editor_options', 'formatting_options', 'theme_colors'].includes(k))) {\n        return `${name ?? 'settings'} may only have the keys \"editor_options\", \"formatting_options\" and \"theme_colors\"`;\n    }\n    if (!('editor_options' in settings)) {\n        return `${name ?? 'settings'} must contain an editor_options property`;\n    } else {\n        const complaint = analyze_editor_options(settings.editor_options);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    if (!('formatting_options' in settings)) {\n        return `${name ?? 'settings'} must contain an formmating_options property`;\n    } else {\n        const complaint = analyze_formatting_options(settings.formatting_options);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    if (!('theme_colors' in settings)) {\n        return `${name ?? 'settings'} must contain an theme_colors property`;\n    } else {\n        const complaint = analyze_theme_colors(settings.theme_colors);\n        if (complaint) {\n            return complaint;\n        }\n    }\n    return undefined;\n}\n\n// validate initial_settings\n(() => {\n    const complaint = analyze_settings(initial_settings);\n    if (complaint) {\n        throw new Error(`initial_settings: ${complaint}`);\n    }\n})();\n\n\n// === STORAGE ===\n\n// may throw an error if the settings value is corrupt or circular\nasync function put_settings_to_storage(settings) {\n    return storage_db.put(db_key_settings, settings);\n}\n\n// may throw an error if settings value corrupt and unable to store initial settings\nasync function get_settings_from_storage() {\n    try {\n        const settings = await storage_db.get(db_key_settings);\n        if (!analyze_settings(settings)) {\n            return settings;\n        }\n        // otherwise, if !settings, fall out to reset...\n    } catch (_) {\n        // if error, fall out to reset...\n    }\n    // Either settings_string was null or an error occurred when parsing, so reset\n    await put_settings_to_storage(initial_settings);\n    return initial_settings;\n}\n\nlet current_settings = await get_settings_from_storage();\nexport async function _reset_settings() {\n    return update_settings(initial_settings);\n}\nexport function get_settings() {\n    // return a copy to insulate receivers from each other's modifications\n    return copy_settings(current_settings);\n}\n\n// may throw an error if the new_settings value is corrupt or circular\nexport async function update_settings(new_settings) {\n    const complaint = analyze_settings(new_settings);\n    if (complaint) {\n        throw new Error(complaint);\n    }\n    await put_settings_to_storage(new_settings);  // may throw an error\n    current_settings = new_settings;\n    settings_updated_events.dispatch();\n}\n","import {\n    IndexedDBInterface,\n} from '../lib/sys/idb.js';\n\n\n// db_key_settings uses a UUID, but this must be constant,\n// not generated each time the system is loaded.\nexport const db_key_settings = 'settings-6c32f9d6-796c-4588-8a4b-35165a13d14d';\n\n// db_key_recents uses a UUID, but this must be constant,\n// not generated each time the system is loaded.\nexport const db_key_recents = 'recents-40c4dfe4-2aa5-4ac9-9143-80c93b7e0ed8';\n\nexport const storage_db = new IndexedDBInterface();\n","export const default_database_name       = 'property-database-7a11272a-fce1-4e39-951c-44c375bc75ca';\nexport const default_database_store_name = 'property-database-store-7a11272a-fce1-4e39-951c-44c375bc75ca';\n\nexport class IndexedDBInterface {\n    constructor(database_name=default_database_name, database_store_name=default_database_store_name) {\n        Object.defineProperties(this, {\n            database_name: {\n                value: database_name,\n            },\n            database_store_name: {\n                value: database_store_name,\n                enumerable: true,\n            },\n            _startup_promise: {\n                value: new Promise((resolve, reject) => {\n                    const request = indexedDB.open(database_name, 1);\n                    request.onerror   = () => reject(request.error);\n                    request.onsuccess = () => resolve(request.result);\n                    request.onupgradeneeded = () => {\n                        // create empty object store (first time upgrade)\n                        request.result.createObjectStore(database_store_name);\n                    };\n                }),\n            },\n        });\n    }\n\n    async with_object_store(mode, receiver) {\n        const db = await this._startup_promise;\n        return new Promise((resolve, reject) => {\n            const transaction = db.transaction(this.database_store_name, mode);\n            transaction.oncomplete = () => resolve();\n            transaction.onabort = transaction.onerror = () => reject(transaction.error);\n            receiver(transaction.objectStore(this.database_store_name));\n        });\n    }\n\n    async get(key) {\n        let req;\n        await this.with_object_store('readonly', store => {\n            req = store.get(key);\n        });\n        return req.result;\n    }\n\n    async put(key, value) {\n        return this.with_object_store('readwrite', store => {\n            store.put(value, key);\n        });\n    }\n\n    async delete(key) {\n        return this.with_object_store('readwrite', store => {\n            store.delete(key);\n        });\n    }\n\n    async clear() {\n        return this.with_object_store('readwrite', store => {\n            store.clear();\n        });\n    }\n\n    async keys() {\n        let req;\n        await this.with_object_store('readonly', store => {\n            req = store.getAllKeys();\n        });\n        return req.result;\n    }\n}\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    Subscribable,\n} from '../../lib/sys/subscribable.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n\n// import {\n//     create_stylesheet_link,\n// } from '../../lib/ui/dom-util.js';\n// // add theme-settings/theme-colors.css stylesheet\n// const theme_colors_stylesheet_url = new URL('theme-colors.css', assets_server_url(current_script_url));\n// create_stylesheet_link(document.head, theme_colors_stylesheet_url);\nimport './theme-colors.css';  // webpack implementation\n\n\n// === THEME SETTINGS INTERFACE ===\n\nconst dark_mode_media_query_list = globalThis.matchMedia(\"(prefers-color-scheme: dark)\");\n\nexport function get_theme_settings() {\n    // return a new copy to insulate receivers from each others' modifications\n    return {\n        shouldUseDarkColors: dark_mode_media_query_list.matches,\n    };\n}\n\ndark_mode_media_query_list.addEventListener('change', function (event) {\n    theme_settings_updated_events.dispatch();\n});\n\n\n// === EVENT INTERFACE ===\n\nexport const theme_settings_updated_events = new Subscribable();\n\n\n// === DOCUMENT DARK THEME SETTING ===\n\nconst dark_mode_class = 'dark';\n\nconst root_element = document.documentElement;\n\nexport function update_document_dark_state(dark_state) {\n    if (dark_state) {\n        root_element.classList.add(dark_mode_class);\n    } else {\n        root_element.classList.remove(dark_mode_class);\n    }\n}\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n       export default content && content.locals ? content.locals : undefined;\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    EventListenerManager,\n} from '../../lib/sys/event-listener-manager.js';\n\nimport {\n    create_element,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n// import {\n//     create_stylesheet_link,\n// } from '../../lib/ui/dom-util.js';\n// create_stylesheet_link(document.head, new URL('./style.css', assets_server_url(current_script_url)));\nimport './style.css';  // webpack implementation\n\n\nexport class ToggleSwitchElement extends HTMLElement {\n    static custom_element_name = 'toggle-switch';\n\n    static create(options=null) {\n        const {\n            parent,\n            class: cls,\n            title_for_on,\n            title_for_off,\n            svg,\n        } = (options ?? {});\n        const control = create_element({\n            parent,\n            tag: this.custom_element_name,\n            attrs: {\n                class: cls,\n                role: 'switch',\n                \"aria-checked\": false,\n                title: title_for_off,\n            },\n        });\n        control.#event_listener_manager.add(control, 'change', (event) => {\n            control.title = control.get_state() ? title_for_on : title_for_off;\n        });\n        return control;\n    }\n\n    constructor() {\n        super();\n//        this.setAttribute('role', 'switch');\n//        this.setAttribute('aria-checked', this.get_state());  // ensure 'aria-checked' is set\n        this.#event_listener_manager = new EventListenerManager();\n        this.#event_listener_manager.add(this, 'click', (event) => {\n            this.set_state();\n        });\n    }\n    #event_listener_manager;\n\n    get_state() {\n        return (this.getAttribute('aria-checked') === 'true');\n    }\n\n    set_state(new_state=null) {\n        const old_state = this.get_state();\n        new_state ??= !old_state;  // if no argument, then toggle state\n        new_state = !!new_state;\n        this.setAttribute('aria-checked', new_state);\n        if (old_state !== new_state) {\n            this.dispatchEvent(new Event('change'));\n        }\n    }\n\n\n    // === WEB COMPONENT LIFECYCLE ===\n\n    // connectedCallback:\n    //     Invoked each time the custom element is appended into a document-connected element.\n    //     This will happen each time the node is moved, and may happen before the element's contents have been fully parsed.\n    //     Note: connectedCallback may be called once your element is no longer connected, use Node.isConnected to make sure.\n    connectedCallback() {\n        this.#event_listener_manager.reattach();\n    }\n\n    // disconnectedCallback:\n    //     Invoked each time the custom element is disconnected from the document's DOM.\n    disconnectedCallback() {\n        // event handlers have been disconnected, but just leave things alone so we can reconnect\n    }\n\n    // adoptedCallback:\n    //     Invoked each time the custom element is moved to a new document.\n    adoptedCallback() {\n        this.#event_listener_manager.reattach();\n    }\n\n    // attributeChangedCallback:\n    //     Invoked each time one of the custom element's attributes is added, removed, or changed.\n    //     Which attributes to notice change for is specified in a static get observedAttributes method\n    attributeChangedCallback(name, old_value, new_value) {\n        switch (name) {\n        case 'xyzzy': {\n            //!!!\n            break;\n        }\n        }\n        //!!!\n    }\n\n    static get observedAttributes() {\n        return [\n            'xyzzy',//!!!\n        ];\n    }\n\n\n    // === INTERNAL ===\n\n    // Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\n    static _init_static() {\n        globalThis.customElements.define(this.custom_element_name, this);\n    }\n}\n\n// Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\nToggleSwitchElement._init_static();\n","const current_script_url = import.meta.url;  // save for later\n\nimport {\n    ToggleSwitchElement,\n} from '../toggle-switch-element/_.js';\n\nimport {\n    EventListenerManager,\n} from '../../lib/sys/event-listener-manager.js';\n\nimport {\n    get_evaluator_classes,\n} from '../evaluator/_.js';\n\nimport {\n    create_element,\n    clear_element,\n} from '../../lib/ui/dom-util.js';\n\nimport {\n    assets_server_url,\n} from '../assets-server-url.js';\n\n// import {\n//     create_stylesheet_link,\n// } from '../../lib/ui/dom-util.js';\n// create_stylesheet_link(document.head, new URL('./style.css', assets_server_url(current_script_url)));\nimport './style.css';  // webpack implementation\n\n\nexport class ToolBarElement extends HTMLElement {\n    static custom_element_name = 'tool-bar';\n\n    static indicator_control__class            = 'tool-bar-indicator';\n    static indicator_control__attribute__value = 'data-indicator-value';\n\n    static toggle_switch__editable__class = 'tool-bar-toggle-editable';\n    static toggle_switch__visible__class  = 'tool-bar-toggle-visible';\n    static toggle_switch__autoeval__class = 'tool-bar-toggle-autoeval';\n\n    /** create a new ToolBarElement in the document, then set target with options\n     *  @param {any} target\n     *  @param {Object|null|undefined} options to be passed to set_target()\n     *  @return {ToolBarElement} tool bar element\n     */\n    static create_for(target, options) {\n        const tool_bar = document.createElement(this.custom_element_name);\n        if (!tool_bar) {\n            throw new Error('error creating tool bar');\n        }\n        try {\n            tool_bar.set_target(target, options);\n            return tool_bar;\n        } catch (error) {\n            tool_bar.remove();\n            throw error;\n        }\n    }\n\n    constructor() {\n        super();\n        this.#target = null;\n        this.#event_listener_manager = new EventListenerManager();\n        this.#reset_configuration();\n        this.addEventListener('pointerdown', (event) => {\n            this.#target.focus();\n            if (event.target instanceof ToolBarElement) {\n                // stop event only if target is directly a ToolBarElement, not one of its children\n                event.preventDefault();\n                event.stopPropagation();\n            }\n        });  // this listener is never removed\n    }\n    #event_listener_manager;\n    #controls;  // name -> { name?, control?, get?, set?}\n\n    set_type(type) {\n        this.set_for('type', type);\n    }\n\n\n    // === TARGET ===\n\n    #target;\n\n    /** @return {any} current target\n     */\n    get target (){ return this.#target; }\n\n    /** set the target for this tool bar\n     *  @param {any} target\n     *  @param {Object|null|undefined} options: {\n     *      editable?: { initial?, on? },\n     *      visible?,  { initial?, on? },\n     *      autoeval?, { initial?, on? },\n     *      type?,     { initial?, on? },\n     *      running?,  { initial?, on? },\n     *      modified?, { initial?, on? },\n     *      run?,      { initial?, on? },\n     *  }\n     * A prior target, if any, is silently replaced.\n     */\n    set_target(target, options=null) {\n        if (target !== null && typeof target !== 'undefined' && !(target instanceof EventTarget)) {\n            throw new Error('target must be null, undefined, or and instance of EventTarget');\n        }\n        if (!target) {\n            this.#target = null;\n            this.#reset_configuration();\n        } else {\n            if (this.#target !== target) {\n                this.#target = target;\n                this.#configure(options);\n            }\n        }\n    }\n\n    get_for(name, value) {\n        if (!(name in this.#controls)) {\n            throw new Error('unknown name');\n        }\n        return this.#controls[name].get();\n    }\n    set_for(name, value) {\n        if (!(name in this.#controls)) {\n            throw new Error('unknown name');\n        }\n        this.#controls[name].set(value);\n    }\n\n\n    // === CONFIGURATION ===\n\n    /** set up controls, etc according to options\n     *  @param {Object|null|undefined} options from set_target()\n     */\n    #configure(options=null) {\n        options ??= {};\n        this.#reset_configuration();\n        try {\n            for (const [ name, create, getter, setter ] of this.#get_control_setup()) {\n                let control_options = options[name];\n                if (control_options) {\n                    if (typeof control_options !== 'object') {\n                        control_options = {};\n                    }\n\n                    const control = create(control_options.on);\n                    if ('initial' in control_options) {\n                        setter(control, control_options.initial);\n                    }\n\n                    this.#controls[name] = {\n                        name,\n                        control,\n                        get: getter.bind(ToolBarElement, control),\n                        set: setter.bind(ToolBarElement, control),\n                    };\n                }\n            }\n        } catch (error) {\n            this.#reset_configuration();\n            throw error;\n        }\n    }\n\n    #reset_configuration() {\n        this.#event_listener_manager.remove_all();\n        clear_element(this);\n        this.#controls = {};\n    }\n\n    /** @return array of { name, create, getter, setter }\n     */\n    #get_control_setup() {\n        return [\n            // the order of this array determines order of control creation\n\n            // NAME       CREATE_FN,                         GETTER_FN                           SETTER_FN\n            [ 'running',  this.#create__running.bind(this),  this.constructor.#getter__running,  this.constructor.#setter__running  ],\n            [ 'modified', this.#create__modified.bind(this), this.constructor.#getter__modified, this.constructor.#setter__modified ],\n            [ 'editable', this.#create__editable.bind(this), this.constructor.#getter__editable, this.constructor.#setter__editable ],\n            [ 'visible',  this.#create__visible.bind(this),  this.constructor.#getter__visible,  this.constructor.#setter__visible  ],\n            [ 'autoeval', this.#create__autoeval.bind(this), this.constructor.#getter__autoeval, this.constructor.#setter__autoeval ],\n            [ 'run',      this.#create__run.bind(this),      this.constructor.#getter__run,      this.constructor.#setter__run      ],\n            [ 'type',     this.#create__type.bind(this),     this.constructor.#getter__type,     this.constructor.#setter__type     ],\n        ];\n    }\n\n\n    // === CONTROL HANDLING ===\n\n    #create__editable(on_change_handler=null) {\n        const control = ToggleSwitchElement.create({\n            parent: this,\n            class:  this.constructor.toggle_switch__editable__class,\n            title_for_on:  'edit mode on',\n            title_for_off: 'edit mode off',\n        });\n        control.innerHTML = `\\\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!--\n    Adapted from: https://commons.wikimedia.org/wiki/File:Ei-pencil.svg\n    Alexander Madyankin, Roman Shamin, MIT <http://opensource.org/licenses/mit-license.php>, via Wikimedia Commons\n-->\n<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  version=\"1.1\"\n  viewBox=\"0 0 50 50\"\n>\n  <path class=\"accent-fill\" d=\"M9.6 40.4 l2.5 -9.9 L27 15.6 l7.4 7.4 -14.9 14.9 -9.9 2.5z m4.3 -8.9 l-1.5 6.1 6.1 -1.5 L31.6 23 27 18.4 13.9 31.5z\"/>\n  <path class=\"accent-fill\" d=\"M17.8 37.3 c-.6 -2.5 -2.6 -4.5 -5.1 -5.1 l.5 -1.9 c3.2 .8 5.7 3.3 6.5 6.5 l-1.9 .5z\"/>\n  <path class=\"accent-fill\" d=\"M29.298 19.287 l1.414 1.414 -13.01 13.02 -1.414 -1.412z\"/>\n  <path class=\"accent-fill\" d=\"M11 39 l2.9 -.7 c-.3 -1.1 -1.1 -1.9 -2.2 -2.2 L11 39z\"/>\n  <path class=\"accent-fill\" d=\"M35 22.4 L27.6 15 l3-3 .5.1 c3.6 .5 6.4 3.3 6.9 6.9 l.1 .5 -3.1 2.9z M30.4 15 l4.6 4.6 .9 -.9 c-.5 -2.3 -2.3 -4.1 -4.6 -4.6 l-.9 .9z\"/>\n</svg>\n`;\n        if (on_change_handler) {\n            this.#event_listener_manager.add(control, 'change', on_change_handler);\n        }\n        return control;\n    }\n    static #getter__editable(control)        { return control.get_state(); }\n    static #setter__editable(control, value) { control.set_state(value); }\n\n    #create__visible(on_change_handler=null) {\n        const control = ToggleSwitchElement.create({\n            parent: this,\n            class:  this.constructor.toggle_switch__visible__class,\n            title_for_on:  'visible',\n            title_for_off: 'not visible',\n        });\n        control.innerHTML = `\\\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!--\n    Adapted from: https://commons.wikimedia.org/wiki/File:ISO_7000_-_Ref-No_2030.svg\n    Vectorization:  Mrmw, CC0, via Wikimedia Commons\n-->\n<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  version=\"1.1\"\n  viewBox=\"0 0 200 170\"\n>\n  <path class=\"accent-stroke\" stroke=\"#000\" stroke-width=\"5\" fill=\"transparent\"\n    d=\"m100 49.738 a97.452 97.452 0 0 0 -78.246 39.775 97.452 97.452 0 0 0 78.246 39.773 97.452 97.452 0 0 0 78.396 -39.975 97.452 97.452 0 0 0 -78.396 -39.574z\"\n  />\n  <circle class=\"accent-stroke accent-fill\" stroke=\"#000\" stroke-width=\"5\"\n    cx=\"100\" cy=\"89.438\" r=\"19.85\"\n  />\n</svg>\n`;\n        if (on_change_handler) {\n            this.#event_listener_manager.add(control, 'change', on_change_handler);\n        }\n        return control;\n    }\n    static #getter__visible(control)        { return control.get_state(); }\n    static #setter__visible(control, value) { control.set_state(value); }\n\n    #create__autoeval(on_change_handler=null) {\n        const control = create_element({\n            parent: this,\n            tag: 'input',\n            attrs: {\n                type: 'checkbox',\n                title: 'autoeval...',\n            },\n        });\n        if (on_change_handler) {\n            this.#event_listener_manager.add(control, 'change', on_change_handler);\n        }\n        this.#event_listener_manager.add(control, 'change', (event) => {\n            control.title = control.checked ? 'autoeval off...' : 'autoeval on...';\n        });\n        return control;\n    }\n    static #getter__autoeval(control)        { return control.checked; }\n    static #setter__autoeval(control, value) { control.checked = !!value; }\n\n    #create__type(on_change_handler=null) {\n        const control = create_element({\n            parent: this,\n            tag: 'select',\n            attrs: {\n                title: 'type...',\n            },\n        });\n\n        const types = new Set(get_evaluator_classes().map(e => e.handled_input_types).flat()).values();\n        let subsequent = false;\n        for (const type of types) {\n            create_element({\n                parent: control,\n                tag: 'option',\n                attrs: {\n                    title: 'type...',\n                    label: type,\n                    ...(subsequent ? {} : { selected: !subsequent }),  // first entry is default\n                    value: type,\n                },\n            });\n            subsequent = true;\n        }\n\n        if (on_change_handler) {\n            this.#event_listener_manager.add(control, 'change', on_change_handler);\n        }\n        this.#event_listener_manager.add(control, 'change', (event) => {\n            control.title = `type ${control.value}`;\n        });\n        return control;\n    }\n    static #getter__type(control)        { return control.value; }\n    static #setter__type(control, value) {\n        if (![ ...control.options ].map(option => option.value).includes(value)) {  //!!! what a kludge...\n            throw new Error('setting unknown/illegal value');\n        }\n        control.value = value;\n    }\n\n    #create__running(on_change_handler=null) {\n        return this.#indicator_control__create_with_class_and_title('running', 'running...', 'done...', on_change_handler);\n    }\n    static #getter__running(control)        { return this.#indicator_control__getter(control); }\n    static #setter__running(control, value) { this.#indicator_control__setter(control, value); }\n\n    #create__modified(on_change_handler=null) {\n        return this.#indicator_control__create_with_class_and_title('modified', 'modified...', 'not modified...', on_change_handler);\n    }\n    static #getter__modified(control)        { return this.#indicator_control__getter(control); }\n    static #setter__modified(control, value) { this.#indicator_control__setter(control, value); }\n\n    #create__run(on_change_handler=null) {\n        //!!!\n    }\n    static #getter__run(control) {\n        //!!!\n    }\n    static #setter__run(control, value) {\n        //!!!\n    }\n\n    // indicator control getter/setter\n    #indicator_control__create_with_class_and_title(css_class, title_for_on, title_for_off, on_change_handler=null) {\n        const control = create_element({\n            parent: this,\n            attrs: {\n                title: title_for_off,\n                class: `${this.constructor.indicator_control__class} ${css_class}`,\n            },\n        });\n        if (on_change_handler) {\n            this.#event_listener_manager.add(control, 'change', on_change_handler);\n        }\n        this.#event_listener_manager.add(control, 'change', (event) => {\n            control.title = this.constructor.#indicator_control__getter(control) ? title_for_on : title_for_off;\n        });\n        return control;\n    }\n    static #indicator_control__getter(control) {\n        return !!control.getAttribute(this.indicator_control__attribute__value);\n    }\n    static #indicator_control__setter(control, value) {\n        const current_value = this.#indicator_control__getter(control);\n        if (value !== current_value) {\n            control.setAttribute(this.indicator_control__attribute__value, (value ? 'on' : ''));\n            // dispatch \"change\" event\n            const event = new Event('change', {});\n            control.dispatchEvent(event);\n        }\n    }\n\n\n    // === WEB COMPONENT LIFECYCLE ===\n\n    // connectedCallback:\n    //     Invoked each time the custom element is appended into a document-connected element.\n    //     This will happen each time the node is moved, and may happen before the element's contents have been fully parsed.\n    //     Note: connectedCallback may be called once your element is no longer connected, use Node.isConnected to make sure.\n    connectedCallback() {\n        this.#event_listener_manager.reattach();\n    }\n\n    // disconnectedCallback:\n    //     Invoked each time the custom element is disconnected from the document's DOM.\n    disconnectedCallback() {\n        // event handlers have been disconnected, but just leave things alone so we can reconnect\n    }\n\n    // adoptedCallback:\n    //     Invoked each time the custom element is moved to a new document.\n    adoptedCallback() {\n        this.#event_listener_manager.reattach();\n    }\n\n    // attributeChangedCallback:\n    //     Invoked each time one of the custom element's attributes is added, removed, or changed.\n    //     Which attributes to notice change for is specified in a static get observedAttributes method\n    attributeChangedCallback(name, old_value, new_value) {\n        switch (name) {\n        case 'xyzzy': {\n            //!!!\n            break;\n        }\n        }\n        //!!!\n    }\n\n    static get observedAttributes() {\n        return [\n            'xyzzy',//!!!\n        ];\n    }\n\n\n    // === INTERNAL ===\n\n    // Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\n    static _init_static() {\n        globalThis.customElements.define(this.custom_element_name, this);\n    }\n}\n\n// Safari does not support static initialization blocks in classes (at the time of writing), so do it this way:\nToolBarElement._init_static();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.nc = undefined;","// startup\n// Load entry module and return exports\n// This entry module used 'module' so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(7027);\n"],"names":["webpackQueues","webpackExports","webpackError","resolveQueue","___CSS_LOADER_EXPORT___","push","module","id","exports","cssWithMappingToString","list","toString","this","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","g","not_string","not_bool","not_type","not_primitive","number","numeric_arg","json","not_json","text","modulo","placeholder","key","key_access","index_access","sign","y","e","t","r","n","s","a","o","p","c","l","u","f","d","keys","Error","param_no","test","type","Function","isNaN","TypeError","parseInt","String","fromCharCode","width","precision","parseFloat","toExponential","toFixed","Number","toPrecision","substring","Object","prototype","call","slice","toLowerCase","valueOf","toUpperCase","replace","pad_char","charAt","repeat","align","exec","SyntaxError","arguments","apply","create","window","sprintf","vsprintf","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","stylesInDOM","getIndexByIdentifier","identifier","result","modulesToDom","idCountMap","identifiers","base","count","indexByIdentifier","obj","css","sourceMap","references","updater","addElementStyle","byIndex","splice","api","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","memo","style","target","styleTarget","document","querySelector","HTMLIFrameElement","contentDocument","head","getTarget","appendChild","element","createElement","attributes","styleElement","nonce","setAttribute","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","webpackEmptyAsyncContext","req","Promise","resolve","then","code","EventListenerManager","constructor","empty","add","listener","spec","addEventListener","removeEventListener","remove_all","reattach","search_spec","static","uses_capture","EventTarget","capture","spec1","spec2","FsInterface","globalThis","FileSystemHandle","FileSystemFileHandle","FileSystemDirectoryHandle","showOpenFilePicker","showSaveFilePicker","showDirectoryPicker","fsaapi_available","async","file_handle","for_writing","ensure_fsaapi_available","writable","mode","queryPermission","requestPermission","get_text","legacy_save","prompt_result","prompt_for_save","prompt_options","canceled","verify_permission","createWritable","write","close","stats","get_fs_stats_for_file_handle","legacy_open","prompt_for_open","file","getFile","get_fs_stats_for_file","lastModified","last_modified","name","size","_prompt","multiple","picker","err","reject","a_el","download","href","URL","createObjectURL","Blob","body","onfocus","event","revokeObjectURL","click","accept","_convert_options_for_legacy","i_el","getElementById","legacy_file_input_element_id","classList","insertBefore","op","onchange","files","promise","options_accept","types","fs_interface","get_obj_path","path","segment","set_obj_path","value","OpenPromise","x","defineProperties","bind","catch","finally","current_script_url","rxjs_url","rxjs","Stoppable","stopper","multiple_stops","stop","enumerable","stop_count","stopped","StoppableObjectsManager","add_stoppable","stoppable","remove_stoppable","indexOf","pop","Subscribable","Subject","dispatch","event_data","next","deep_freeze","object","entries","Array","isArray","freeze","randomUUID","crypto","getRandomValues","rnds8","Uint8Array","rng","byteToHex","uuidv4","buf","offset","rnds","random","arr","unsafeStringify","generate_object_id","generate_uuid","beep_data_uri","beep","Audio","play","ChangeManager","Node","neutral_changes_observer","MutationObserver","neutral_changes","subscribe","observe","childList","subtree","attributeFilter","attributeOldValue","characterDataOldValue","is_connected","disconnect","is_neutral","set_neutral","reset_neutral","reset","set_neutral_too","can_perform_undo","perform_undo","change","focus_node","focus_offset","mutations","queueMicrotask","can_perform_redo","perform_redo","mutation","extra_props","assign","mutation_data","MutationData","attributeNamespace","attributeName","oldValue","addedNodes","removedNodes","nextSibling","newValue","mutation_list","observer","getAttributeNS","getAttribute","selection","getSelection","new_change","timestamp","Date","now","focusNode","focusOffset","change_manager","_dialog_element_to_instance_map","WeakMap","Dialog","message","run","querySelectorAll","_modal_dialog_css_class","some","open","get","closest","_completed","_promise","_destroy_dialog_element","error","console","warn","_dialog_element_id","uuid","_create_dialog_element","set","_dialog_element","_cancel","args","_populate_dialog_element","showModal","_complete","content_element","parent","attrs","tagName","parentElement","ui_element","before","dialog_element","tag","class","_dialog_text_container","_dialog_form","method","delete","oncancel","onclose","AlertDialog","accept_button_label","innerText","create_control_element","label","label_after","control_opts","control","control_label","for","create_select_element","opts","option_elements","option_attrs","option_element","select_element","show_initialization_failed","stack","error_h1","textContent","error_pre","delay_ms","ms","resolve_result","setTimeout","next_tick","next_micro_tick","clear_element","HTMLElement","scroll_element_into_view","element_rect","getBoundingClientRect","bottom","innerHeight","scrollBy","set_element_attrs","_attr_value","v","removeAttribute","update_element_style","removeProperty","setProperty","safe_setAttributeNS","namespace","includes","pathname","split","findLast","setAttributeNS","validate_parent_and_before_from_options","required_parent_class","parent_from_options","Element","create_element","createElementNS","element_id_specified","create_element_child_text_node","prevent_coalesce_next","node","previous","previousSibling","lastChild","nodeType","TEXT_NODE","nodeValue","normalize_element_text","normalize","_script_promise_data","load_script","script_url","permit_duplication","full_script_url","promise_data","initial","data_key","_establish_script_promise_data","script_el","script_load_handler","script_load_error_handler","script_element","replaceAll","src","create_script","once","find_child_offset","child","parent_child_nodes","childNodes","set_selection_focus","setBaseAndExtent","manage_selection_for_insert","deleteFromDocument","point","manage_selection_for_delete","isCollapsed","insert_at","thing","Text","text_node","next_node","splitText","delete_nearest_leaf","element_too","reverse","ELEMENT_NODE","hasChildNodes","new_point","tree_walker_filter","NodeFilter","SHOW_TEXT","SHOW_ELEMENT","tree_walker","createTreeWalker","acceptNode","every","FILTER_ACCEPT","FILTER_SKIP","currentNode","previousNode","nextNode","KeyEventManager","event_target","command_observer","commands","reset_key_map_stack","push_key_map","key_map","unshift","pop_key_map","popped_key_map","shift","remove_key_map","remove_subsequent_too","is_attached","attach","multi_mapper","initial_state","state","key_sequence","blur_handler","listener_specs","key_spec","from_keyboard_event","mapping_result","consume","preventDefault","command_context","command","detach","was_attached","KeyMap","bindings","recognizer","mapping","create_mapper","fallback_mapper","Mapper","key_maps","m","reduce","mapper","seq_mapping","seq_key_strings","canonical_key_string_separator","key_string","is_last","canonical_key_string","canonical","existing","seq_so_far","key_string_or_key_spec","recognizer_result","fallback_mapper_result","KeySpec","context","meta","event_prop","glyph","display_order","alternates","ctrl","alt","arrowleft","arrowup","arrowright","arrowdown","enter","backspace","keyboard_event","modifier_descs","modifier","desc","canonical_key_modifier_separator","glyphs","klc","result_segments","match","modifiers","at","sort","b","modifier_flags","values","flags","canonical_modifiers","is_printable","shift_flag","defineProperty","navigator","platform","userAgentData","startsWith","fromEntries","modifier_key","current_bit","disallowed_modifier_codes","all_alternates","acc","Set","codes","props","mdm","create_extended_desc","basic_modifier_key","ext_desc","basic_modifier","bmdm_key","alt_key","_init_static","MenuBar","menuitem","mi","previousElementSibling","contains","nextElementSibling","menubar_spec","get_command_bindings","selects","menu_id","set_focus","menubar_first_menuitem","focus","deactivate","set_menu_state","state_specs","menu_element","children","select","menuitem_element","container","collection","menuitem_element_br","top","height","left","menuitem_element_tag_name","menu_spec","toplevel","collection_element","menu_element_tag_name","forEach","stopPropagation","kbd_bindings","kbd_container","binding","binding_glyphs","menubar_container","role","tabindex","selected_elements","is_in_menubar","key_menu_prev","key_menu_next","key_cross_prev","key_cross_next","find_previous_menuitem","find_next_menuitem","menubar_menuitem","mbi","navigated_into_collection","assets_server_script","assets_server_root","local_server_root","assets_server_url","local_url","protocol","relative","EditorCellElement","super","get_initial_key_map_bindings","key_map_insert_self_recognizer","_tool_bar","editable","hasAttribute","set_editable","establish_tool_bar","create_for","visible","on","set_visible","autoeval","modified","remove_tool_bar","get_dom_extent","first","last","compareDocumentPosition","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_FOLLOWING","cell","custom_element_name","adjacent_cell","forward","cells","move_cell","had_tool_bar","remove_cell","get_global_initial_key_map_bindings","get_global_command_bindings","command_handler__insert_self","command_handler__insert_line_break","create_command_handler___delete","command_handler__cut","command_handler__copy","command_handler__paste","command_handler__reset_cell","command_handler__toggle_visible","perform_command","bindings_fn","execCommand","clipboard","readText","active","attribute__active","set_active","attribute__visible","set_for","focus_handler","set_active_cell","connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback","old_value","new_value","observedAttributes","customElements","define","EvalCellElement","input_type","set_type","output_element_class","output_element_id","output_element","oid","current_output_element","establish_output_element","dom_extent","remove_output_element","activeElement","output_element_precedes","element_after_output","evaluator_class","evaluator_class_from_options","output_element_from_options","eval_context","class_for_content","evaluator","emit_eval_state","_perform_eval","output_context","invoke_renderer_for_type","evaluator_foreground","can_stop","initial_type","get_state","running","command_handler__eval","command_handler__set_mode_markdown","command_handler__set_mode_tex","command_handler__set_mode_javascript","eval","global_eval_context","get_evaluator_classes","J","Evaluator","input_element","instance","evaluator_classes","default_evaluator_class","handled_input_types","JavaScriptEvaluator","renderer","renderer_for_type","invoke_renderer","MarkdownEvaluator","TeXEvaluator","inline","rtl","initialize","LogbookManager","reset_global_eval_context","checked","get_cells","active_cell","controls_element","clear","create_cell","find","returnValue","getElementsByTagName","controls_element_id","content_element_id","rel","documentElement","queried_content_element","outerHTML","get_suggested_file_name","location","update_menu_state","active_index","can_undo","can_redo","enabled","updated_command_context","command_handler__create_cell","command_handler__reset","command_handler__clear","command_handler__save","command_handler__save_as","command_handler__show_settings_dialog","command_handler__eval_and_refocus","command_handler__eval_before","command_handler__eval_all","command_handler__stop","command_handler__stop_all","command_handler__focus_up","command_handler__focus_down","command_handler__move_up","command_handler__move_down","command_handler__add_before","command_handler__add_after","command_handler__delete","command_handler__toggle_editable","command_handler__undo","command_handler__redo","eval_state","something_foreground","next_cell","save_result","save","suggestedName","iter_cell","final_cell","focus_cell","logbook_manager","OutputContext","svg_node","svg_string","XMLSerializer","serializeToString","scroll_into_view","set_attrs","update_style","create_child","create_element_child","create_child_text_node","normalize_text","constuctor","renderer_class","class_from_type","render","get_renderer_classes","I","ChartRenderer","config","ctx","getContext","defaults","global","animation","duration","Chart","d3","ErrorRenderer","error_object","text_segments","color","error_element_text_color","GraphvizRenderer","element_selector","dot_stmts","node_config","node_spec","nodes","node_options","from","to","edge_options","edges","dot","transition","ease","easeLinear","delay","logEvents","reject_with_string","graphviz","useWorker","useSharedWorker","onerror","renderDot","ImageDataRenderer","iter_config","image_data","putImageData","lib_dir_url","AsyncGeneratorFunction","getPrototypeOf","JavaScriptRenderer","ephemeral_eval_context","ephemeral_eval_context_entries","eval_fn_params","_","eval_fn_args","eval_fn_this","result_stream","done","render_text","render_value","self","render_error","AIS","abort_if_stopped","operation","settings","theme_settings","is_stopped","create_worker","worker","terminate","import_lib","lib_path","vars","objects","sleep","println","print__","printf","format","markdown","tex","chart","plotly","javascript","EvalWorker","keepalive","_worker","Worker","_terminated","_current_expression","terminated","_reset_event_handlers","expression","result_promise","result_promise_fulfilled","handle_done","expression_id","worker_message","request","worker_id","onmessage","onmessageerror","postMessage","stream_eval","pending_results","pending_promises","handle_result","Symbol","asyncIterator","new_promise","return","worker_url","fetch","res","preamble","_async_init_static","MarkdownRenderer","markup","parse","innerHTML","extension_name__inline","extension_name__block","extension_name__eval_code","use","extensions","level","start","tokenizer","tokens","raw","trim","token","toMathMLString","html","marked","PlotlyRenderer","newPlot","Plotly","Renderer","TeXRenderer","mathml","TextRenderer","span","TeXZilla","sections","section","settings_path","analyze","convert_to_number","SettingsDialog","pre_existing_element","settings_dialog_css_class","pre_existing_instance","instance_from_element","current_settings","section_div","named_section_div","error_div","setting","setting_div","update_handler","handle_error","error_message","existing_control","HTMLInputElement","complaint","onclick","initial_settings","editor_options","indentUnit","tabSize","indentWithTabs","keyMap","formatting_options","indent","theme_colors","settings_updated_events","numeric_re","validate_numeric","test_value","require_integer","reject_negative","reject_zero","reject_positive","numeric_value","isInteger","analyze_contained","analyze_editor_options_indentUnit","analyze_editor_options_tabSize","analyze_editor_options_indentWithTabs","valid_editor_options_keyMap_values","analyze_editor_options_keyMap","analyze_editor_options","valid_formatting_options_align_values","analyze_formatting_options_align","valid_formatting_options_indent_units","analyze_formatting_options_indent","amount_str","units","analyze_formatting_options","valid_theme_colors_values","analyze_theme_colors","analyze_settings","put_settings_to_storage","put","get_settings_from_storage","get_settings","update_settings","new_settings","db_key_settings","storage_db","database_name","database_store_name","_startup_promise","indexedDB","onsuccess","onupgradeneeded","createObjectStore","receiver","db","transaction","oncomplete","onabort","objectStore","with_object_store","store","getAllKeys","dark_mode_media_query_list","matchMedia","get_theme_settings","shouldUseDarkColors","matches","theme_settings_updated_events","ToggleSwitchElement","cls","title_for_on","title_for_off","svg","title","set_state","new_state","old_state","dispatchEvent","Event","ToolBarElement","tool_bar","set_target","get_for","getter","setter","control_options","on_change_handler","toggle_switch__editable__class","toggle_switch__visible__class","flat","subsequent","selected","option","css_class","indicator_control__class","indicator_control__attribute__value","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","queue","fn","hasAwait","currentDeps","outerResolve","depQueues","rej","deps","dep","ret","wrapDeps","getResult","fnQueue","q","has","__esModule","definition","prop","hasOwnProperty","nc"],"sourceRoot":""}